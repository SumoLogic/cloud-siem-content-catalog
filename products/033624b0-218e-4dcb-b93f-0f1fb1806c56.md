# [Products](README.md): Amazon AWS - CloudTrail

## Rules

|Rule ID|Rule Name|
|----|----|
|MATCH-S00307|[AWS - Excessive OAuth Application Permissions Scope](../rules/MATCH-S00307.md)|
|MATCH-S00306|[AWS - New UserPoolClient Created](../rules/MATCH-S00306.md)|
|MATCH-S00922|[AWS Bedrock Agent Created](../rules/MATCH-S00922.md)|
|MATCH-S00924|[AWS Bedrock Guardrail Deleted](../rules/MATCH-S00924.md)|
|MATCH-S00923|[AWS Bedrock Model Invocation Denied for User](../rules/MATCH-S00923.md)|
|MATCH-S00921|[AWS Bedrock Model Invocation Logging Configuration Change Observed](../rules/MATCH-S00921.md)|
|MATCH-S00715|[AWS Cloud Storage Deletion](../rules/MATCH-S00715.md)|
|AGGREGATION-S00002|[AWS CloudTrail - Aggressive Reconnaissance](../rules/AGGREGATION-S00002.md)|
|LEGACY-S00207|[AWS CloudTrail - Customer Master Key Disabled or Scheduled for Deletion](../rules/LEGACY-S00207.md)|
|MATCH-S00261|[AWS CloudTrail - Database Snapshot Created](../rules/MATCH-S00261.md)|
|MATCH-S00208|[AWS CloudTrail - EC2 Access Key Action Detected](../rules/MATCH-S00208.md)|
|MATCH-S00246|[AWS CloudTrail - GetSecretValue from non Amazon IP](../rules/MATCH-S00246.md)|
|MATCH-S00111|[AWS CloudTrail - IAM CreateUser Action Observed](../rules/MATCH-S00111.md)|
|LEGACY-S00206|[AWS CloudTrail - IAM Policy Applied](../rules/LEGACY-S00206.md)|
|MATCH-S00101|[AWS CloudTrail - IAM Privileged Policy Applied to Group](../rules/MATCH-S00101.md)|
|MATCH-S00102|[AWS CloudTrail - IAM Privileged Policy Applied to Group (Username)](../rules/MATCH-S00102.md)|
|MATCH-S00104|[AWS CloudTrail - IAM Privileged Policy Applied to Role](../rules/MATCH-S00104.md)|
|MATCH-S00099|[AWS CloudTrail - IAM Privileged Policy Applied to User](../rules/MATCH-S00099.md)|
|THRESHOLD-S00051|[AWS CloudTrail - IAM User Generating AccessDenied Errors Across Multiple Actions](../rules/THRESHOLD-S00051.md)|
|MATCH-S00113|[AWS CloudTrail - Logging Configuration Change Observed](../rules/MATCH-S00113.md)|
|MATCH-S00308|[AWS CloudTrail - OpsWorks Describe Permissions Event](../rules/MATCH-S00308.md)|
|MATCH-S00109|[AWS CloudTrail - Permissions Boundary Lifted](../rules/MATCH-S00109.md)|
|MATCH-S00105|[AWS CloudTrail - Public S3 Bucket Exposed](../rules/MATCH-S00105.md)|
|MATCH-S00213|[AWS CloudTrail - Reconnaissance related event](../rules/MATCH-S00213.md)|
|MATCH-S00096|[AWS CloudTrail - Root Console Successful Login Observed](../rules/MATCH-S00096.md)|
|MATCH-S00764|[AWS CloudTrail - S3 Bucket Public Access Block Disabled](../rules/MATCH-S00764.md)|
|MATCH-S00210|[AWS CloudTrail - SQS List Queues Event](../rules/MATCH-S00210.md)|
|MATCH-S00240|[AWS CloudTrail - ScheduleKeyDeletion in KMS](../rules/MATCH-S00240.md)|
|MATCH-S00247|[AWS CloudTrail - Secrets Manager sensitive admin action observed](../rules/MATCH-S00247.md)|
|MATCH-S00238|[AWS CloudTrail - sensitive activity in KMS](../rules/MATCH-S00238.md)|
|MATCH-S00540|[AWS CloudTrail Network Access Control List Deleted](../rules/MATCH-S00540.md)|
|MATCH-S00664|[AWS CloudWatch Alarm Actions Disabled](../rules/MATCH-S00664.md)|
|MATCH-S00663|[AWS CloudWatch Alarm Deletion](../rules/MATCH-S00663.md)|
|MATCH-S00662|[AWS CloudWatch Anomaly Detector Deletion](../rules/MATCH-S00662.md)|
|MATCH-S00665|[AWS CloudWatch Log Group Deletion](../rules/MATCH-S00665.md)|
|MATCH-S00661|[AWS CloudWatch Log Stream Deletion](../rules/MATCH-S00661.md)|
|MATCH-S00671|[AWS Config Recorder Deletion](../rules/MATCH-S00671.md)|
|MATCH-S00672|[AWS Config Recorder Stopped](../rules/MATCH-S00672.md)|
|MATCH-S00670|[AWS Config Service Tampering](../rules/MATCH-S00670.md)|
|OUTLIER-S00024|[AWS DynamoDB Outlier in GetItem Events from User](../rules/OUTLIER-S00024.md)|
|MATCH-S00654|[AWS ECS Cluster Deleted](../rules/MATCH-S00654.md)|
|MATCH-S00873|[AWS EKS Cluster Configuration Updated](../rules/MATCH-S00873.md)|
|MATCH-S00716|[AWS Image Creation](../rules/MATCH-S00716.md)|
|MATCH-S00717|[AWS Image Deletion](../rules/MATCH-S00717.md)|
|THRESHOLD-S00106|[AWS Image Discovery](../rules/THRESHOLD-S00106.md)|
|MATCH-S00718|[AWS Image Modification](../rules/MATCH-S00718.md)|
|MATCH-S00719|[AWS Instance Creation](../rules/MATCH-S00719.md)|
|MATCH-S00720|[AWS Instance Deletion](../rules/MATCH-S00720.md)|
|THRESHOLD-S00107|[AWS Instance Discovery](../rules/THRESHOLD-S00107.md)|
|MATCH-S00721|[AWS Instance Modification](../rules/MATCH-S00721.md)|
|MATCH-S00874|[AWS Lambda Function Recon](../rules/MATCH-S00874.md)|
|MATCH-S00679|[AWS Route 53 Domain Registered](../rules/MATCH-S00679.md)|
|THRESHOLD-S00093|[AWS Route 53 Reconnaissance](../rules/THRESHOLD-S00093.md)|
|MATCH-S00677|[AWS Route 53 Service Tampering](../rules/MATCH-S00677.md)|
|MATCH-S00680|[AWS Route 53 TestDNSAnswer](../rules/MATCH-S00680.md)|
|MATCH-S00678|[AWS Route 53 Traffic Policy Creation](../rules/MATCH-S00678.md)|
|OUTLIER-S00025|[AWS S3 Outlier in PutObject Denied Events](../rules/OUTLIER-S00025.md)|
|MATCH-S00825|[AWS Secrets Manager Enumeration](../rules/MATCH-S00825.md)|
|MATCH-S00875|[AWS VPC FLow Log Deletion](../rules/MATCH-S00875.md)|
|MATCH-S00674|[AWS WAF Access Control List Updated](../rules/MATCH-S00674.md)|
|THRESHOLD-S00092|[AWS WAF Reconnaissance](../rules/THRESHOLD-S00092.md)|
|MATCH-S00676|[AWS WAF Rule Group Updated](../rules/MATCH-S00676.md)|
|MATCH-S00675|[AWS WAF Rule Updated](../rules/MATCH-S00675.md)|
|MATCH-S00673|[AWS WAF Service Tampering](../rules/MATCH-S00673.md)|
|MATCH-S00660|[Anomalous AWS User Executed a Command on ECS Container](../rules/MATCH-S00660.md)|
|MATCH-S00685|[Authentication Without MFA](../rules/MATCH-S00685.md)|
|THRESHOLD-S00096|[Brute Force Attempt](../rules/THRESHOLD-S00096.md)|
|MATCH-S00209|[CVE-2021-44228 Log4j2 Java Library 0-Day Attempt](../rules/MATCH-S00209.md)|
|LEGACY-S00189|[Crypto Miner HTTP User Agent](../rules/LEGACY-S00189.md)|
|MATCH-S00592|[Crypto Miner User Agent](../rules/MATCH-S00592.md)|
|MATCH-S00827|[Exposed AWS SNS Topic Created](../rules/MATCH-S00827.md)|
|MATCH-S00823|[Exposed AWS SQS Queue Created](../rules/MATCH-S00823.md)|
|FIRST-S00002|[First Seen AWS API Call from User](../rules/FIRST-S00002.md)|
|FIRST-S00023|[First Seen AWS API Gateway Enumeration by User](../rules/FIRST-S00023.md)|
|FIRST-S00084|[First Seen AWS Bedrock API Call from User](../rules/FIRST-S00084.md)|
|FIRST-S00071|[First Seen AWS ConsoleLogin by User](../rules/FIRST-S00071.md)|
|FIRST-S00036|[First Seen AWS EKS API Call via CloudTrail from User](../rules/FIRST-S00036.md)|
|FIRST-S00024|[First Seen AWS SSM RunShellScript SendCommand From User](../rules/FIRST-S00024.md)|
|FIRST-S00003|[First Seen AWS Secrets Manager API Call from User](../rules/FIRST-S00003.md)|
|FIRST-S00007|[First Seen DynamoDB Enumeration from User](../rules/FIRST-S00007.md)|
|FIRST-S00086|[First Seen IP Address Performing Trufflehog AWS Credential Verification](../rules/FIRST-S00086.md)|
|FIRST-S00081|[First Seen Model ID in AWS Bedrock Put Entitlement by User](../rules/FIRST-S00081.md)|
|FIRST-S00085|[First Seen Role Creating AWS Bedrock Agent](../rules/FIRST-S00085.md)|
|FIRST-S00022|[First Seen S3 Bucket ACL Enumeration by User](../rules/FIRST-S00022.md)|
|FIRST-S00034|[First Seen Session Token Granted to User from New IP](../rules/FIRST-S00034.md)|
|FIRST-S00029|[First Seen Successful Authentication From Unexpected Country](../rules/FIRST-S00029.md)|
|FIRST-S00087|[First Seen User Creating or Modifying EC2 Launch Template](../rules/FIRST-S00087.md)|
|FIRST-S00082|[First Seen User Enumerating AWS Bedrock Models](../rules/FIRST-S00082.md)|
|LEGACY-S00048|[Houdini/Iniduoh/njRAT User-Agent](../rules/LEGACY-S00048.md)|
|THRESHOLD-S00097|[Impossible Travel - Successful](../rules/THRESHOLD-S00097.md)|
|THRESHOLD-S00098|[Impossible Travel - Unsuccessful](../rules/THRESHOLD-S00098.md)|
|MATCH-S00655|[New Container Uploaded to AWS ECR](../rules/MATCH-S00655.md)|
|OUTLIER-S00019|[Outlier in AWS Bedrock API Calls from User](../rules/OUTLIER-S00019.md)|
|OUTLIER-S00022|[Outlier in AWS Bedrock Foundation Model Enumeration Calls from User ](../rules/OUTLIER-S00022.md)|
|MATCH-S00683|[Overly Permissive Chmod Command](../rules/MATCH-S00683.md)|
|THRESHOLD-S00095|[Password Attack](../rules/THRESHOLD-S00095.md)|
|MATCH-S00876|[Potential AWS Security Credential Access via curl](../rules/MATCH-S00876.md)|
|MATCH-S00826|[SSH Keys Added to EC2 Instance](../rules/MATCH-S00826.md)|
|OUTLIER-S00005|[Spike in AWS API Call from User](../rules/OUTLIER-S00005.md)|
|OUTLIER-S00011|[Spike in AWS AccessDenied Events by assumedrole](../rules/OUTLIER-S00011.md)|
|OUTLIER-S00001|[Spike in Login Failures from a User](../rules/OUTLIER-S00001.md)|
|CHAIN-S00008|[Successful Brute Force](../rules/CHAIN-S00008.md)|
|AGGREGATION-S00003|[Suspicious AWS Lambda Enumeration](../rules/AGGREGATION-S00003.md)|
|LEGACY-S00182|[Suspicious HTTP User-Agent](../rules/LEGACY-S00182.md)|
|MATCH-S00840|[Suspicious Lambda Function - IAM Policy Attached](../rules/MATCH-S00840.md)|
|MATCH-S00815|[Threat Intel - Successful Authentication from Threat IP](../rules/MATCH-S00815.md)|
|MATCH-S00925|[Trufflehog AWS Credential Verification Detected](../rules/MATCH-S00925.md)|


## Log Mappers

|Log Mapper ID|Log Mapper Name|
|----|----|
|3f2bd88a-69b4-11ea-bc55-0242ac130003|[CloudTrail - application-insights.amazonaws.com - ListApplications](../mappings/3f2bd88a-69b4-11ea-bc55-0242ac130003.md)|
|9df7db8f-46a3-488a-af25-b34236b5303a|[CloudTrail - cloudtrail.amazonaws.com - Trail Change|Logging](../mappings/9df7db8f-46a3-488a-af25-b34236b5303a.md)|
|ff0ade7d-8a2f-42c2-8250-69562a9e8daf|[CloudTrail - cognito-idp.amazonaws.com - CreateUserPoolClient](../mappings/ff0ade7d-8a2f-42c2-8250-69562a9e8daf.md)|
|915b12a0-69b0-11ea-bc55-0242ac130003|[CloudTrail - controltower.amazonaws.com - CreateManagedAccount](../mappings/915b12a0-69b0-11ea-bc55-0242ac130003.md)|
|1d8b8a41-b782-49f1-b12a-273caf8eb092|[CloudTrail - ec2.amazonaws.com - All Network Events](../mappings/1d8b8a41-b782-49f1-b12a-273caf8eb092.md)|
|6ca55368-0d59-4c92-b312-4b5940147be5|[CloudTrail - ec2.amazonaws.com - BidEvictedEvent](../mappings/6ca55368-0d59-4c92-b312-4b5940147be5.md)|
|1c8fe1c9-f66f-439d-af45-37840a4f781e|[CloudTrail - ecr.amazonaws.com - PolicyExecutionEvent](../mappings/1c8fe1c9-f66f-439d-af45-37840a4f781e.md)|
|10cc2415-7909-4610-a417-7e755696a0a5|[CloudTrail - ecs.amazonaws.com - AwsApiCall-ExecuteCommand](../mappings/10cc2415-7909-4610-a417-7e755696a0a5.md)|
|2d163beb-e486-405f-a2a4-7134e25493aa|[CloudTrail - elasticfilesystem.amazonaws.com - NewClientConnection](../mappings/2d163beb-e486-405f-a2a4-7134e25493aa.md)|
|27a70508-29d3-4ff7-adb8-3e3759eb80b5|[CloudTrail - iam.amazonaws.com - Policy Change](../mappings/27a70508-29d3-4ff7-adb8-3e3759eb80b5.md)|
|9ee2abd3-a781-4d7f-b1d1-c77a76b2c2a8|[CloudTrail - kms.amazonaws.com - DisableKey|ScheduleKeyDeletion](../mappings/9ee2abd3-a781-4d7f-b1d1-c77a76b2c2a8.md)|
|fae41f89-52be-48fd-b061-19c11d743648|[CloudTrail - kms.amazonaws.com - RotateKey](../mappings/fae41f89-52be-48fd-b061-19c11d743648.md)|
|e0456134-e8b3-4b45-97f1-99d01a461d73|[CloudTrail - lambda.amazonaws.com - Audit Change](../mappings/e0456134-e8b3-4b45-97f1-99d01a461d73.md)|
|1758b47a-933f-40f5-ae40-a591ecfd95ba|[CloudTrail - lambda.amazonaws.com - DeleteEventSourceMapping|DeleteFunction](../mappings/1758b47a-933f-40f5-ae40-a591ecfd95ba.md)|
|6c9a5532-df91-47df-856c-c3b78b5a8fe3|[CloudTrail - lambda.amazonaws.com - DeleteFunctionUrlConfig](../mappings/6c9a5532-df91-47df-856c-c3b78b5a8fe3.md)|
|71cd9b06-7b50-4f3f-9434-06eb6242dc32|[CloudTrail - lambda.amazonaws.com - GetFunction](../mappings/71cd9b06-7b50-4f3f-9434-06eb6242dc32.md)|
|17dd4d8c-1b54-4556-b9d8-4124cb897c60|[CloudTrail - lambda.amazonaws.com - GetLayerVersionPolicy](../mappings/17dd4d8c-1b54-4556-b9d8-4124cb897c60.md)|
|1ee636b5-3f41-4d0e-8923-d371a4c72adb|[CloudTrail - lambda.amazonaws.com - GetPolicy|GetLayerVersionPolicy](../mappings/1ee636b5-3f41-4d0e-8923-d371a4c72adb.md)|
|d36c55c3-0ad0-4b7b-a4aa-779f0f9e1b8b|[CloudTrail - lambda.amazonaws.com - ListEventSourceMappings](../mappings/d36c55c3-0ad0-4b7b-a4aa-779f0f9e1b8b.md)|
|592fd1db-91d1-4305-a1f9-fe8e2c7457bf|[CloudTrail - lambda.amazonaws.com - ListFunctions](../mappings/592fd1db-91d1-4305-a1f9-fe8e2c7457bf.md)|
|2aa066b7-cb03-4827-96e5-6f37af056599|[CloudTrail - lambda.amazonaws.com - Resource Access](../mappings/2aa066b7-cb03-4827-96e5-6f37af056599.md)|
|db3ca20f-daa1-4fb6-b06c-ac72800f3cce|[CloudTrail - logs.amazonaws.com - DeleteDestination|DeleteLogGroup|DeleteLogStream](../mappings/db3ca20f-daa1-4fb6-b06c-ac72800f3cce.md)|
|970738c0-68fa-11ea-bc55-0242ac130003|[CloudTrail - organizations.amazonaws.com - CreateAccountResult](../mappings/970738c0-68fa-11ea-bc55-0242ac130003.md)|
|974823f1-6cd9-4b4b-ad05-e09e94fdc92d|[CloudTrail - s3.amazonaws.com - Bucket Change](../mappings/974823f1-6cd9-4b4b-ad05-e09e94fdc92d.md)|
|c4caf910-d72e-47b6-9315-d17636c04ca2|[CloudTrail - s3.amazonaws.com - GetBucketAcl](../mappings/c4caf910-d72e-47b6-9315-d17636c04ca2.md)|
|28e0fc3f-fe14-4f41-9c9a-1603f9eef9bd|[CloudTrail - secretsmanager.amazonaws.com - RotationSucceeded|RotationStarted](../mappings/28e0fc3f-fe14-4f41-9c9a-1603f9eef9bd.md)|
|5406ec15-2203-460b-bd6e-ea8facf33082|[CloudTrail - secretsmanager.amazonaws.com - SecretVersionDeletion](../mappings/5406ec15-2203-460b-bd6e-ea8facf33082.md)|
|47b7d4bc-c062-460e-b39a-e28d171523e9|[CloudTrail - signin.amazonaws.com - All AwsConsoleSignIn events](../mappings/47b7d4bc-c062-460e-b39a-e28d171523e9.md)|
|6e6d4334-69b1-11ea-bc55-0242ac130003|[CloudTrail - sso.amazonaws.com - Federate|ListProfilesForApplication](../mappings/6e6d4334-69b1-11ea-bc55-0242ac130003.md)|
|2c6a02e4-89b0-4d30-b03d-45756f074266|[CloudTrail Default Mapping](../mappings/2c6a02e4-89b0-4d30-b03d-45756f074266.md)|


