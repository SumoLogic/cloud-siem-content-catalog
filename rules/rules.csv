"vendor_direct_ref","product_direct_ref","rule_id","type","category","enabled_by_default","prototype_enabled","record_type_direct_ref","tags","name","description"
"","","MATCH-S00458","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.006, _mitreAttackTechnique:T1003.005","ADPassHunt Tool","From FireEye Red Team Tool Countermeasures:
This IOC detects indicators associated with the ADPassHunt Tool. This tool is used to hunt for AD credentials and used via execute-assembly that looks for passwords in GPP, Autoruns and AD objects"
"","","MATCH-S00922","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","AWS Bedrock Agent Created","This rule detects when an AWS Bedrock Agent has been created in the environment. Bedrock Agents can be configured with various parameters to build AI applications. Take a look at the ""responseElements.agent.agentName"" field to see the name of the agent being created. Ensure that the user creating the agent is authorized to develop AI applications within the environment."
"","","MATCH-S00924","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562","AWS Bedrock Guardrail Deleted","AWS Bedrock Guardrails provide users with the ability to configure options like filtering out harmful content or defining denied topics for models. Guardrails also allow the blocking of sensitive information such as PII. Ensure that this deletion was performed by an authorized user during an expected change. Look at other activity from this user account, focusing on the Bedrock service and pivoting from there if the event is deemed suspicious."
"","","MATCH-S00923","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","AWS Bedrock Model Invocation Denied for User","A user has attempted to invoke a model via AWS Bedrock for which access was denied due to a permission issue. This event can be a normal occurrence for a user who has not been provisioned the proper IAM resources for AWS Bedrock. However, it could also be a malicious attempt at running a particular model via AWS Bedrock. Take a look at the username, IP address, role type, role and model via the fields[""requestParameters.modelId""] field."
"","","MATCH-S00921","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.008","AWS Bedrock Model Invocation Logging Configuration Change Observed","An AWS Bedrock Model invocation logging configuration change was observed. Ensure that this activity is expected and authorized. Take a look at the full event details, particularly the requestParameters.loggingConfig* fields in order to see what specific configuration values were changed. Telemetry and logging configuration changes should be a relatively rare occurrence in the environment."
"","","AGGREGATION-S00002","aggregation","Discovery","True","True","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1069, _mitreAttackTechnique:T1087, _mitreAttackTechnique:T1069.003, _mitreAttackTechnique:T1087.004","AWS CloudTrail - Aggressive Reconnaissance","This signal identifies when a large variety of different AWS CloudTrail event ids are observed in a short period of time.  The event id's are generally related to reconnaissance.  This signal can indicate that an aggressive scan of AWS resources is underway."
"Amazon AWS","CloudTrail","MATCH-S00261","templated_match","Exfiltration","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1578, _mitreAttackTechnique:T1578.001","AWS CloudTrail - Database Snapshot Created","Creating DB snapshots is an efficient way for an attacker to begin downloading a targets database.  These signals should be considered around the context of other signals that may indicate data theft is in progress."
"Amazon AWS","CloudTrail","MATCH-S00208","templated_match","Execution","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552.005","AWS CloudTrail - EC2 Access Key Action Detected","Actions observed that create, import and delete access keys to EC2 could indicate an advisary is taking action on their objective to extend or otherwise manipulate access to EC2 instance(s)."
"Amazon AWS","CloudTrail","MATCH-S00246","templated_match","Execution","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552.005","AWS CloudTrail - GetSecretValue from non Amazon IP","The secrets manager service is commonly used by cloud components to retrieve secrets (connection strings etc) while performing routine functions.  This signal identifies when secret values are retrieved via the GetSecretValue API call and the source host does not belong in an Amazon instance IP space."
"Amazon AWS","CloudTrail","MATCH-S00111","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1136, _mitreAttackTechnique:T1136.003","AWS CloudTrail - IAM CreateUser Action Observed","This signal fires for all observances of the CreateUser action in the IAM event source.  Creating AWS users is likely a benign, infrequent activity.  Hostile actors will create users to persist access.  Use this signal in context of other activity to determine intent."
"Amazon AWS","CloudTrail","LEGACY-S00206","match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","AWS CloudTrail - IAM Policy Applied","A policy was attached to a user, group, or role. By default, IAM denies all access to all services for users, and policies must be applied to grant access to AWS services and resources. This signal could indicate a policy is granting additional access within your cloud environment."
"Amazon AWS","CloudTrail","MATCH-S00101","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","AWS CloudTrail - IAM Privileged Policy Applied to Group","This rule identifies both 'attach' and 'put' actions with this privileged policy.  The difference between 'attach' and 'put' is that 'attach' actions apply a managed policy to an item, where a 'put' action indicates the policy is defined in-line and is part of the items definition. Applying privileged policies to items could indicate hostile action that attempts to increase the privilege level of a user or set of users.  There are legitimate times when this will occur, consider this signal in context of other activities that may indicate suspicious behavior."
"Amazon AWS","CloudTrail","MATCH-S00102","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","AWS CloudTrail - IAM Privileged Policy Applied to Group (Username)","This rule identifies both 'attach' and 'put' actions with this privileged policy.  The difference between 'attach' and 'put' is that 'attach' actions apply a managed policy to an item, where a 'put' action indicates the policy is defined in-line and is part of the items definition. Applying privileged policies to items could indicate hostile action that attempts to increase the privilege level of a user or set of users.  There are legitimate times when this will occur, consider this signal in context of other activities that may indicate suspicious behavior."
"Amazon AWS","CloudTrail","MATCH-S00104","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","AWS CloudTrail - IAM Privileged Policy Applied to Role","This rule identifies both 'attach' and 'put' actions with this privileged policy.  The difference between 'attach' and 'put' is that 'attach' actions apply a managed policy to an item, where a 'put' action indicates the policy is defined in-line and is part of the items definition. Applying privileged policies to items could indicate hostile action that attempts to increase the privilege level of a user or set of users.  There are legitimate times when this will occur, consider this signal in context of other activities that may indicate suspicious behavior."
"Amazon AWS","CloudTrail","MATCH-S00099","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","AWS CloudTrail - IAM Privileged Policy Applied to User","This rule identifies both 'attach' and 'put' actions with this privileged policy.  The difference between 'attach' and 'put' is that 'attach' actions apply a managed policy to an item, where a 'put' action indicates the policy is defined in-line and is part of the items definition. Applying privileged policies to items could indicate hostile action that attempts to increase the privilege level of a user or set of users.  There are legitimate times when this will occur, consider this signal in context of other activities that may indicate suspicious behavior."
"Amazon AWS","CloudTrail","LEGACY-S00207","match","Defense Evasion","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552.005","AWS CloudTrail - Customer Master Key Disabled or Scheduled for Deletion","The AWS Key Management Service (KMS) can be used to generate key pairs for encrypting and decrypting your data. Disabling or deleting keys can come with heavy destructive consequences as data encrypted with those keys cannot be decrypted. AWS forces users to either disable keys allowing them to be re-enabled at a later time or users must schedule a key deletion at a later time if the keys absolutely must be removed. The default time for scheduling a key deletion is 30 days."
"Amazon AWS","CloudTrail","MATCH-S00113","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1489, _mitreAttackTechnique:T1578, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1578.004, _mitreAttackTechnique:T1562.008","AWS CloudTrail - Logging Configuration Change Observed","Changing the configuration of logging to any mission-critical service or platform should be closely monitored.  This signal identifies when AWS logging configurations have been changed.  The severity of signals increases depending on the type of action observed.  For instance disabling/deleting logs is a higher severity than enabling logs."
"Amazon AWS","CloudTrail","MATCH-S00540","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.007","AWS CloudTrail Network Access Control List Deleted","Enforcing network-access controls is one of the defensive mechanisms used by cloud administrators to restrict access to a cloud instance. After the attacker has gained control of the console by compromising an admin account, they can delete a network ACL and gain access to the instance from anywhere."
"Amazon AWS","CloudTrail","MATCH-S00308","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1087, _mitreAttackTechnique:T1526, _mitreAttackTechnique:T1087.004","AWS CloudTrail - OpsWorks Describe Permissions Event","This event sourced from AWS OpsWorks occurs rarely.  It could indicate that an adversary is attempting to collect information for later attack.  When successful, the Describe Permissions event returns information regarding a specified stack's permissions for access."
"Amazon AWS","CloudTrail","MATCH-S00109","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1098, _mitreAttackTechnique:T1098.001","AWS CloudTrail - Permissions Boundary Lifted","A Permissions Boundary was lifted against an IAM User or Role. This unusual action may increase the effect permissions to the asset by allowing all the actions granted in its permissions policies."
"Amazon AWS","CloudTrail","MATCH-S00105","templated_match","Exfiltration","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1530","AWS CloudTrail - Public S3 Bucket Exposed","An AWS request occurred to either create a new public bucket or to add a bucket access control list (ACL) to an existing bucket to make it public. While there are some use cases for AWS S3 public buckets, most are generally private. The security operations center should have a strong understanding of which buckets are allowed to be public."
"","","MATCH-S00213","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1069, _mitreAttackTechnique:T1087, _mitreAttackTechnique:T1526, _mitreAttackTechnique:T1087.004, _mitreAttackTechnique:T1069.003","AWS CloudTrail - Reconnaissance related event","This signal identifies a small number of CloudTrail API actions that when observed could indicate an actors intent to enumerate the environment.  These events are generally benign, and occur during normal operations.  Use this signal as context around an unfolding security story."
"Amazon AWS","CloudTrail","MATCH-S00096","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0042, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1078.001","AWS CloudTrail - Root Console Successful Login Observed","This signal detects when a successful root account login occurred within an AWS account. This privileged account should seldomly be used within an AWS cloud environment. Amazon's best practices state you should only use the root account to create the initial local IAM users and assigned one of the accounts administrative privileges or to perform rare tasks only available to the root user. The security operations center should be aware when the AWS root account is accessed."
"Amazon AWS","CloudTrail","MATCH-S00764","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1530","AWS CloudTrail - S3 Bucket Public Access Block Disabled","Detects when GetPublicAccessBlock returns NoSuchPublicAccessBlockConfiguration, indicating the public access block has all values are set to false or the feature is disabled."
"Amazon AWS","CloudTrail","MATCH-S00210","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","AWS CloudTrail - SQS List Queues Event","This event sourced from AWS SQS occurs rarely.  It could indicate that an adversary is attempting to collect information for later attack.  When successful, the List Queues event returns all SQS queues that may be valid targets for further probing/attack."
"Amazon AWS","CloudTrail","MATCH-S00240","templated_match","Execution","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552.005","AWS CloudTrail - ScheduleKeyDeletion in KMS","Deleting cryptographic key material managed by KMS can be risky. The risk is that after key material is deleted, cypher text may remain that is now indecipherable. Because of this risk, AWS enforces a minimum 7 day waiting period. A key cannot be deleted, it must first be scheduled for deletion by the system. This signal indicates that a key has been scheduled or canceled for deletion. This signal in context of other signals around this entity may describe a hostile pattern of attack."
"Amazon AWS","CloudTrail","MATCH-S00247","templated_match","Execution","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552.005","AWS CloudTrail - Secrets Manager sensitive admin action observed","Administrative changes to the AWS Secrets Manager aren't overtly hostile, but are generally low volume and can be considered sensitive.  These signals highlight when these actions occur and can be used in context of other suspicious activity to raise the risk of a hostile entity.  Several Secrets Manager API actions are included and assessed as sensitive."
"Amazon AWS","CloudTrail","THRESHOLD-S00051","threshold","Initial Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.005","AWS CloudTrail - IAM User Generating AccessDenied Errors Across Multiple Actions","An IAM account sent multiple requests to perform a wide distinct number of AWS actions in a short time frame while receiving the error code AccessDenied. This could indicate an account attempting to enumerate their access across the AWS account."
"Amazon AWS","CloudTrail","MATCH-S00238","templated_match","Execution","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552.005","AWS CloudTrail - sensitive activity in KMS","AWS KMS is an encryption and key management web service.  Besides encrypting and decrypting data, users and administrators can use this service to create keys, manage keys etc.  This signal indicates activity that enables and disables keys explicitly.  This activity has been surveyed to be a low volume event and could be considered suspicious given other activity involving the entity.  Additionally, monitoring for these events is required to achieve certain industry audit compliance."
"Amazon AWS","CloudTrail","MATCH-S00664","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1562, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.008, _mitreAttackTechnique:T1562.001","AWS CloudWatch Alarm Actions Disabled","Detects the AWS CloudWatch DisableAlarmActions API action. DisableAlarmActions disables the actions for the specified alarms. When an alarm's actions are disabled, the alarm actions do not execute when the alarm state changes."
"Amazon AWS","CloudTrail","MATCH-S00663","templated_match","Impact","True","False","","_mitreAttackTechnique:T1562, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.008, _mitreAttackTechnique:T1562.001","AWS CloudWatch Alarm Deletion","Detects the AWS CloudWatch DeleteAlarms API action. DeleteAlarms deletes the specified alarms. You can delete up to 100 alarms in one operation. However, this total can include no more than one composite alarm. For example, you could delete 99 metric alarms and one composite alarms with one operation, but you can't delete two composite alarms with one operation."
"Amazon AWS","CloudTrail","MATCH-S00662","templated_match","Impact","True","False","","_mitreAttackTechnique:T1562, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.008, _mitreAttackTechnique:T1562.001","AWS CloudWatch Anomaly Detector Deletion","Detects the AWS CloudWatch DeleteAnomalyDetector API action. DeleteAnomalyDetector deletes the specified anomaly detection model from your account."
"Amazon AWS","CloudTrail","MATCH-S00665","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1562, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.008, _mitreAttackTechnique:T1562.001","AWS CloudWatch Log Group Deletion","Detects the AWS CloudWatch DeleteLogGroup API action. DeleteLogGroup deletes the specified log group and permanently deletes all the archived log events associated with the log group."
"Amazon AWS","CloudTrail","MATCH-S00661","templated_match","Impact","True","False","","_mitreAttackTechnique:T1562, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.008, _mitreAttackTechnique:T1562.001","AWS CloudWatch Log Stream Deletion","Detects the AWS CloudWatch DeleteLogStream API action. DeleteLogStream deletes the specified log stream and permanently deletes all the archived log events associated with the log stream."
"Amazon AWS","CloudTrail","MATCH-S00715","templated_match","Impact","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1485","AWS Cloud Storage Deletion","Detects the removal of cloud storage infrastructure in AWS."
"Amazon AWS","CloudTrail","MATCH-S00671","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1562, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.008, _mitreAttackTechnique:T1562.001","AWS Config Recorder Deletion","Detects the AWS Config DeleteConfigurationRecorder API action. DeleteConfigurationRecorder deletes the configuration recorder.
After the configuration recorder is deleted, AWS Config will not record resource configuration changes until you create a new configuration recorder."
"Amazon AWS","CloudTrail","MATCH-S00672","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1562, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.008, _mitreAttackTechnique:T1562.001","AWS Config Recorder Stopped","Detects the AWS Config StopConfigurationRecorder API action. StopConfigurationRecorder stops recording configurations of the AWS resources you have selected to record in your AWS account."
"Amazon AWS","CloudTrail","MATCH-S00670","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1562, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.008, _mitreAttackTechnique:T1562.001","AWS Config Service Tampering","Detects various AWS Config API actions that involve the alternation of a Config service."
"","","OUTLIER-S00024","outlier","Impact","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1565.001","AWS DynamoDB Outlier in GetItem Events from User","An outlier in GetItem events to a DynamoDB resource within an hour time period has been detected. Ensure that the user performing these actions has business justification for modifying DynamoDB tables and instances. Consider excluding authorized users from this signal or tweaking the minimum count value if this signal is triggering too often. Data events from DynamoDB are required in order for this signal to function."
"","","OUTLIER-S00033","outlier","Impact","False","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1565.001","AWS DynamoDB Outlier in PutItem Events from User","[Disabled by Default] This rule detects an unusual amount of PutItem events to a DynamoDB resource within an hour time period (DynamoDB data events are required). Verify the user is authorized to modify the DynamoDB tables and instances. This rule is disabled by default due to potential volume of signals, before enabling consider excluding authorized users via match lists, and adjust floor value and model sensitivity as needed."
"Amazon AWS","CloudTrail","MATCH-S00654","templated_match","Impact","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1578, _mitreAttackTechnique:T1578.003","AWS ECS Cluster Deleted","Monitors for execution of the API call 'DeleteCluster' which may indicate that an attacker is attempting to disrupt operations."
"","","MATCH-S00873","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078.004","AWS EKS Cluster Configuration Updated","AWS EKS clusters contain various configuration options, including for which IP addresses can access the cluster API. Ensure that this change is authorized and expected."
"","","MATCH-S00872","templated_match","Execution","True","False","","_mitreAttackTechnique:T1609, _mitreAttackTactic:TA0002","AWS EKS Failed Curl Authentication Attempt","Failed instances of curl usage within a containerized environment should occur rarely, investigate the source IP address used to ensure that it is legitimate."
"","","MATCH-S00871","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1611","AWS EKS Pod Shared Object Modification or Creation","A Kubernetes pod was either created, updated or patched with a shared process namespace."
"","","MATCH-S00870","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552.007","AWS EKS Secrets Created","Kubernetes secrets may be created for legitimate purposes, ensure that this secrets created is from an IAM account that is expected to manage Kubernetes workloads on EKS."
"","","MATCH-S00869","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552.007","AWS EKS Secrets Deleted","Kubernetes secrets may be deleted for legitimate purposes, ensure that this secrets created is from an IAM account that is expected to manage Kubernetes workloads on EKS."
"Amazon AWS","CloudTrail","MATCH-S00307","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1550, _mitreAttackTechnique:T1550.001","AWS - Excessive OAuth Application Permissions Scope","Alert when an OAuth application has requested a high number of permissions to aspects of AWS."
"Amazon AWS","CloudTrail","MATCH-S00716","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1612, _mitreAttackTactic:TA0005","AWS Image Creation","Detects the creation of an image in AWS."
"Amazon AWS","CloudTrail","MATCH-S00717","templated_match","Impact","True","False","","_mitreAttackTechnique:T1485, _mitreAttackTactic:TA0040","AWS Image Deletion","Detects the deletion of an image in AWS."
"Amazon AWS","CloudTrail","THRESHOLD-S00106","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","AWS Image Discovery","Detects various describe and/or list commands used for an image in AWS."
"Amazon AWS","CloudTrail","MATCH-S00718","templated_match","Persistence","True","False","","_mitreAttackTechnique:T1525, _mitreAttackTactic:TA0003","AWS Image Modification","Detects the modification of an image in AWS."
"Amazon AWS","CloudTrail","MATCH-S00719","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1578, _mitreAttackTechnique:T1578.002, _mitreAttackTactic:TA0005","AWS Instance Creation","Detects the creation of an instance in AWS."
"Amazon AWS","CloudTrail","MATCH-S00720","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1578, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1578.003","AWS Instance Deletion","Detects the deletion of an instance in AWS."
"Amazon AWS","CloudTrail","THRESHOLD-S00107","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","AWS Instance Discovery","Detects various describe and/or list commands used for an instance in AWS."
"Amazon AWS","CloudTrail","MATCH-S00721","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1578, _mitreAttackTactic:TA0005","AWS Instance Modification","Detects the modification of an instance in AWS."
"Amazon AWS","CloudTrail","MATCH-S00874","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","AWS Lambda Function Recon","Observed when Lambda getfunction AWS API call is made, indicitive of possible recon activity"
"Amazon AWS","CloudTrail","MATCH-S00306","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1550, _mitreAttackTechnique:T1550.001","AWS - New UserPoolClient Created","A UserPoolClient is an entity that has permission to call unauthenticated API operations (operations that do not have an authenticated user)."
"Amazon AWS","CloudTrail","MATCH-S00679","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0042","AWS Route 53 Domain Registered","Detects the AWS Route 53 RegisterDomain API action. Domains are registered either by Amazon Registrar (for .com, .net, and .org domains) or by Gandi (for all other domains). An adversary could use this API action to register a domain for malicious activity."
"Amazon AWS","CloudTrail","THRESHOLD-S00093","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","AWS Route 53 Reconnaissance","Detects a variety of AWS Route 53 API actions that when observed together could indicate an actors intent to enumerate the environment."
"Amazon AWS","CloudTrail","MATCH-S00677","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1562, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.008, _mitreAttackTechnique:T1562.001","AWS Route 53 Service Tampering","Detects various AWS Route 53 API actions that involve the alteration of a Route 53 service."
"Amazon AWS","CloudTrail","MATCH-S00680","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","AWS Route 53 TestDNSAnswer","Detects the AWS Route 53 TestDNSAnswer API action. TestDNSAnswer gets the value that Amazon Route 53 returns in response to a DNS request for a specified record name and type. You can optionally specify the IP address of a DNS resolver, an EDNS0 client subnet IP address, and a subnet mask. An adversary could use this API action for testing if various DNS types and domains are allowed."
"Amazon AWS","CloudTrail","MATCH-S00678","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0042, _mitreAttackTechnique:T1584, _mitreAttackTechnique:T1584.002","AWS Route 53 Traffic Policy Creation","Detects the AWS Route 53 CreateTrafficPolicy and CreateTrafficPolicyInstance API actions. These actions are used to create DNS resource record sets for domain or subdomain names."
"","","OUTLIER-S00025","outlier","Exfiltration","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTechnique:T1567.002","AWS S3 Outlier in PutObject Denied Events","This rule utilizes an hourly baseline to detect an outlier in the number of denied PutObject access events to an S3 bucket. AWS Data events are necessary for this signal to function. Denied PutObject access events can stem from IAM policies or bucket policies. Look at the user, role, IP address from the events in order to determine whether this activity is expected. In certain cases, access denied events to S3 can also result in unexpected AWS charges."
"Amazon AWS","CloudTrail","MATCH-S00825","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTactic:TA0007, _mitreAttackTechnique:T1580","AWS Secrets Manager Enumeration","A ListSecrets API call has been made to the AWS Secrets Manager service. Ensure that this activity is expected and authorized."
"Amazon AWS","CloudTrail","MATCH-S00875","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1070","AWS VPC FLow Log Deletion","Detects when a VPC Flow log is deleted which should be an indicator of defense evasion and removal of compromise traces."
"Amazon AWS","CloudTrail","MATCH-S00674","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.007","AWS WAF Access Control List Updated","Detects the AWS WAF UpdateWebACL API action. UpdateWebACL updates the specified WebACL. A web ACL defines a collection of rules to use to inspect and control web requests. Each rule has an action defined (allow, block, or count) for requests that match the statement of the rule. In the web ACL, you assign a default action to take (allow, block) for any request that does not match any of the rules. The rules in a web ACL can be a combination of the types Rule, RuleGroup, and managed rule group. You can associate a web ACL with one or more AWS resources to protect. The resources can be an Amazon CloudFront distribution, an Amazon API Gateway REST API, an Application Load Balancer, or an AWS AppSync GraphQL API."
"Amazon AWS","CloudTrail","THRESHOLD-S00092","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","AWS WAF Reconnaissance","Detects a variety of AWS WAF API actions that when observed together could indicate an actors intent to enumerate the environment."
"Amazon AWS","CloudTrail","MATCH-S00676","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.007","AWS WAF Rule Group Updated","Detects the AWS WAF UpdateRuleGroup API action. UpdateRuleGroup updates the specified RuleGroup. A rule group defines a collection of rules to inspect and control web requests that you can use in a WebACL. When you create a rule group, you define an immutable capacity limit. If you update a rule group, you must stay within the capacity. This allows others to reuse the rule group with confidence in its capacity requirements."
"Amazon AWS","CloudTrail","MATCH-S00675","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.007","AWS WAF Rule Updated","Detects the AWS WAF UpdateRule API action. UpdateRule inserts or deletes Predicate objects in a rule. Each Predicate object identifies a predicate, such as a ByteMatchSet or an IPSet, that specifies the web requests that you want to allow, block, or count."
"Amazon AWS","CloudTrail","MATCH-S00673","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1562, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.008, _mitreAttackTechnique:T1562.001","AWS WAF Service Tampering","Detects various AWS WAF API actions that involve the deletion of a WAF service."
"","","MATCH-S00814","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1203","Abnormal Child Process - sdiagnhost.exe - CVE-2022-30190","Monitors for exploitation of CVE-2022-30190 as indicated by an abnormal child process for sdiagnhost.exe. More information on this vulnerability can be found at the Microsoft Security Response Center: https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/"
"","","MATCH-S00139","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1036, _mitreAttackTechnique:T1036.004, _mitreAttackTechnique:T1036.005","Abnormal Parent-Child Process Combination","This alert detects a Windows process spawned by a parent process that does not normally spawn it."
"","","MATCH-S00511","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1546, _mitreAttackTechnique:T1546.008","Accessibility Executables Replaced","Observes Sysmon 11 events for accessibility binaries being replaced"
"Microsoft","Windows","THRESHOLD-S00062","threshold","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0007, _mitreAttackTechnique:T1087, _mitreAttackTechnique:T1482, _mitreAttackTechnique:T1087.001, _mitreAttackTechnique:T1087.002","Active Directory Domain Enumeration","Potentially detects an attacker attempting to enumerate active users on the network. Attacks will use enumeration tools such as Bloodhound that will quickly query the domain controller by submitting multiple Kerberos ticket requests with forged device names to gather user and group information for those devices."
"Microsoft","Windows","MATCH-S00189","templated_match","Lateral Movement","False","False","Authentication","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.001, _mitreAttackTechnique:T1021.006","Windows Admin User Remote Logon","Detects remote logins by Administrative users. Administrative users are identified using your local naming convention. Because each environment controls their user naming convention, this rule's expression must first be tailored around your environment and enabled.  Adjust the section that reads:  ""LIKE '%admin%'"" to your environment's administrator naming convention."
"","","MATCH-S01056","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1021.001, _mitreAttackTechnique:T1021, _mitreAttackTactic:TA0008","Administrative Remote Interactive Login","Detection:
This rule triggers on a successful remote interactive login (such as via RDP)  of a privileged .

Scenario:
An attacker who has obtained credentials for a privileged account proceeds to log in to one or more hosts over RDP to further their objectives.

Recommended Actions:
Note that this rule is more relevant in organizations with policies regarding acceptable use of administrative accounts. Determine whether the privileged login is normal activity by reviewing the source IP address and its geo-location, the time of day, whether the accountâ€™s role warrants login to the destination host and potentially contacting the user. If the login is not normal activity, log out all sessions for the compromised account, block the source IP address at the firewall, and review all activity by the account within the timeframe of the login.

Tuning Recommendations:
If appropriate, create a matchlist named RDP_admin_hosts and add names of hosts that are known and approved to have remote administrative logins."
"Alibaba","ActionTrail","MATCH-S00600","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552.005","Alibaba ActionTrail Access Key Action Detected","Actions observed that create, import and delete access keys to EC2 could indicate an adversary is taking action on their objective to extend or otherwise manipulate access to EC2 instance(s)."
"Alibaba","ActionTrail","MATCH-S00601","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1136, _mitreAttackTechnique:T1136.003","Alibaba ActionTrail IAM CreateUser Observed","This signal fires for all observances of the CreateUser action in the IAM event source.  Creating Alibaba Cloud users is likely a benign, infrequent activity.  Hostile actors will create users to persist access.  Use this signal in context of other activity to determine intent."
"Alibaba","ActionTrail","MATCH-S00594","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552.005","Alibaba ActionTrail KMS Activity","Alibaba KMS is an encryption and key management web service.  Besides encrypting and decrypting data, users and administrators can use this service to create keys, manage keys etc.  This signal indicates activity that enables and disables keys explicitly.  This activity has been surveyed to be a low volume event and could be considered suspicious given other activity involving the entity.  Additionally, monitoring for these events is required to achieve certain industry audit compliance."
"Alibaba","ActionTrail","MATCH-S00597","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552.005","Alibaba ActionTrail Key Deleted or Disabled","Deleting cryptographic key material managed by KMS can be risky. The risk is that after key material is deleted, cypher text may remain that is now indecipherable. This signal indicates that a key has been scheduled or canceled for deletion. This signal in context of other signals around this entity may describe a hostile pattern of attack."
"Alibaba","ActionTrail","MATCH-S00593","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","Alibaba ActionTrail ListQueues","This could indicate that an adversary is attempting to collect information for later attack.  When successful, the List Queues event returns all queues that may be valid targets for further probing/attack."
"Alibaba","ActionTrail","MATCH-S00598","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1489, _mitreAttackTechnique:T1578, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1578.004, _mitreAttackTechnique:T1562.008","Alibaba ActionTrail Logging Configuration Change Observed","Changing the configuration of logging to any mission-critical service or platform should be closely monitored.  This signal identifies when Alibaba logging configurations have been changed.  The severity of signals increases depending on the type of action observed.  For instance disabling/deleting logs is a higher severity than enabling logs."
"Alibaba","ActionTrail","MATCH-S00589","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.007","Alibaba ActionTrail Network Access Control List Deleted","Enforcing network-access controls is one of the defensive mechanisms used by cloud administrators to restrict access to a cloud instance. After the attacker has gained control of the console by compromising an admin account, they can delete a network ACL and gain access to the instance from anywhere."
"Alibaba","ActionTrail","MATCH-S00599","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0042, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1078.001","Alibaba ActionTrail Root Login","This signal detects when a successful root account login occurred within an Alibaba account. This privileged account should seldomly be used within an Alibaba cloud environment."
"Alibaba","ActionTrail","MATCH-S00596","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552.005","Alibaba ActionTrail Secrets Manager Activity","Administrative changes to the Alibaba Secrets Manager aren't overtly hostile, but are generally low volume and can be considered sensitive.  These signals highlight when these actions occur and can be used in context of other suspicious activity to raise the risk of a hostile entity.  Several Secrets Manager API actions are included and assessed as sensitive."
"Alibaba","ActionTrail","THRESHOLD-S00608","threshold","Initial Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.005","Alibaba ActionTrail Unauthorized API Calls","An IAM account sent multiple requests to perform a wide distinct number of Alibaba Cloud actions in a short time frame while receiving error codes. This could indicate an account attempting to enumerate their access across the Alibaba account."
"","","MATCH-S00553","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1219","Allowed Inbound RDP Traffic","Detects RDP Traffic to a public-facing asset."
"Amazon AWS","VpcFlowLogs","THRESHOLD-S00003","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1046, _mitreAttackTechnique:T1595, _mitreAttackTechnique:T1595.001, _mitreAttackTechnique:T1595.002","Amazon VPC - Network Scan","Attackers will often perform reconnaissance against customer environments to better understand resources on the network. In doing this behavior they are usually blocked by firewall rules while performing their discovery. This rule looks for a single source IP address network traffic by AWS security groups to at least 10 different destination IP addresses within a 5-minute window."
"Amazon AWS","VpcFlowLogs","THRESHOLD-S00004","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1046, _mitreAttackTechnique:T1595, _mitreAttackTechnique:T1595.001, _mitreAttackTechnique:T1595.002","Amazon VPC - Port Scan","Attackers will often perform reconnaissance against customer environments to better understand resources on the network. In doing this behavior they are usually blocked by firewall rules while performing their discovery. This rule looks for a single source IP address network traffic by AWS security groups to multiple distinct destination port numbers within a short time window."
"Amazon AWS","CloudTrail","MATCH-S00660","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1609","Anomalous AWS User Executed a Command on ECS Container","In general, commands run within a container should be automated via service accounts or conducted by known administrators. Regular users executing commands presents risk and could indicate an attacker attempting to escalate privileges or abuse container resources."
"","","LEGACY-S00001","match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1102, _mitreAttackTechnique:T1102.002, _mitreAttackTechnique:T1102.003","Request to Anomalous Web Server Software","Attackers often stage content during intrusions using external web infrastructure to host exploits, malware and other tooling. In rare cases attacker playbooks show the threat actor hosting web files by serving them using the SimpleHTTPServer server, a lightweight built-in web server module installed with Python. Occurrences of clients connecting to servers implemented using SimpleHTTPServer are anomalous and may indicate an active attack."
"","","MATCH-S00516","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1569, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1542, _mitreAttackTechnique:T1105, _mitreAttackTechnique:T1562.001, _mitreAttackTechnique:T1562.002, _mitreAttackTechnique:T1562.003, _mitreAttackTechnique:T1562.004, _mitreAttackTechnique:T1562.006, _mitreAttackTechnique:T1562.001, _mitreAttackTechnique:T1562.002, _mitreAttackTechnique:T1484.001","Antivirus Ransomware Detection","Malware detected that is determined to be ransomware based on the signature/virus name."
"","","MATCH-S00510","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1553, _mitreAttackTechnique:T1553.002, _mitreAttackTechnique:T1553.004","Attempt to Add Certificate to Store","Observes for attempts to add a certificate to the untrusted store"
"Microsoft","Windows","MATCH-S00415","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1070, _mitreAttackTechnique:T1070.001","Attempt to Clear Windows Event Logs Using Wevtutil","Observes for attempts to clear Windows event logs using wevtutil.

Command line auditing is necessary for this rule to function."
"Microsoft","Windows","MATCH-S00390","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1550, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1550.002","Attempted Credential Dump From Registry Via Reg.Exe","Monitors for use of reg.exe with parameters indicating the attempted export of hashed credentials.

Audit Object Access (success & failure) must be enabled for this rule to function.

Monitoring of the following registry keys is necessary:
HKLM\Security
HKLM\Security\Cache
HKLM\System
HKLM\Security\Policy\Secrets
HKLM\Sam"
"","","MATCH-S00417","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1564, _mitreAttackTechnique:T1564.005, _mitreAttackTechnique:T1564.001","Attrib.exe use to Hide Files and Folders","Observes for use of attrib.exe with the hide flag.

The built in Windows utility attrib.exe can be used by adversaries to hide files and folders from the end user, a form of defense evasion."
"","Auth0","MATCH-S00215","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","Auth0 - High Risk Event","Passthrough rule for high risk events generated by Auth0"
"Amazon AWS","CloudTrail","MATCH-S00685","templated_match","Credential Access","False","False","Authentication","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0001, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1586, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1586.002","Authentication Without MFA","A login was successful where the account did NOT use multi-factor authentication (MFA) to gain access. It is strongly recommended that all accounts used for access require MFA to protect the account in the event credentials are stolen. If MFA is required, it is recommended this rule be enabled for that vendor/product."
"","","CHAIN-S00018","chain","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTactic:TA0001, _mitreAttackTechnique:T1091","Autorun file created after USB disk mount on host","This signal looks for a USB drive being mounted on a Windows host followed by a file creation event with the file name of ""autorun.inf"" within a 5-minute time frame. This activity could be indicative of an attempt at lateral movement or initial access avenues through a USB device. Ensure that the machine in question is authorized to use USB devices and look for other file creation events from this host around the same time frame. This rule logic utilizes Sysmon file creation events, which need to be enabled and configured on relevant assets."
"","","MATCH-S00564","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1134, _mitreAttackTechnique:T1134.002","Azorult Malware Registry Key","Observes for a Windows registry key associated with Azorult malware on a system"
"Microsoft","Azure","MATCH-S00708","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1213, _mitreAttackTechnique:T1213.003","AzureDevOps - Project Visibility Changed to Public","This rule generates a signal when an Azure DevOps project has its visibility changed to a public project."
"Microsoft","Azure","MATCH-S00260","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1199","Azure - External User Invitation Redeemed","Detecets when an external user redeems an invitation to create an Azure account. This can be routine activity, but could be used as a mechanism for adversary persistence."
"Microsoft","Azure","MATCH-S00838","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0003, _mitreAttackTechnique:T1078.004","Azure Active Directory Authentication Method Changed","Threat actors may add rogue devices to various Azure Active Directory authentication services in order to side-step multi factor authentication controls. Added MFA devices may also serve as a persistence mechanism."
"Microsoft","Azure","MATCH-S00226","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1098, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1098.001, _mitreAttackTechnique:T1098.003","Azure - Add Member to Group","Detects a user being added to a group. This may be a routine activity, but could be indicative of an attempt to escalate account privileges. It is recommended to add additional expression logic to this rule to either exclude non-sensitive groups, or to only include sensitive groups."
"Microsoft","Azure","MATCH-S00220","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1098, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1098.001, _mitreAttackTechnique:T1098.003","Azure - Add Member to Role Outside of PIM","Privileged Identity Management (PIM) allows administrators to provide users privileged access with greater oversight of activties undertaken  while said access is granted as well as control over the duration of access.

Adding a user to a role, especially one with administrative privileges, outside of PIM may indicate a threat actor attempting to persist privileged access."
"Microsoft","Azure Storage Analytics","MATCH-S00798","templated_match","Collection","False","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1530, _mitreAttackTechnique:T1619","Azure - Anonymous Blob Access","Detects successful anonymous blob access. This should only occur if a blob container has anonymous read access enabled, which is disabled by default. This could indicate a misconfiguration which may lead to data theft."
"Microsoft","Azure","MATCH-S00896","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1556","Azure Authentication Policy Change","Various authentication related policy configurations exist within Azure - these are tenant-wide policy changes that affect aspects such as enabling of number matching, changing of which authentication methods users are allowed to use, or the exclusion of certain groups from various authentication methods."
"Microsoft","Azure","MATCH-S00805","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1578, _mitreAttackTechnique:T1578.002","Azure - Bastion Host Created/Modified","Detects Azure bastion host creations or modifications (Azure records a write operation for either). A new bastion host may be used by an adversary to gain persistence to Azure resources. Modifications of existing bastion hosts may indicate a compromise of these sensitive hosts."
"Microsoft","Azure","MATCH-S00806","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1578, _mitreAttackTechnique:T1578.003, _mitreAttackTechnique:T1485","Azure - Bastion Host Deleted","Detects Azure bastion host deletions. An adversary might delete a bastion host to deny access to Azure resources."
"Microsoft","Azure","MATCH-S00785","templated_match","Impact","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1485","Azure - Blob Container Deletion","Detects removal of cloud storage infrastructure. This may indicate data destruction."
"","Azure","MATCH-S00836","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1078","Azure Conditional Access Policy Disabled","Azure Conditional Access policies control various aspects of access to Azure resources, including the requirement for multi or strong authentication, disabling of conditional policies outside of expected administrative activity should be investigated for legitimacy."
"Microsoft","Azure","MATCH-S00808","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1610, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1204.003","Azure - Container Instance Creation/Modification","Detects creations or modifications of Azure containers (Azure logs creations or modifications as write operations). An adversary might create a container for use in malicious activity or to evade detection."
"Microsoft","Azure","MATCH-S00809","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1610, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1204.003","Azure - Container Start","Detects Azure container starts. An adversary may use containers for malicious activity or to evade detection."
"Microsoft","Azure","MATCH-S00235","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1136, _mitreAttackTechnique:T1136.002, _mitreAttackTechnique:T1136.003","Azure - Create User","Detects user creation. While this is a routine activity, user creation could be used by an adversary for persistence."
"","","CHAIN-S00022","chain","Defense Evasion","True","False","","_mitreAttackTechnique:T1578, _mitreAttackTactic:TA0005","Azure DevOps - Agent Pool Created and Deleted within a Short Period","Context:
An attacker may create Azure DevOps Agent Pools for malicious activity that are separate from an organizationâ€™s pools.

Detection:
This detection monitors for the creation and deletion of Agent Pools within 5 days by the same user, with the intent of finding Agent Pools active for short durations.

Recommended Actions:
If an alert occurs, investigate the actions taken by the account to determine if this is normal operation of deleting pools or if this suspicious activity. 

Tuning Recommendations: 
If necessary, add a tuning expression for users who frequently create and delete agent pools within the time period specified.
If necessary, adjust the ""within"" time period to better represent what is considered a short time period in your organization. Note that 5 days is the maximum time period you can specify for a chain rules.

Credits: 
This rule is loosely based on the Azure Sentinel ADOAgentPoolCreatedDeleted.yaml detection.
"
"","","MATCH-S00997","templated_match","Credential Access","True","False","","_mitreAttackTechnique:T1528, _mitreAttackTactic:TA0006","Azure DevOps - Browser Observed in Personal Access Token (PAT) Use","Context:
Personal Access Tokens (PATs) can be used to authenticate into Azure DevOps. PATs are intended to be used for authenticating automated access to Azure rather than for interactive use cases. Observing PAT authentication in interactive use cases could indicate that the PAT was stolen.

Detection:
This detection monitors for the use of a PAT for authentication from a User Agent String indicating a web browser.

Recommended Actions:
Investigate the user account associated with the Personal Access Token and the userâ€™s workstation for signs of compromise.

Tuning Recommendations:
If your organization has known legitimate use cases for PAT authentication with a browser, add a tuning expression specific to the known use case. For example, you may tune out specific users, user agent strings or IP addresses as known use cases.

Credits:
This detection is based on the Azure Sentinel ADOPATUsedWithBrowser.yaml rule."
"","","MATCH-S00995","templated_match","Unknown/Other","True","False","","_mitreAttackTechnique:T1098.003","Azure DevOps - Change Made to Administrator Group","Context:
Any additions to administrative groups such as Project Administrators or Project Collection Administrators is noteworthy as they result in the user having a broad set of permissions.

Detection:
This detection monitors for additions to the following groups: Project Administrators, Project Collection Administrators, Project Collection Service Accounts, Build Administrators, Project Collection Build Administrators

Recommended Actions:
Determine whether the group modification was an approved change (for example, look for a change control ticket).
Investigate the user who modified the group for indications of account compromise or other insider threat activity.

Tuning Recommendations:
n/a

Credits:
This detection is based on the Azure Sentinel AzDOAdminGroupAdditions.yaml rule."
"","","FIRST-S00098","first_seen","Unknown/Other","True","False","","_mitreAttackTechnique:T1098.001","Azure DevOps - First Seen Pull Request Policy Bypassed","Context:
An attacker can use pull request bypasses to introduce malicious code into production by circumventing normal review processes.

Detection:
This detection monitors for when a user performs a pull request bypass for the first time.

Tuning Recommendations:
If there is a known use case for pull request bypasses (emergency updates, lack of available review staff, etc.), add a tuning expression to exclude the user from the detection.

Recommended Actions:
Determine whether the pull request bypass was expected.
Investigate the user who performed the pull request bypass for indications of account compromise or other insider threat activity.

Credits:
This detection is based on the Azure Sentinel AzDOHistoricPrPolicyBypassing.yaml rule."
"","","FIRST-S00099","first_seen","Defense Evasion","True","False","","_mitreAttackTechnique:T1578.002, _mitreAttackTactic:TA0005","Azure DevOps - First Seen User Creating Agent Pool","Context:
Azure DevOps (ADO) Agent Pools are a key resource. Hosted or self-hosted pools can be created for use in the DevOps pipeline. An attacker with ADO access allowing for pool creation, may create agent pools for malicious use.

Detection:
This detection monitors for new users creating an agent pool. This user has not been observed creating agent pools during the baseline period and may be a new admin or involved in suspicious account activity.

Recommended Actions:
Investigate the account observed creating the new agent pool for signs of account compromise or insider threat activity.

Tuning Recommendations:
Create a tuning expression with a list of admin user_username values that should be excluded from detection if they were not in the baseline."
"","","FIRST-S00092","first_seen","Unknown/Other","True","False","","_mitreAttackTechnique:T1578.005","Azure DevOps - First Seen User Creating Release Pipeline","Context:
Creation or modification of release pipelines provide opportunities for the attacker to introduce malicious code into the release process.
Detection:
This detection monitors for users creating a release pipeline for the first time after the baseline period (by default, 90 days).
Recommended Actions:
Investigate the pipeline that has been created for malicious content and the user account activity for signs of account compromise or insider threat activity.
Tuning Recommendations:
Maintain a match list of users known and approved to create Azure DevOps pipeline and add it as a tuning expression for the rule.
Credits:
This detection is based on the Azure Sentinel ADOPipelineModifiedbyNewUser.yaml rule."
"","","FIRST-S00097","first_seen","Unknown/Other","True","False","","_mitreAttackTechnique:T1578.005","Azure DevOps - First Seen User Modifying Build Variables","Context:
An attacker can modify a variable group to alter the execution of the build pipeline for malicious results.

Detection:
This detection monitors for a user modifying a variable group for the first time.

Recommended Actions:
Determine whether the variable group modification was a known change.
Investigate the user who reduced the retention setting for indications of account compromise or other insider threat activity.

Tuning Recommendations:
Maintain a match list of users known and approved to modify variable groups and add it as a tuning expression for the rule.

Credits:
This detection is based on the Azure Sentinel ADOVariableModifiedByNewUser.yaml rule."
"","","FIRST-S00096","first_seen","Unknown/Other","True","False","","_mitreAttackTechnique:T1578.005","Azure DevOps - First Seen User Modifying Release Pipeline","Context:
Creation or modification of release pipelines provide opportunities for the attacker to introduce malicious code into the release process.

Detection:
This detection monitors for users modifying a release pipeline for the first time after the baseline period (by default, 90 days).

Recommended Actions:
Investigate the pipeline that has been created for malicious content and the user account activity for signs of account compromise or insider threat activity.

Tuning Recommendations:
Maintain a match list of users known and approved to create Azure DevOps pipeline and add it as a tuning expression for the rule.

Credits:
This detection is based on the Azure Sentinel ADOPipelineModifiedbyNewUser.yaml rule."
"","","MATCH-S00998","templated_match","Collection","True","False","","_mitreAttackTechnique:T1119, _mitreAttackTactic:TA0009","Azure DevOps - Known Malicious Tooling Detected ADOKit","Context:
The IBM X-Force Red team released the Azure DevOps Services Attack Toolkit (ADOKit) for Black Hat Arsenal 2024.

Detection:
This is a simple detection matching on â€œADOKitâ€ at the start of the HTTP User Agent String (UAS). This detection effectively catches basic ADOKit use. It is brittle to attackers changing the User Agent String to another more innocuous browser to mask the traffic.

Recommended Actions: 
Determine the user using the ADOKit tooling and the activities they have taken against the Azure DevOps environment.

Tuning Recommendations:
Create a rule tuning expression to tune out accounts permitted to use ADOKit, such as red teams, penetration testers, or admin users. 

Credits:
This detection is based on the Azure Sentinel ADOMaliciousToolingDetections1.yaml detection."
"","","MATCH-S00994","templated_match","Unknown/Other","True","False","","_mitreAttackTechnique:T1078.004","Azure DevOps - Member Added to Sensitive Group","Context:
Any changes to administrative groups such as Project Administrators or Project Collection Administrators is noteworthy as they result in the user having a broad set of permissions.

Detection:
This detection monitors for changes to the following groups: Project Administrators, Project Collection Administrators, Project Collection Service Accounts, Build Administrator

Recommended Actions:
Determine whether the group modification was an approved change (for example, look for a change control ticket).
Investigate the user who modified the group for indications of account compromise or other insider threat activity.

Tuning Recommendations:
n/a

Credits:
This detection is based on the Azure Sentinel NewPAPCAPCASaddedtoADO.yaml rule."
"","","FIRST-S00095","first_seen","Unknown/Other","True","False","","_mitreAttackTechnique:T1053","Azure DevOps - New Agent OS Added to Agent Pool","Context:
An attacker could add an agent to an agent pool for the purpose of running malicious code during pipeline execution.

Detection:
This detection monitors for the addition of an agent to an agent pool when the OS of the agent has not been observed in this pool during the baseline period.

Recommended Actions:
Investigate whether the addition of the agent was an expected activity.
Review build artifacts resulting from the pipeline for malicious code.
Review execution activity on the agent during pipeline execution.
Investigate the user for indications of account compromise or insider threat activity.

Tuning Recommendations:
Add tuning expressions to exclude known agent additions in which the agent has a distinct operating system from the pool baseline. The tuning expression could be based on metadata such as the user or the OS.

Credits:
This detection is based on the Azure Sentinel NewAgentAddedToPoolbyNewUserorofNewOS.yaml rule."
"","","FIRST-S00094","first_seen","Persistence","True","False","","_mitreAttackTechnique:T1505, _mitreAttackTactic:TA0003","Azure DevOps - New Extension Installed","Context:
Azure DevOps can add extensions for additional features. Attackers with sufficient privileges may install a malicious extension for malicious use. 

Detection:
This detection monitors for new extensions installed organization-wide after a 30-day baseline, based on the user installing the new extension.

Recommended Actions: 
As new extensions are installed, investigate the user engaging in the activity to assess the intent. Review whether the user has been active and engaged in other suspicious activity.  

Tuning Recommendations:
Add a tuning expression with user_username values or a match list for users known and trusted to install extensions. 
A tuning expression of permitted PublisherName values can be used to add further filtering. You may want to increase the severity of this rule if your organization only permits certain PublisherNames.
 
Credits:
This detection is based on the Azure Sentinel ADONewExtensionAdded.yaml rule."
"","","OUTLIER-S00030","outlier","Defense Evasion","True","False","","_mitreAttackTechnique:T1578.002, _mitreAttackTactic:TA0005","Azure DevOps - Outlier in Pools Deleted Rapidly","Context:
An Attacker with sufficient administrative access to Azure DevOps (ADO) may abuse this access to destroy existing resources by deleting pools. 

Detection:
This detection identifies statistical outliers in user behavior for the number of pools deleted in an hourly window. 

Recommended Actions: 
If an alert occurs, investigate the actions taken by the account to determine if this is normal operation of deleting pools or if this suspicious activity. 

Tuning Recommendations:
Determine if the baseline basis should be hourly or daily based on normal activity in your organization. 
If the detection is proving to be too sensitive to the number of pools deleted, adjust the floor value (currently 3) to a number that is less sensitive but within reason. Use Sumo Search using a count and the _timeslice function to aggregate on the number of pools deleted within the hourly (or daily) periods to find what is an acceptable level of activity to not alert on."
"","","MATCH-S00996","templated_match","Unknown/Other","True","False","","_mitreAttackTechnique:T1496","Azure DevOps - Personal Access Token (PAT) Misuse Observed","Context:
Authentication to Azure DevOps via a Personal Access Token (PAT) is intended for particular use cases and should not be observed with all actions in Azure. This Alert detects whenever a PAT is used in ways that PATs are not normally used. If unusual PAT use is observed it potentially indicates the PAT was stolen by an attacker.

Detection:
This detection monitors for use of a Personal Access Token in conjunction with categories of action that arenâ€™t normally associated with PAT authentication.

Recommended Actions:
Determine whether the PAT use is part of a known and approved use case.
Investigate the user whose PAT was used for indications of account compromise or other insider threat activity. 
Investigate the workstation of the user for indications of compromise.

Tuning Recommendations:
If your organization has known use cases, such as automation, that trigger this rule, add a tuning expression to exclude either the action or other distinguishing metadata such as the user.

Credits:
This detection is based on the Azure Sentinel AzDOPatSessionMisuse.yaml rule."
"","","CHAIN-S00021","chain","Unknown/Other","True","False","","_mitreAttackTechnique:T1072","Azure DevOps - Pipeline Created and Deleted within a Short Period","Context:
An attacker may use a pipeline for malicious activity such as introducing malicious code into production or executing malicious code in an agent pool. The attacker likely will delete the pipeline after achieving their objectives in order to cover their tracks.

Detection:
This detection monitors for the creation and deletion of the same pipeline within a short period (by default, a day).

Recommended Actions:
Investigate whether the rapid creation and deletion of the pipeline was an expected activity. 
Review build artifacts resulting from the pipeline for malicious code. 
Investigate the user for indications of account compromise or insider threat activity.

Tuning Recommendations:
Adjust the time constraints of the rule from one day to one which aligns better to the practices in your organization. 
If there are known use cases for rapid creation and deletion of pipelines in your organization, add a tuning expression to exclude the distinguishing metadata such as the username.

Credits:
This detection is based on the Azure Sentinel AzDOPipelineCreatedDeletedOneDay.yaml rule.
"
"","","MATCH-S00993","templated_match","Unknown/Other","True","False","","_mitreAttackTechnique:T1564","Azure DevOps - Pipeline Retention Settings Reduced","Context:
AzureDevOps retains items such as run records and produced artifacts for a configurable amount of time. An attacker can cover up evidence of malicious activity by reducing the retention time.

Detection:
This detection monitors for any reduction in the pipeline retention settings.

Tuning Recommendations:
n/a

Recommended Actions:
Determine whether the retention setting reduction was an approved change (for example, look for a change control ticket).
Investigate the user who reduced the retention setting for indications of account compromise or insider threat activity.

Credits:
This detection is based on the Azure Sentinel ADORetentionReduced.yaml rule."
"Microsoft","Azure","MATCH-S00795","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.008, _mitreAttackTechnique:T1562.001","Azure - Diagnostic Setting Deleted","Detects diagnostic setting deletions, which may represent an adversary disabling logging."
"Microsoft","Azure","MATCH-S00796","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.008, _mitreAttackTechnique:T1562.001","Azure - Diagnostic Setting Modified","Detects diagnostic setting modifications, which include disabling certain logging, enabling certain logging, altering the destination of logs, or creating a diagnostic setting."
"Microsoft","Azure","MATCH-S00797","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.008, _mitreAttackTechnique:T1562.001","Azure - Event Hub Deleted","Detects Azure Event Hub deletions. Event Hubs are the primary method for logs to be forwarded to a destination outside of Azure (such as a SIEM) and as such, deleting an Event Hub may compromise monitoring."
"Microsoft","Azure","THRESHOLD-S00109","threshold","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1526, _mitreAttackTechnique:T1003","Azure - Excessive Key Vault Get Requests","Detects get requests against Vaults, Secrets, and Keys of 25 or greater in a 24 hour period. This may indicate credential access.

 Certain AppId's may need to be excluded if they are expected to be regularly making these requests. Azure Resource Graph's AppId is excluded already."
"Microsoft","Azure","MATCH-S00256","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1199","Azure - External User Invited","Detects an invitation being created for an external use to create an Azure account. This may be routine activity, but could be used as a vector for an adversary to gain access or persistence."
"","","MATCH-S00864","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.007","Azure Firewall Rule Modified","The Azure Firewall may provide egress and ingress controls for a variety of Azure services, unexpected or unplanned firewall modifications should be investigated."
"Microsoft","Azure","MATCH-S00254","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTactic:TA0009, _mitreAttackTechnique:T1069, _mitreAttackTechnique:T1530, _mitreAttackTechnique:T1069.002, _mitreAttackTechnique:T1069.003","Azure - Group Information Downloaded","Detects group information enumeration. This could be used by an adversary to learn about the environment"
"Microsoft","","MATCH-S00243","templated_match","Initial Access","True","False","Authentication","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0042, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1586, _mitreAttackTechnique:T1586.002, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.004","Azure - High Risk Sign-In (Aggregate)","Detects Azure high aggregate risk for a user sign in. https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/troubleshooting-identity-protection-faq"
"Microsoft","","MATCH-S00245","templated_match","Initial Access","True","False","Authentication","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0042, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1586, _mitreAttackTechnique:T1586.002, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.004","Azure - High Risk Sign-In (Real Time)","Detects Azure high real-time risk for a user sign in. https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/troubleshooting-identity-protection-faq"
"Microsoft","Azure","MATCH-S00807","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1612, _mitreAttackTechnique:T1525, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1204.003","Azure - Image Created/Modified","Detects creations or modifications of Azure images (Azure logs creations or modifications as write operations). Adversaries may attempt to create malicious images directly on a cloud deployment to avoid detection and establish persistence."
"Microsoft","Azure","MATCH-S00810","templated_match","Impact","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1485","Azure - Image Deleted","Detects deletions of Azure images. An adversary may try to destroy data or compromise backups by deleting an image."
"Microsoft","Azure","MATCH-S00788","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1485, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552.005","Azure - Key Deletion","Detects deletions of Azure Key Vault Keys. If a key is not backed up or otherwise recoverable (See soft-delete) it may render content indecipherable, leading to data loss."
"Microsoft","Azure","MATCH-S00789","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1485, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552.005","Azure - Key Purged","Detects purges of Azure Key Vault Keys. If a key is not backed up it may render content indecipherable, leading to data loss. Key purges are performed on already deleted keys and must be explicitly allowed by the access policy as it redners them unrecoverable unless a backup was made."
"Microsoft","Azure","MATCH-S00792","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1485","Azure - Key Vault Deleted","Detects deletions of Azure Key Vaults. If a vault is not backed up it may render content indecipherable, leading to data loss."
"Microsoft","Azure","MATCH-S00231","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1098, _mitreAttackTechnique:T1098.001, _mitreAttackTechnique:T1098.002","Azure - Member Added to Global Administrator Role","Detects member additions to the Global Administrator role outside of Privileged Identity Manager (PIM). This is a suspicious activity, and could be performed by an adversary to escalate privileges."
"Microsoft","Azure","MATCH-S00233","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1098, _mitreAttackTechnique:T1098.001, _mitreAttackTechnique:T1098.002","Azure - Member Added to Global Administrator Role Non-PIM","Detects member additions to the Global Administrator role outside of Privileged Identity Manager (PIM). This is a suspicious activity, and could be performed by an adversary to escalate privileges."
"Microsoft","Azure","MATCH-S00229","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1098, _mitreAttackTechnique:T1098.001, _mitreAttackTechnique:T1098.002","Azure - Member Added to Non-Global Administrator Role","Detects member additions to a non-administrative role. This is a routine activity, but could be performed by an adversary to escalate privileges."
"Microsoft","","MATCH-S00891","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1550.001","Azure OAUTH Application Consent from User","Depending on configurations, Azure Active Directory users or administrators may be able to consent to API permissions for various Azure AD applications, these permissions can grant adversaries access to various Azure resources, depending on the type of permissions being granted."
"Microsoft","","MATCH-S00818","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1078, ta, _mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526, _mitreAttackTechnique:T1098","Azure PRT Token Issued via Non Interactive Login","Azure Primary Refresh Tokens (PRT) can be used to authenticate  to Azure Active Directory and Azure compute resources. This rule looks for a PRT token successfully issued via a non-interactive login and when a suspicious User Agent is in use."
"","Azure","MATCH-S00140","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","Azure - Policy Added","This rule is designed to monitor for conditional access policy additions. It is recommended to include or exclude certain policies from monitoring for better security value, expressions are below for inclusion and exclusion.   AND application in ('policy','example')   AND application not in ('policy','example')"
"","Azure","MATCH-S00142","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","Azure - Policy Deleted","This rule is designed to monitor for conditional access policy deletions. It is recommended to include or exclude certain policies from monitoring for better security value, expressions are below for inclusion and exclusion.  AND application in ('policy','example'). AND application not in ('policy','example')"
"","Azure","MATCH-S00144","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","Azure - Policy Updated","This rule is designed to monitor for conditional access policy updates. It is recommended to include or exclude certain policies from monitoring for better security value, expressions are below for inclusion and exclusion.  AND application in ('policy','example')  AND application not in ('policy','example')"
"","Azure","MATCH-S00787","templated_match","Impact","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1485","Azure - Protected Item Deletion Attempt","Detects the attempted deletion of protected items in Azure, such as backups. This may be an indicator of attempted data destruction."
"Microsoft","","MATCH-S00224","templated_match","Initial Access","True","False","Authentication","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0042, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1586, _mitreAttackTechnique:T1586.002, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.004","Azure - Risky User State : User Confirmed Compromised","This rule detects that an administrator has flagged a sign-in in Identity Protection as not having been performed by the account owner, indicating a compromise."
"Microsoft","Azure","MATCH-S00786","templated_match","Exfiltration","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTechnique:T1578.001, _mitreAttackTechnique:T1578","Azure - SQL Database Export","A database export, especially to a public blob container, may indicate data exfiltration in progress."
"Microsoft","Azure","MATCH-S00794","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0010, _mitreAttackTechnique:T1555","Azure - Secret Backup","Detects Secret backups within the Azure Key Vault. This may be an indication of data exfiltration and credential compromise."
"Microsoft","Azure","MATCH-S00791","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1485, _mitreAttackTechnique:T1552.005, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552","Azure - Secret Deleted","Detects deletions of Azure Key Vault Secrets. If a secret is not backed up or otherwise recoverable (see soft delete) it may render content indecipherable, leading to data loss."
"Microsoft","Azure","MATCH-S00790","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1485, _mitreAttackTechnique:T1552.005","Azure - Secret Purged","Detects purges of Azure Key Vault Secrets. If a Secret is not backed up it may render content indecipherable, leading to data loss. Secret purges are performed on already deleted secrets and must be explicitly allowed by the access policy as it renders them unrecoverable unless a backup was made."
"Microsoft","Azure","MATCH-S00800","templated_match","Impact","True","False","","_mitreAttackTechnique:T1530, _mitreAttackTechnique:T1485, _mitreAttackTactic:TA0040","Azure - Storage Deletion","Detects deletions within an Azure Storage Account.  Deletions of shares and public storage blobs may indicate data destruction."
"Microsoft","Azure","MATCH-S00799","templated_match","Exfiltration","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTechnique:T1530","Azure - Storage Modification","Detects modifications within an Azure Storage Account. Write events encapsulate both creations and changes to existing objects. Creation or modifications of shares and public storage blobs may indicate exfiltration attempts."
"Microsoft","","MATCH-S00250","templated_match","Initial Access","True","False","Authentication","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0042, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1586, _mitreAttackTechnique:T1586.002, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.004","Azure - Suspicious User Risk State Associated with Login","Detects if a sign in has been flagged as ""at risk"" by Azure Active Directory."
"Microsoft","Azure","MATCH-S00303","templated_match","Execution","False","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1550, _mitreAttackTechnique:T1550.001","Azure - Unauthorized OAuth Application","Alert when a non-approved OAuth Application has been identified on Azure. This rule is disabled by default as a list of approved OAuth applications is required to be enabled. The approved applications should be added to the rule logic under the 'application not in' condition."
"Microsoft","Azure","MATCH-S00252","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTactic:TA0009, _mitreAttackTechnique:T1069, _mitreAttackTechnique:T1530, _mitreAttackTechnique:T1069.002, _mitreAttackTechnique:T1069.003","Azure - User Information Downloaded","Detects a user list download. This may be routine activity, or indiciative of an adversary gathering information about the environment"
"Microsoft","Azure","MATCH-S00803","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1578, _mitreAttackTechnique:T1578.002","Azure - Virtual Machine Creation/Modification","Detects Azure virtual machine creations or modifications (Azure records a write operation for either). A new virtual machine may be used by an adversary to perform malicious activity."
"Microsoft","Azure","MATCH-S00804","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1578, _mitreAttackTechnique:T1578.003, _mitreAttackTechnique:T1485","Azure - Virtual Machine Deleted","Detects deletions of Azure virtual machines. Virtual machines may be deleted by an adversary to cover their tracks. Additionally, virtual machines might be deleted purely to cause damage."
"Microsoft","Azure","MATCH-S00839","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1204","Azure Virtual Machine RunCommand Issued","Azure provides administrators with the ability to issue commands to Azure Virtual Machines via CLI or the Azure portal. Threat actors may use Azure privilege to run commands on virtual machines in order to further their access or move from the control plane to the compute portion of Azure."
"Microsoft","Azure","MATCH-S00801","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1578, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1204.003","Azure - Virtual Machine Started","Detects a virtual machine starting in Azure. This is most likely routine activity, however virtual machines may also be used for malicious activity."
"Microsoft","Azure","MATCH-S00802","templated_match","Impact","True","False","","_mitreAttackTechnique:T1578, _mitreAttackTechnique:T1578.004, _mitreAttackTactic:TA0040","Azure - Virtual Machine Stopped","Detects a virtual machine starting in Azure. This is most likely routine activity, however virtual machines may also be used for malicious activity."
"","","MATCH-S00486","templated_match","Command and Control","True","False","NetworkHTTP","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Backdoor.HTTP.BEACON.[CSBundle CDN GET]","From FireEye Red Team Tool Countermeasures:
Network detection   rule that looks for specific HTTP headers related to the HTTP GET request   content designated within the Cobalt Strike malleable C2 profile."
"","","MATCH-S00496","templated_match","Command and Control","True","False","NetworkHTTP","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Backdoor.HTTP.BEACON.[CSBundle NYTIMES Server]","From FireEye Red Team Tool Countermeasures:"
"","","MATCH-S00495","templated_match","Command and Control","True","False","NetworkHTTP","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Backdoor.HTTP.BEACON.[CSBundle Original GET]","From FireEye Red Team Tool Countermeasures:
Network detection rule that looks for specific HTTP headers and URI content. This is related to the HTTP GET request content designated within the Cobalt Strike malleable C2 profile."
"","","MATCH-S00489","templated_match","Command and Control","True","False","NetworkHTTP","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Backdoor.HTTP.BEACON.[CSBundle Original POST]","From FireEye Red Team Tool Countermeasures:
Network detection rule that looks for specific HTTP header and URI values. These are related to the HTTP POST request content designated within the Cobalt Strike malleable C2 profile."
"","","MATCH-S00488","templated_match","Command and Control","True","False","NetworkHTTP","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Backdoor.HTTP.BEACON.[CSBundle USAToday GET]","From FireEye Red Team Tool Countermeasures:
Network detection rule that looks for specific HTTP headers and URI content. This is related to the HTTP GET request content designated within the Cobalt Strike malleable C2 profile."
"","","MATCH-S00474","templated_match","Command and Control","True","False","NetworkHTTP","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Backdoor.HTTP.BEACON.[Yelp GET]","From FireEye Red Team Tool Countermeasures:
Network detection rule that looks for specific HTTP header and URI values. These are related to the HTTP GET request content designated within the Cobalt Strike malleable C2 profile."
"","","MATCH-S00494","templated_match","Command and Control","True","False","NetworkHTTP","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Backdoor.HTTP.BEACON.[Yelp Request]","From FireEye Red Team Tool Countermeasures:
Network detection rule that looks for specific HTTP header for either a POST or GET request. These are related to the HTTP request content designated within the Cobalt Strike malleable C2 profile."
"","","MATCH-S00497","templated_match","Command and Control","True","False","NetworkHTTP","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Backdoor.HTTP.GORAT.[POST]","From FireEye Red Team Tool Countermeasures:
GORAT is the modular backdoor portion of the REDFLARE framework. This rule looks for unique content within the HTTP request communications of the backdoor."
"","","MATCH-S00485","templated_match","Command and Control","True","False","NetworkHTTP","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Backdoor.HTTP.BEACON.[CSBundle MSOffice GET]","From FireEye Red Team Tool Countermeasures: Network detection rule that looks for a specific HTTP URI value in combination with HTTP header values and payload content. These are related to the HTTP GET request values designated within the Cobalt Strike malleable C2 profile."
"","","MATCH-S00484","templated_match","Command and Control","True","False","NetworkHTTP","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Backdoor.HTTP.BEACON.[CSBundle MSOffice POST]","From FireEye Red Team Tool Countermeasures: Network detection rule that looks for a specific HTTP URI value in combination with HTTP header values and payload content. These are related to the HTTP POST request values designated within the Cobalt Strike malleable C2 profile."
"","","MATCH-S00490","templated_match","Command and Control","True","False","NetworkHTTP","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Backdoor.HTTP.BEACON.[CSBundle NYTIMES GET]","From FireEye Red Team Tool Countermeasures: Network detection rule that looks for specific HTTP headers and URI content. This is related to the HTTP GET request content designated within the Cobalt Strike malleable C2 profile."
"","","MATCH-S00491","templated_match","Command and Control","True","False","NetworkHTTP","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Backdoor.HTTP.BEACON.[CSBundle Original Stager]","From FireEye Red Team Tool Countermeasures: Network detection rule that looks for specific HTTP headers and URI content. This is related to the HTTP GET and POST request content designated within the Cobalt Strike malleable C2 profile."
"","","MATCH-S00487","templated_match","Command and Control","True","False","NetworkHTTP","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Backdoor.HTTP.BEACON.[CSBundle USAToday Server]","From FireEye Red Team Tool Countermeasures: Network detection rule that looks for specific response body content within Cobalt Strike malleable C2 profile. This is used as an attempt to blend in and provide legitimacy within the malware C2 communications."
"","","MATCH-S00492","templated_match","Command and Control","True","False","NetworkHTTP","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Backdoor.HTTP.GORAT.[SID1]","From FireEye Red Team Tool Countermeasures: GORAT is the modular backdoor portion of the REDFLARE framework. This rule looks for unique content within the HTTP request communications of the backdoor."
"","","MATCH-S00493","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1573, _mitreAttackTechnique:T1573.001, _mitreAttackTechnique:T1573.002","Backdoor.SSL.BEACON.[CSBundle Ajax]","From FireEye Red Team Tool Countermeasures: Network detection rule that looks for specific SSL/TLS certificate metadata attempting to masquerade as a legitimate certificate. The content in this rule is looking for a self-signed certificate which is designated within the Cobalt Strike malleable C2 profile."
"","","LEGACY-S00003","match","Exfiltration","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1132.001, _mitreAttackTechnique:T1132","Base32 in DNS Query","By using base32, binary and text data can be encoded in a way that is fully compliant with DNS protocol specifications.  Since common standard base32 uses 2-7 and the letters a-z, entropy must be measured to distinguish from normal text.  The presence of long base32 encoding in a DNS query may indicate tunneling of information out of a network.  Some security vendors and internet providers also use this technique to operate cloud infrastructure or transport information through firewalled environments."
"","","MATCH-S00686","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1140, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1132.001, _mitreAttackTechnique:T1132","Base64 Decode in Command Line","Malicious files are often encoded in an attempt to bypass security controls that would otherwise inspect the contents of said file. An attacker would then need to decode the malicious file for use on the victim machine using a utility such as certutil or the base64 command. This rule supports detection for standard decoding utilities on Unix, Windows cmd, Windows PowerShell, and MacOS."
"","","MATCH-S00688","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1070, _mitreAttackTechnique:T1070.003","Bash History Tampering","This rule monitors for various methods of deleting or otherwise tampering with .bash_history files which store command history on Linux machines."
"Microsoft","Windows","MATCH-S00541","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003","Batch File Write To System32","The rule looks for a batch file (.bat) written to the Windows system directory tree."
"","","LEGACY-S00004","match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1197","Bitsadmin to Uncommon TLD","Detects BITS connections to external domains with uncommon TLDs. Reference: https://isc.sans.edu/forums/diary/Investigating+Microsoft+BITS+Activity/23281/"
"","","LEGACY-S00005","match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Possible Black Energy Command and Control","Black Energy is a botnet with HTTP based Command and Control communication"
"","Bro","LEGACY-S00006","match","Unknown/Other","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Blocked Email Host","The originator's address is seen in the block list error message, which means an SMTP server sent a reply mentioning an SMTP block list. This is useful to detect local hosts sending SPAM with a high positive rate."
"","Bro","LEGACY-S00007","match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Blocked Email Message","An SMTP server sent a reply mentioning an SMTP block list."
"","","MATCH-S00373","templated_match","Execution","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1574, _mitreAttackTechnique:T1574.002, _mitreAttackTechnique:T1055, _mitreAttackTechnique:T1055.001, _mitreAttackTechnique:T1129","BlueMashroom DLL Load","Detects a suspicious DLL loading from AppData Local path as described in BlueMashroom report"
"Symantec","Proxy Secure Gateway","LEGACY-S00009","match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Bluecoat Proxy - Suspicious or Malicious Categories","This rule triggers any time there is a Suspicious or Malicious Bluecoat category which could indicate there is a problem with the host making the connection. "
"","","LEGACY-S00010","match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1203","Browser Exploitation Framework (BeEF) Hook","The Browser Exploitation Framework (BeEF) is a penetration-testing tool focusing on web browsers. This rule looks for HTTP communication that include the default BeEF cookie, which indicates a hooked browser."
"Microsoft","Azure","THRESHOLD-S00096","threshold","Initial Access","True","False","Authentication","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1110, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1586, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1110.002, _mitreAttackTechnique:T1110.001","Brute Force Attempt","Detects multiple failed login attempts for the same username over a 24 hour timeframe. This is designed to catch both slow and quick brute force type attacks. The threshold and time frame can be adjusted based on the customer's environment."
"","","MATCH-S00388","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.002","COMPlus_ETWEnabled Command Line Arguments","Potential adversaries stopping ETW providers recording loaded .NET assemblies."
"","","MATCH-S00727","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218.002","CPL File Executed from Temp Directory","CPL files are DLL libraries that export a CPlApplet and are normally executed via the Windows Control Panel GUI interface. Having these files executed via the 'control' command from a temp directory is a strong indicator that an attacker has renamed a malicious DLL file as a CPL file and is attempting execution."
"","","MATCH-S00209","templated_match","Unknown/Other","True","True","","_mitreAttackTactic:TA0043, _mitreAttackTechnique:T1595, _mitreAttackTechnique:T1595.001, _mitreAttackTechnique:T1595.002, _mitreAttackTechnique:T1189, _mitreAttackTechnique:T1190, _mitreAttackTechnique:T1133","CVE-2021-44228 Log4j2 Java Library 0-Day Attempt","Apache Log4j2 <=2.14.1 using JNDI features has an exploit allowing attackers to perform unauthenticated, remote code execution on a Java application that logs user input. This CSE rule looks for attackers attempting to input the string ""jndi:"" into a field that the application may log to trigger the payload download and execution. This does NOT indicate the application is vulnerable and downloaded the malicious payload, but it does show a hostile actor attempting the attack method."
"Microsoft","Azure","CHAIN-S00017","chain","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1078.004","Change of Azure MFA Method followed by Risky SignIn","This alert looks for an Azure MFA authentication method change, followed by a risky sign in detected by Azure within a six hour time period for the same user account."
"Microsoft","Windows","MATCH-S00821","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1555.003","Chromium Browser History Access by Non-Browser Process","Chromium history files contain a wealth of information regarding browser usage patterns. Threat actors may enumerate Chromium history, bookmarks and cookies in order to extract sensitive information from systems."
"","","MATCH-S00897","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1176","Chromium Extension Installed","Threat actors may install browser extensions as a form of persistence on victim systems. Look up the 32 character extension ID in order to ensure that the extension is valid and expected to be installed as part of normal business operations. This extension ID can be found in the following values: {{file_path}} and/or {{changeTarget}} depending on the source of the telemetry. This rule logic utilizes Sysmon file creation events, which need to be enabled and configured on relevant assets."
"","","MATCH-S00819","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1555.003, _mitreAttackTechnique:T1606.001, _mitreAttackTechnique:T1539","Chromium Process Started With Debugging Port","Chromium (Microsoft Edge or Google Chrome) browsers can be started with a remote debugging port. Threat actors may then connect to this debugging port to enumerate browser information or steal session data including browser cookies."
"Cisco Systems","Stealthwatch","MATCH-S00074","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1190","Cisco Stealthwatch Template Alerts","Passthrough alerts from Cisco Stealthwatch"
"Cisco Systems","Umbrella","LEGACY-S00190","match","Collection","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.004","Cisco Umbrella - DNS Request Category: Adware","Cisco Umbrella detected a DNS request to a domain categorized as Adware."
"Cisco Systems","Umbrella","LEGACY-S00191","match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.004","Cisco Umbrella - DNS Request Category: Command and Control","Cisco Umbrella detected a DNS request to a domain categorized as Command and Control."
"Cisco Systems","Umbrella","LEGACY-S00192","match","Execution","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1496, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.004","Cisco Umbrella - DNS Request Category: Cryptomining","Cisco Umbrella detected a DNS request to a domain categorized as Cryptomining."
"Cisco Systems","Umbrella","LEGACY-S00193","match","Exfiltration","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTechnique:T1048, _mitreAttackTechnique:T1048.003, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.004","Cisco Umbrella - DNS Request Category: DNS Tunneling VPN","Cisco Umbrella detected a DNS request to a domain categorized as Adware."
"Cisco Systems","Umbrella","LEGACY-S00194","match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1568, _mitreAttackTechnique:T1568.001, _mitreAttackTechnique:T1568.003, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.004","Cisco Umbrella - DNS Request Category: Dynamic DNS","Cisco Umbrella detected a DNS request to a domain categorized as Dynamic DNS."
"Cisco Systems","Umbrella","LEGACY-S00195","match","Unknown/Other","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.004","Cisco Umbrella - DNS Request Category: Hacking","Cisco Umbrella detected a DNS request to a domain categorized as Hacking."
"Cisco Systems","Umbrella","LEGACY-S00196","match","Execution","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.004","Cisco Umbrella - DNS Request Category: Malware","Cisco Umbrella detected a DNS request to a domain categorized as Malware."
"Cisco Systems","Umbrella","LEGACY-S00197","match","Unknown/Other","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.004","Cisco Umbrella - DNS Request Category: Newly Seen Domains","Cisco Umbrella detected a DNS request to a domain categorized as Newly Seen Domains. It can be unusual for a host to communicate with a new domain under normal operations, but malware authors register domains specifically for malicious intent will have hosts connect to them shortly after registering them. "
"Cisco Systems","Umbrella","LEGACY-S00198","match","Exfiltration","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1090, _mitreAttackTechnique:T1090.001, _mitreAttackTechnique:T1090.002","Cisco Umbrella - DNS Request Category: P2P/File sharing","Cisco Umbrella detected a DNS request to a domain categorized as P2P/File sharing."
"Cisco Systems","Umbrella","LEGACY-S00199","match","Exfiltration","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTechnique:T1133","Cisco Umbrella - DNS Request Category: Personal VPN","Cisco Umbrella detected a DNS request to a domain categorized as Personal VPN."
"Cisco Systems","Umbrella","LEGACY-S00200","match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1566.003, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.001, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Cisco Umbrella - DNS Request Category: Phishing","Cisco Umbrella detected a DNS request to a domain categorized as Adware."
"Cisco Systems","Umbrella","LEGACY-S00201","match","Unknown/Other","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.004","Cisco Umbrella - DNS Request Category: Potentially Harmful","Cisco Umbrella detected a DNS request to a domain categorized as Potentially Harmful."
"Cisco Systems","Umbrella","LEGACY-S00202","match","Exfiltration","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1090, _mitreAttackTechnique:T1090.001, _mitreAttackTechnique:T1090.002, _mitreAttackTechnique:T1090.003","Cisco Umbrella - DNS Request Category: Proxy/Anonymizer","Cisco Umbrella detected a DNS request to a domain categorized as Proxy/Anonymizer."
"Cisco Systems","Umbrella","LEGACY-S00203","match","Persistence","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.004","Cisco Umbrella - Proxy Logs with Cisco AMP Detections","Cisco Umbrella proxy logs with a Cisco AMP disposition of malicious was detected."
"","","MATCH-S00269","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1115","Clipboard Copied","Adversaries may collect data stored in the clipboard from users copying information within or between applications."
"Microsoft","Windows","MATCH-S00820","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552.001, _mitreAttackTechnique:T1528","Cloud Credential File Accessed","When connecting to various cloud services using Azure PowerShell, Az PowerShell, AWS CLI, Google Cloud CLI or Kubeconfig, credential material may be left on the file system. Threat actors may read or exfiltrate this credential material in order to gain unauthroized access to various cloud resources from on premises hosts."
"","","MATCH-S00412","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1105","Command Line Execution with Suspicious URL and AppData Strings","Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers."
"","","LEGACY-S00013","match","Exfiltration","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1568, _mitreAttackTechnique:T1568.002","Connection to High Entropy Domain","An HTTP connection was made to a high entropy domain name. Entropy is a measure of randomness, DGA domains used by malware (i.e. g46mbrrzpfszonuk) often have high entropy."
"","Docker","MATCH-S00658","templated_match","Execution","True","False","","_mitreAttackTechnique:T1609, _mitreAttackTactic:TA0002","Container Management Utility in Container","Container Management Utility in Container"
"","Docker","MATCH-S00657","templated_match","Privilege Escalation","True","False","","_mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1078, _mitreAttackTactic:TA0004","Container Running as Root","Monitors for usage of the root account within a container. This presents unnecessary risk and could also indicate a compromise where the attacker has successfully escalated privileges."
"","","MATCH-S00410","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1105","Copy from Admin Share","Detects a suspicious copy command from a remote C$ or ADMIN$ share."
"","","MATCH-S00758","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1112","CrashControl Registry Modification","Detects changes to the CrashControl registry key, this can be used to disable crash dumps as an anti-forensic technique."
"","","MATCH-S00443","templated_match","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.002","Create Windows Share","Observes for net.exe being used to create a network share."
"Microsoft","Windows","MATCH-S00591","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001, _mitreAttackTechnique:T1003.005, _mitreAttackTechnique:T1570","Cred Dump-Tools Named Pipes","Detects well-known credential dumping tools execution via specific named pipes"
"","","MATCH-S00525","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.003, _mitreAttackTechnique:T1003.002, _mitreAttackTechnique:T1003.005","Credential Dumping Via Copy Command From Shadow Copy","This rule detects credential dumping using copy command from a shadow copy."
"","","MATCH-S00526","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003","Credential Dumping Via Symlink To Shadow Copy","This rule detects the creation of a symlink to a shadow copy."
"Microsoft","Windows","MATCH-S00586","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001","Credential Dumping by LaZagne","Detects LSASS process access by LaZagne for credential dumping"
"","","MATCH-S00513","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1046","Critical Severity Intrusion Signature","This rule looks for an intrusion product detecting a critical severity intrusion signature sourcing from an internal IP."
"","","LEGACY-S00189","match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1496, _mitreAttackTechnique:T1071.001, _mitreAttackTechnique:T1071","Crypto Miner HTTP User Agent","This signal looks for HTTP requests where the user agent matches common names associated with crypto miners. It is common for attackers to install crypto miners on compromised hosts to use your CPU resources for their profit."
"","","MATCH-S00592","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071.001, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1496","Crypto Miner User Agent","Observes for several known cryptominer user agents"
"","","MATCH-S00348","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1105","Curl Start Combination","Adversaries can use curl to download payloads remotely and execute them. Curl is included by default in Windows 10 build 17063 and later."
"Cylance","Protect","LEGACY-S00014","match","Persistence","True","False","","_mitreAttackTactic:TA0003","Cylance Protect - Event Severity 1","Cylance Protect event with the severity between -0.199 and -0.001"
"Cylance","Protect","LEGACY-S00015","match","Persistence","True","False","","_mitreAttackTactic:TA0003","Cylance Protect - Event Severity 2","Cylance Protect event with the severity between -0.299 and -0.200"
"Cylance","Protect","LEGACY-S00016","match","Persistence","True","False","","_mitreAttackTactic:TA0003","Cylance Protect - Event Severity 3","Cylance Protect event with the severity between -0.399 and -0.300"
"Cylance","Protect","LEGACY-S00017","match","Persistence","True","False","","_mitreAttackTactic:TA0003","Cylance Protect - Event Severity 4","Cylance Protect event with the severity between -0.499 and -0.400"
"Cylance","Protect","LEGACY-S00018","match","Persistence","True","False","","_mitreAttackTactic:TA0003","Cylance Protect - Event Severity 5","Cylance Protect event with the severity between -0.599 and -0.500"
"Cylance","Protect","LEGACY-S00019","match","Persistence","True","False","","_mitreAttackTactic:TA0003","Cylance Protect - Event Severity 6","Cylance Protect event with the severity between -0.699 and -0.600"
"Cylance","Protect","LEGACY-S00020","match","Persistence","True","False","","_mitreAttackTactic:TA0003","Cylance Protect - Event Severity 7","Cylance Protect event with the severity between -0.799 and -0.700"
"Cylance","Protect","LEGACY-S00021","match","Persistence","True","False","","_mitreAttackTactic:TA0003","Cylance Protect - Event Severity 8","Cylance Protect event with the severity between -0.899 and -0.800"
"Cylance","Protect","LEGACY-S00022","match","Persistence","True","False","","_mitreAttackTactic:TA0003","Cylance Protect - Event Severity 9","Cylance Protect event with the severity between -1.000 and -0.900"
"","","LEGACY-S00023","match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1087, _mitreAttackTechnique:T1087.001, _mitreAttackTechnique:T1087.002, _mitreAttackTechnique:T1021.006, _mitreAttackTechnique:T1021.002","DCERPC - SAMR Enumeration of All Users","Microsoft provides a protocol called SAMR which stands for Security Account Manager Remote Protocol. It is designed for developers to perform (RPC) remote procedure calls for interacting the account database for both local and remote Activity Directory domains. It contains a method called SamrEnumerateUsersInDomain which return a list of users in a domain. Attackers who have network access to the domain can use this method to enumerate a list of user accounts in Active Directory. This signal looks for an RPC connection using the SAMR protocol with the method SamrEnumerateUsersInDomain signifying a request to enumerate user accounts over the network."
"","","LEGACY-S00024","match","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.006, _mitreAttackTechnique:T1021.002","DCE-RPC Service Control Call","The Remote Procedure Call (RPC) protocol allows remote administrative commands to be executed.  Creating/Deleting Services , when combined with other signals can be part of an attempt to expand influence inside a network using SMB and related protocols. "
"","","MATCH-S00211","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1036, _mitreAttackTechnique:T1036.004, _mitreAttackTechnique:T1036.005","DNS.EXE Observed as Parent Process","With very few exceptions, the DNS.EXE program should not spawn other processes.  This could be an indication that the process is a trojan, or has been compromised.  This behavior against DNS has been shown as a behavioral indicator after successful attacks (i.e. SigRED)."
"","","THRESHOLD-S00044","threshold","Command and Control","False","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1568, _mitreAttackTechnique:T1568.002","DNS DGA Lookup Behavior - NXDOMAIN Responses","Adversaries may make use of Domain Generation Algorithms (DGAs) to dynamically identify a destination for command and control traffic rather than relying on a list of static IP addresses or domains. This has the advantage of making it much harder for defenders to block, track, or take over the command and control channel, as there could potentially be thousands of domains that malware can check for instructions. This technique is described in https://attack.mitre.org/techniques/T1483/."
"","","LEGACY-S00026","match","Exfiltration","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1568, _mitreAttackTechnique:T1568.002","DNS Lookup of High Entropy Domain","DNS lookup of a high entropy domain name, which may be indicative of a domain generation algorithm (DGA) related domain.  This technique is described at https://attack.mitre.org/techniques/T1483/."
"","","LEGACY-S00027","match","Exfiltration","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1132, _mitreAttackTechnique:T1132.001","Hexadecimal in DNS Query Domain","Encoding in hexadecimal is a way that attackers can bypass network security devices that are inspecting traffic.  While hexadecimal often appears in subdomains, it much less frequent in domains."
"","","MATCH-S00375","templated_match","Execution","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0002, _mitreAttackTechnique:T1190, _mitreAttackTechnique:T1569, _mitreAttackTechnique:T1569.002","DNS RCE Exploit CVE-2020-1350","Detects exploitation of DNS RCE bug reported in CVE-2020-1350 by the detection of suspicious sub process"
"","","THRESHOLD-S00040","threshold","Defense Evasion","False","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1573, _mitreAttackTechnique:T1573.001, _mitreAttackTechnique:T1573.002","Possible DNS over TLS (DoT) Activity","This rule detects attempted or successful connections to the standard service port for DoT services. DNS over TLS (RFC 7858, DoT) is a name resolution service that allows clients to resolve DNS records over encrypted and validated connections. DoT operates over standards compliant TLS and is specified to operate over port 853/tcp. In some environments this may be abused as a method to bypass security and policy controls. Some malicious actors leverage DoT to tunnel DNS traffic over TLS, and research has demonstrated the ability to carry out other DNS related abuse such as malware C2 over DoT as well."
"Microsoft","Windows","MATCH-S00695","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1555, _mitreAttackTechnique:T1555.003","DPAPI Key Manipulation - Backup of Backup Key","The DPAPI (Data Protection Application Programming Interface) Key is used to encrypt user details. Actors may attempt to attack the DPAPI on the Domain Controllers to gain further access."
"Microsoft","Windows","MATCH-S00696","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1555, _mitreAttackTechnique:T1555.003","DPAPI Key Manipulation - Extracting Backup Key","The DPAPI (Data Protection Application Programming Interface) Key is used to encrypt user details. Actors may attempt to attack the DPAPI on the Domain Controllers to gain further access."
"","","MATCH-S00385","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003","DTRACK Process Creation","Detects specific process parameters as seen in DTRACK infections"
"","","MATCH-S00441","templated_match","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1070, _mitreAttackTechnique:T1070.005, _mitreAttackTechnique:T1021.002","Delete Windows Share","Observes for net.exe being used to delete a network share."
"Microsoft","Windows","MATCH-S00542","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1110, _mitreAttackTechnique:T1110.001, _mitreAttackTechnique:T1110.002, _mitreAttackTechnique:T1110.003, _mitreAttackTechnique:T1110.004","Unauthorized Access Attempt Detected","Most login failures are due to failed passwords. Login failure to sensitive systems where the users simply aren't authorized, though, can indicate malicious intent."
"","","MATCH-S00543","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1569, _mitreAttackTechnique:T1569.002","Detect Psexec With Accepteula Flag","This rule looks for events where PsExec.exe is run with the accepteula flag in the command line. PsExec is a built-in Windows utility that enables you to execute processes on other systems. It is fully interactive for console applications. This tool is widely used for launching interactive command prompts on remote systems. Threat actors leverage this extensively for executing code on compromised systems. If an attacker is running PsExec for the first time, they will be prompted to accept the end-user license agreement (EULA), which can be passed as the argument accepteula within the command line."
"","","MATCH-S00565","templated_match","Unknown/Other","False","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.004","Direct Outbound DNS Traffic","This rule detects DNS traffic sent directly to an external server from an internal host, bypassing the existing DNS structure. This could indicate an attacker attempting to conduct command and control without being subjected to DNS monitoring."
"","","LEGACY-S00028","match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0007, _mitreAttackTactic:TA0009, _mitreAttackTechnique:T1083, _mitreAttackTechnique:T1213, _mitreAttackTechnique:T1213.001","Directory Traversal - Successful","Directory traversal is an attempt by an attacker to access files located on the host which are not intended to be returned by the web server. For example, attackers seeking usernames/passwords for the host will focus on paths like ../../etc/passwd, ../../../etc/shadow, etc. When successful, a directory traversal attack results in the attacker gaining access to sensitive information and identifying a mechanism of future attack. When unsuccessful, directory traversal is an indication of ongoing external reconnaissance."
"","","THRESHOLD-S00009","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1083, _mitreAttackTactic:TA0009, _mitreAttackTechnique:T1213, _mitreAttackTechnique:T1213.001","Directory Traversal - Unsuccessful","Directory traversal is an attempt by an attacker to access files located on the host which are not intended to be returned by the web server. For example, attackers seeking usernames/passwords for the host will focus on paths like ../../etc/passwd, ../../../etc/shadow, etc. When successful, a directory traversal attack results in the attacker gaining access to sensitive information and identifying a mechanism of future attack. When unsuccessful, directory traversal is an indication of ongoing external reconnaissance."
"Microsoft","","LEGACY-S00029","match","Credential Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1110, _mitreAttackTechnique:T1110.001, _mitreAttackTechnique:T1110.002, _mitreAttackTechnique:T1110.003, _mitreAttackTechnique:T1110.004","Disabled Account Logon Attempt","Detects a disabled account being used for a logon attempt in a Windows environment."
"Microsoft","Windows","MATCH-S00544","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1548, _mitreAttackTechnique:T1548.002","Disabling Remote User Account Control","The rule looks for modifications to registry keys that control the enforcement of Windows User Account Control (UAC)."
"","","MATCH-S00568","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTechnique:T1048, _mitreAttackTechnique:T1048.003","Dnscat Execution","Observes for keywords associated with execution of DNScat malware via powershell"
"","","AGGREGATION-S00006","aggregation","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1613","Docker Enumeration Detected on Host","Threat actors will aim to enumerate various permissions and settings on hosts with Docker installed, this enumeration can potentially lead to explotiation avenues."
"","","THRESHOLD-S00103","threshold","Initial Access","True","False","Authentication","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1110, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1586, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1110.002, _mitreAttackTechnique:T1110.001","Domain Brute Force Attempt","Detects multiple failed login attempts for the same username over a 1 hour timeframe. This is designed to catch attacks leveraging domain resources to attempt credential validation. The threshold and time frame can be adjusted based on the customer's environment."
"","","THRESHOLD-S00102","threshold","Initial Access","True","False","Authentication","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1110, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1586, _mitreAttackTechnique:T1586.001, _mitreAttackTechnique:T1586.002, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1110.003, _mitreAttackTechnique:T1110.002, _mitreAttackTechnique:T1110.001","Domain Password Attack","Detects multiple failed login attempts from a single source with unique usernames over a 1 hour timeframe. This is designed to catch attacks leveraging domain resources to attempt credential validation. The threshold and time frame can be adjusted based on the customer's environment."
"","","LEGACY-S00030","match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1568, _mitreAttackTechnique:T1568.001, _mitreAttackTechnique:T1568.002, _mitreAttackTechnique:T1568.003","Domain Resolution in Non-Standard TLD","DNS resolution of a domain that is not under an ICANN-standard TLD. These TLDs are provided by alternate DNS root servers such as OpenNIC. Their use on corporate networks is fundamentally suspicious and potentially a sign of abuse by threat actors."
"","","LEGACY-S00031","match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1210","Doublepulsar scan - likely not infected","Doublepulsar scans to check if the host is already infected before attempting to install the backdoor. "
"","","MATCH-S00319","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0007, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1083, _mitreAttackTechnique:T1222, _mitreAttackTechnique:T1222.001, _mitreAttackTechnique:T1486, _mitreAttackTechnique:T1490","Dridex Process Pattern","Detects typical Dridex process patterns"
"","","MATCH-S00590","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003","Elise Backdoor","Observes for indicators associated with Elise backdoor activity as used by APT32"
"","","MATCH-S00527","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1036, _mitreAttackTechnique:T1036.005, _mitreAttackTechnique:T1036.004","Email Files Written Outside Of The Outlook Directory","The rule detects email files created outside the normal Outlook directory."
"","","MATCH-S00572","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.001, _mitreAttackTechnique:T1059.003, _mitreAttackTechnique:T1027, _mitreAttackTechnique:T1027.002","Emotet Process Creation","Observes for command lines associated with Emotet malware."
"","","MATCH-S00587","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.001, _mitreAttackTechnique:T1059.003","Empire PowerShell Launch Parameters","Observes for several command line parameters associated with Empire PowerShell"
"","","MATCH-S00576","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.011","Equation Group DLL_U Load","Observes for a tool and export tied to the Equation Group"
"Microsoft","Windows","MATCH-S00479","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001","Excavator Utility","From FireEye Red Team Tool Countermeasures: Excavator is a tool for dumping the process via a service. It can also dump the process directly if not used as a service."
"","","THRESHOLD-S00074","threshold","Discovery","False","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1046","Excessive Firewall Denies","This rule is designed to detect excessive firewall blocks within a shortened time frame. Customers will need to adjust the threshold of this rule to align with their environment's normal vs abnormal firewall traffic patterns."
"","","THRESHOLD-S00085","threshold","Unknown/Other","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1046","Excessive Outbound Firewall Blocks","Observes for a firewall blocking a large amount traffic from a single host in a short period of time. This may be indicative of C2 traffic"
"Linux","Windows","MATCH-S00682","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1027, _mitreAttackTechnique:T1027.002, _mitreAttackTechnique:T1027.004","Excessive Use of Escape Characters in Command Line","Fluffing a malicious command line input with escape characters is sometimes done in an attempt to avoid endpoint monitoring techniques that rely on exact string or regex matches."
"","","LEGACY-S00033","match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1036, _mitreAttackTechnique:T1036.004, _mitreAttackTechnique:T1036.005, _mitreAttackTactic:TA0001, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1566.003, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.001, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Executable Downloaded - Content-Type Mismatch","This rule identifies scenarios where an attacker may have attempted to surreptitiously download an executable file by hiding it behind a different Content-Type, such as image/png. This technique has been observed in samples of Trickbot malware."
"","","MATCH-S00360","templated_match","Exfiltration","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTechnique:T1041","Exfiltration and Tunneling Tools Execution","Execution of well known tools for data exfiltration and tunneling."
"Amazon AWS","CloudTrail","MATCH-S00827","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1530","Exposed AWS SNS Topic Created","An AWS Simple Notification Service (SNS ) topic was created allowing all users access to perform actions against the created topic"
"Amazon AWS","CloudTrail","MATCH-S00823","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1530","Exposed AWS SQS Queue Created","An AWS Simple Queue Service (SQS) can be created with a custom access policy, this signal triggers when a policy is applied to an SQS queue which allows global access from the internet with an IP range of 0.0.0.0/32 (all)"
"Microsoft","Windows","MATCH-S00304","templated_match","Exfiltration","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTactic:TA0010, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1025, _mitreAttackTechnique:T1052, _mitreAttackTechnique:T1052.001, _mitreAttackTechnique:T1092","External Device Installation Denied","Detects a denied attempt to attached a removable media device. External media can be used to exfiltrate sensitive data and is also a common source of infections. Attempts to use these devices could indicate the intent for malicious activity."
"","","MATCH-S00392","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1222, _mitreAttackTechnique:T1222.001","File or Folder Permissions Modifications","Detects a file or folder permissions modifications."
"","","MATCH-S00394","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1202","Findstr Launching .lnk File","Detects usage of findstr to identify and execute a lnk file as seen within the HHS redirect attack."
"","","MATCH-S00454","templated_match","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1210","Firewall Allowed SMB Traffic","Observes for SMB traffic allowed through the firewall."
"","","FIRST-S00042","first_seen","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1120","First Seen Ioreg Usage from User","A user has executed a ioreg command not seen since the baseline period. The ioreg binary can be used to enumerate configurations on a Unix/macOS host and can be used by malware to ensure that code is not running on a virtual machine or sandbox. This rule utilizes data from the ""LOOBins"" project: https://github.com/infosecB/LOOBins - more information regarding this specific binary can be found via: https://www.loobins.io/binaries/ioreg/"
"","","FIRST-S00047","first_seen","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1078.004","First Seen ASN Associated with User for a Successful Azure AD Sign In Event","This rule will trigger when a new ASN value is associated with a successful Entra ID sign in event for a particular username since the baseline period. This may be suspicious activity as a users IP address may change periodically, but typically users authenticate from a set of ASNs (one ASN value for their home network, another ASN value for their mobile device ) â€“ a sign in with a new ASN not seen since the baseline period could be indicative of credential theft. Look at other events occurring for the user in question for the same time period to ascertain whether access was malicious or benign."
"Amazon AWS","CloudTrail","FIRST-S00002","first_seen","Execution","False","True","","_mitreAttackTactic:TA0002","First Seen AWS API Call from User","Observes for a user performing a specific API call for the first time. This may be suspicious if a user begins interacting with systems they do not typically."
"Amazon AWS","CloudTrail","FIRST-S00023","first_seen","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1530","First Seen AWS API Gateway Enumeration by User","Threat actors may collect information from AWS API Gateway, including enumeration of access they have to such resources."
"Amazon AWS","CloudTrail","FIRST-S00084","first_seen","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1580","First Seen AWS Bedrock API Call from User","This rule looks for a first seen AWS Bedrock API call from a user since the baseline period. Ensure the user in question is authorized to utilize AWS Bedrock services. Take a look at the ""action"" field to determine what API calls are being made and whether this activity is expected."
"Amazon AWS","","FIRST-S00071","first_seen","Discovery","True","False","Authentication","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1538","First Seen AWS ConsoleLogin by User","First observance of a user logging on to the Amazon AWS console. This could be indicative of new administrator onboarding, or an unauthorized access to the AWS console. Recommended to investigate the nature of the user account and the login."
"Amazon AWS","CloudTrail","FIRST-S00036","first_seen","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1613","First Seen AWS EKS API Call via CloudTrail from User","This rule looks for a first seen AWS EKS API call from a user since the baseline period."
"","","FIRST-S00037","first_seen","Defense Evasion","True","False","","_mitreAttackTechnique:T1550, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008","First Seen AWS EKS Admission Controller Created by IP Address","First Seen Admission Controllers (Submit a new MutatingWebhookConfiguration or ValidatingWebhookConfiguration object via the Kubernetes API, or update an existing one.)"
"","","FIRST-S00035","first_seen","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1613","First Seen AWS EKS Secrets Enumeration from IP Address","Adversaries may enumerate various Kubernetes secrets in order to escalate privileges or to look for persistence avenues."
"Amazon AWS","CloudTrail","FIRST-S00024","first_seen","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1651","First Seen AWS SSM RunShellScript SendCommand From User","AWS SSM (Simple Systems Manager) can be used to manage systems and configurations, however, it can also be abused by threat actors to run various shell scripts on EC2 instances."
"Amazon AWS","CloudTrail","FIRST-S00003","first_seen","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552.005","First Seen AWS Secrets Manager API Call from User","Observes for a user performing a ListSecrets API call for the first time."
"","Bro","LEGACY-S00036","match","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.002","First Seen Access - SMB Share","Adversaries may access a networked system remotely using Server Message Block (SMB) to transfer files, and run transferred binaries through remote execution. Although not malicious on its own, this first-seen access to a DISK share over SMB can be an indicator of lateral movement."
"Microsoft","Windows","FIRST-S00001","first_seen","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004","First Seen Administrative Privileges Granted for User","Observes for granting of administrative privileges in Windows for the first time for a given user"
"Microsoft","Windows","FIRST-S00026","first_seen","Lateral Movement","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.005","First Seen Anonymous Logon Change Activity to Domain Controller","Attackers can attempt to hijack enterprise servers exploiting Netlogon cryptographic weaknesses. The vulnerability allows an attacker to set a password for the computer account of an Active Directory Domain Controller, which can then be abused to pull credentials from the Domain Controller. This rule detects fist seen anonymous user attempt a change on a domain controller computer account."
"","","FIRST-S00044","first_seen","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1114","First Seen AppID Generating MailItemsAccessed Event from User","This alert looks at a first seen application ID accessing an Office 365/Exchange mail box item The MailItemsAccessed may not always be enabled within an Entra/Azure/Office 365 tenant and is dependent on Microsoft licensing requirements. See the following guide from CISA for additional information on this event type and investigation steps: https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-193a"
"Microsoft","","FIRST-S00048","first_seen","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0007, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1098","First Seen Azure Device Code Authentication from User","Azure Device Code authentication can be utilized in phishing attacks. This specific rule looks for a user performing device code authentication to an Azure resource for the first time since the baseline period. If this action is not expected, it could be a sign of malicious activity. Examine the event for odd user agent values and look at what other actions the affected account is performing within the Azure estate."
"Microsoft","Azure","FIRST-S00019","first_seen","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1098, _mitreAttackTechnique:T1098.003","First Seen Azure Member Addition to Group from User","Detects a user being added to a group for the first time by a user. This may be a routine activity, but could be indicative of an attempt to escalate account privileges. It is recommended to add additional expression logic to this rule to either exclude non-sensitive groups, or to only include sensitive groups."
"Microsoft","","FIRST-S00020","first_seen","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1550.001","First Seen Azure OAUTH Application Consent from User","A user has consented to application permissions for the first time since the baseline period occurred."
"Microsoft","Azure","FIRST-S00080","first_seen","Discovery","True","False","Authentication","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1538","First Seen Azure Portal access by User","First observance of a user logging on to the Microsoft Azure Portal. This could be indicative of new user onboarding, or an unauthorized access to the Azure portal. Recommended to investigate the nature of the user account and the login."
"Microsoft","","FIRST-S00021","first_seen","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1651","First Seen Azure Virtual Machine Run Command Issued by User","A user has issued an Azure Virtual Machine run command for the first time in the baseline period."
"","","FIRST-S00064","first_seen","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1649","First Seen Certificate Thumbprint in Successful Kerberos Authentication","This alert looks for a first seen certtificate thumbprint being used to authenticate to an Active Directory environment, resulting in a Kerberos ticket being successfully issued. This alert is designed to catch Active Directory Certificate Services related attacks, ensure the certificate thumprint is valid, correlate the thumbprint ID with other Certificate Services events, particularly looking for recently issued templates."
"","","FIRST-S00046","first_seen","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1114","First Seen Client Generating MailItemsAccessed Event from User","This alert looks at a First Seen client accessing an Office 365/Exchange mail box item. The MailItemsAccessed may not always be enabled within an Entra/Azure/Office 365 tenant and is dependent on Microsoft licensing requirements. See the following guide from CISA for additional information on this event type and investigation steps: https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-193a"
"","","FIRST-S00028","first_seen","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1018","First Seen Common Windows Recon Commands From User","Detects a set of commands often used in recon stages by different attack groups."
"Microsoft","Windows","FIRST-S00013","first_seen","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1014","First Seen Driver Load - Global","{{device_hostname}} loaded new driver {{file_path}}."
"Microsoft","Windows","FIRST-S00014","first_seen","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1014","First Seen Driver Load - Host","{{device_hostname}} loaded new driver {{file_path}}."
"","","FIRST-S00007","first_seen","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTactic:TA0007, _mitreAttackTechnique:T1530, _mitreAttackTechnique:T1526","First Seen DynamoDB Enumeration from User","A user was observed as performing enumeration of DynamoDB tables for the first time in the baseline period."
"","","FIRST-S00073","first_seen","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1201","First Seen Get-ADDefaultDomainPasswordPolicy","The first observed execution of the PowerShell CMDLet Get-ADDefaultDomainPasswordPolicy on this host, this CMDLet can be used in the discovery of Windows Domain Password Policies by threat actors. Investigating the host and active users for additional activity around the time of execution is recommended."
"","","FIRST-S00072","first_seen","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1201","First Seen Group Policy Discovery Operation","`This detection is a first observed execution of Windows process or PowerShell commands that can be run by users or administrators in order to gather password policy and other types of system information in an enterprise environment. The detections in this signal are based off variations found in Atomic Red Team test cases. Reference:  https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1615/T1615.md. Look at the command line and parent process details of the signal in order to determine if this execution is legitimate or part of system provisioning or systems administration operations."
"","","FIRST-S00062","first_seen","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1649, _mitreAttackTechnique:T1087.002","First Seen IP Address Connecting to Active Directory Certificate Services Process","This alert looks at Windows Filtering Platform Events and flags when a first seen IP address connects to the certificate services process. This can be indictive of enumeration of certificate templates which can potentially lead to forged certificates and privilege escalation avenues. Pivot off the source IP and ensure that this device is authorized to be on the network. In addition, look for other CSE signals related to Active Directory Certificate Services to look for any potentially vulnerable certificate templates being exploited."
"","","FIRST-S00086","first_seen","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552","First Seen IP Address Performing Trufflehog AWS Credential Verification","Trufflehog is a tool that can be utilized to find and verify secrets. When Trufflehog locates AWS credentials, it attempts to validate them using the GetCallerIdentity API call. This signal looks for the default Trufflehog User Agent within CloudTrail telemetry, combined with the GetCallerIdentity API call occurring from an IP address not seen since the baseline period. This signal is designed to pair with â€œTrufflehog AWS Credential Verification Detectedâ€ to provide coverage for legitimate and internal Trufflehog scans. Within this telemetry, the user_username field will contain the value of the username associated with the secret or credential that Trufflehog is attempting to verify. Look at the events surrounding the source IP address of this event. Look for any potential areas that may have contained keys or secrets for the user_username value."
"","","FIRST-S00027","first_seen","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.004","First Seen InstallUtil Allow List Bypass From User","This rule looks for a suspicious InstallUtil outgoing network connection from the InstallUtil process, indicating potentially malicious use of the InstallUtil binary."
"Microsoft","Windows","FIRST-S00017","first_seen","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1558, _mitreAttackTechnique:T1558.003","First Seen Kerberoasting Attempt from User - Global","First Seen Kerberoasting Attempt from User - Global"
"Microsoft","Windows","FIRST-S00018","first_seen","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1558, _mitreAttackTechnique:T1558.003","First Seen Kerberoasting Attempt from User - Host","First Seen Kerberos RC4 Request - If RC4 isn't used in the environment this indicates a possible Kerberoasting attempt."
"","","FIRST-S00032","first_seen","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1609","First Seen Kubectl Command From User","Kubectl can be used to administer Kubernetes clusters, this alert looks for a first seen Kubectl command line from a user since the baseline period."
"Microsoft","Windows","FIRST-S00004","first_seen","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0003, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.003","First Seen Local Group Addition by User","Observes for a user being added to a security-enabled local group in Windows"
"","","FIRST-S00015","first_seen","Execution","True","False","","_mitreAttackTactic:TA0002","First Seen Macro Execution from User","First Seen Macro Execution from User"
"","","FIRST-S00081","first_seen","Persistence","True","False","","_mitreAttackTechnique:T1583, _mitreAttackTactic:TA0040","First Seen Model ID in AWS Bedrock Put Entitlement by User","A first seen model id was observed in AWS Bedrock. The PutFoundationModelEntitlement API call grants permission to put entitlement to access a foundational model. Ensure this model is authorized to be utilized in the environment and that the user requesting access to the model is authorized to perform these actions."
"","","FIRST-S00088","first_seen","Credential Access","False","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1558, _mitreAttackTechnique:T1649","First Seen NTLM Authentication to Host (User)","A user has performed NTLM authentication to a host on the network for the first time since the baseline period has been established. Rule is disabled by default and requires tuning. Tuning guidance: depending on configurations in the environment, NTLM authentication may be necessary and expected. Examine the username, source IP and destination host in order to ensure that this activity is expected. Look at other signals around the entity in question to determine if any other type of suspicious activity may have occurred. It may also be prudent to isolate the rule to sensitive users and groups"
"","","FIRST-S00076","first_seen","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1201, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1087, _mitreAttackTechnique:T1482, _mitreAttackTechnique:T1087.001, _mitreAttackTechnique:T1087.002","First Seen Net Command Use on Host","Microsoftâ€™s Net.exe can be used for multiple Discovery tactics, including Password Policy, Permissions, Account and Domain Trust Discovery. This detection identifies the first observance of a Net related command on a system related to these discovery tactics. It is recommended to investigate the host and user to determine if this is authorized admin activity or needs further inspection."
"Microsoft","Windows","FIRST-S00016","first_seen","Credential Access","True","False","","_mitreAttackTactic:TA0006","First Seen Non-Network/Non-System Logon from User","First Seen Non-Network Logon from User"
"Microsoft","Windows","FIRST-S00010","first_seen","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.001","First Seen PowerShell Execution from Computer","Observes for an Endpoint utilizing PowerShell for the first time."
"Microsoft","Windows","FIRST-S00009","first_seen","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.001","First Seen RDP Logon From User","Observes for a user performing a RDP logon for the first time."
"","CloudTrail","FIRST-S00085","first_seen","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","First Seen Role Creating AWS Bedrock Agent","An AWS Bedrock Agent has been created in the environment by a Role seen for the first time since the baseline period. If this role is not expected in the environment and was not originally assigned IAM rights to Bedrock, this activity could be indicative of privilege escalation. Bedrock Agents can be configured with various parameters to build AI applications. Take a look at the ""responseElements.agent.agentName"" field to see the name of the agent being created. Ensure that the user creating the agent is authorized to develop AI applications within the environment."
"Amazon AWS","CloudTrail","FIRST-S00022","first_seen","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1530","First Seen S3 Bucket ACL Enumeration by User","Threat actors may collect information from AWS S3 buckets, including enumeration of access they have to such resources."
"","","FIRST-S00025","first_seen","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1210","First Seen SMB Allowed Traffic From IP","Observes for SMB traffic allowed through the firewall."
"Amazon AWS","CloudTrail","FIRST-S00034","first_seen","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1550.001","First Seen Session Token Granted to User from New IP","Session tokens return a temporary set of credentials that cosnist of an access key ID, a secret and a session token. This alert triggers when a session token is issued for the first time since the baseline period."
"","","FIRST-S00065","first_seen","Initial Access","True","False","Authentication","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1586, _mitreAttackTechnique:T1586.001, _mitreAttackTechnique:T1586.002","First Seen Successful Authentication From Unexpected Country","First Seen rule which triggers when there are at least two successful logins from the same user with different country codes indicating possible credential theft. It is recommended to add filtering criteria to the expression to reduce false positives, such as known VPN addresses.(If degradation issues occur it is recommendation implementing tuning around your expected network)"
"","","FIRST-S00033","first_seen","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1610","First Seen Terminal-Attached Pod Deployed to EKS","A pod was deployed with an attached terminal (stdin=true,stdout=true,tty=true) for the first time since the baseline period."
"","","FIRST-S00061","first_seen","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTactic:TA0001, _mitreAttackTechnique:T1091","First Seen USB device in use on Windows host","This signal looks for a new removable USB device name being used by a host not seen since the baseline period. This activity by itself is not necessarily malicious, but can be indicative of potential lateral movement or initial access tactics. If the device name is unexpected and not authorized to be used in the environment, investigate the alert further and look for file creation events to the drive in question. The fields[""EventData.DeviceDescription""] field contains the device name."
"","","FIRST-S00087","first_seen","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1578.002, _mitreAttackTechnique:T1578","First Seen User Creating or Modifying EC2 Launch Template","AWS EC2 launch templates allows cloud administrators to specify instance configuration information in a templated format. Granting permissions to modify or create launch templates within EC2 in certain circumstances grants the user PassRole permissions, potentially opening privilege escalation avenues via IAM. The following AWS documentation outlines this behavior: https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/permissions-for-launch-templates.html. Look at other events the user in question is performing in order to investigate this signal. Consider excluding authorized users via a match list if this signal is triggering too many false positives."
"Microsoft","Windows","FIRST-S00005","first_seen","Persistence","True","True","","_mitreAttackTactic:TA0003","First Seen User Creation From User","Observes for a user being created for the first time by a user previously unassociated with account creation"
"","","FIRST-S00082","first_seen","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","First Seen User Enumerating AWS Bedrock Models","A first seen user was observed enumerating AWS Bedrock models via the ListFoundationModels API call. Ensure that the user performing the enumeration is authorized to work within AWS Bedrock. The http_userAgent field will contain the user agent used to perform this enumeration and will help determine whether a browser or CLI tool was used to perform this type of enumeration. Consider excluding service accounts and authorized users from this rule via a rule tuning expression if excessive signal activity is observed."
"","","FIRST-S00100","first_seen","Discovery","False","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","First Seen User Enumerating Custom AWS Bedrock Models","[Disabled by Default] Detection of a user account's first enumeration of custom AWS Bedrock models via ListCustomModels API. Verify the user is authorized for AWS Bedrock access. The http_userAgent field indicates whether a browser or CLI tool was used. This rule is disabled by default due to potential high volume of alerts, particularly from service accounts. Before enabling, consider excluding authorized users and service accounts (such as CNAPP monitoring accounts with timestamp-based usernames) through rule tuning expressions."
"Microsoft","Windows","FIRST-S00006","first_seen","Credential Access","True","True","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1558, _mitreAttackTechnique:T1558.003","First Seen Weak Kerberos Encryption from User","Observes for first signs of Weak Kerberos Encryption from a User"
"","","FIRST-S00038","first_seen","Exfiltration","True","False","","_mitreAttackTechnique:T1048, _mitreAttackTactic:TA0010","First Seen Wget Usage from User","First Seen execution of Wget by a user from a device. The Wget tool is designed to retrieve files using various internet protocols in a programmatic manner, it is often abused by threat actors to download various files as part of broader executions. If this usage of Wget comes from an unexpected user, it is recommended that the command line value be reviewed and the URL which was used as part of Wget command be investigated."
"","","FIRST-S00040","first_seen","Exfiltration","True","False","","_mitreAttackTechnique:T1048, _mitreAttackTactic:TA0010","First Seen cURL execution from User","First Seen execution of cURL by a user from a device. The cURL tool is designed to retrieve files using various internet protocols in a programmatic manner, it is often abused by threat actors to download various files as part of broader executions. If this usage of cURL comes from an unexpected user, it is recommended that the command line value be reviewed and the URL which was used as part of cURL command be investigated."
"","","FIRST-S00074","first_seen","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1652","First Seen driverquery execution on host","First observed execution of the driverquery command on the following device host: {{device_hostname}}. Driverquery is a useful command for an attacker to enumerate local device drivers to determine next steps in the attack. Vulnerability scanners and automated processes may trigger this detection, it is recommended to identify and filter these processes out using a Tuning Expression for the corresponding baseImage. On detection, investigating the host and process executing the command to assist in understanding the context of the execution."
"Microsoft","Windows","FIRST-S00059","first_seen","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1006","First Seen esentutl command From User","Threat actors may use the esentutl utility to create volume shadow copies and/or backups on a Windows operating system and retrieve the Active Directory database (NTDS.dit) file in order to extract credential material. Esentutl can also be utilized to download files from a remote share or URL. This activity should be treated as high priority if not performed by an authorized systems administrator as part of normal and planned systems maintenance."
"","","FIRST-S00079","first_seen","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1201","First Seen gpresult execution on host","This detection is first observed execution of gpresult on a host, this command may be used by attackers to access detailed password policy information in an enterprise environment. Vulnerability scanners and automated processes may trigger this detection, it is recommended to identify and filter these processes out using a Tuning Expression for the corresponding baseImage. On detection, investigating the host and process executing the command to assist in understanding the context of the execution."
"","","FIRST-S00039","first_seen","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1083","First Seen mdfind Usage from User","A user has executed a mdfind command not seen since the baseline period. The mdfind binary can be used to find passwords and other sensitive info on the host  system. This rule utilizes data from the ""LOOBins"" project: https://github.com/infosecB/LOOBins - more information regarding this specific binary can be found via: https://www.loobins.io/binaries/mdfind/"
"","","FIRST-S00041","first_seen","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1082","First Seen networksetup Usage from User","A user has executed a networksetup command not seen since the baseline period. The networksetup binary can be used to change and discover network settings on a Unix or macOS host. This rule utilizes data from the ""LOOBins"" project: https://github.com/infosecB/LOOBins"
"","","FIRST-S00043","first_seen","Collection","True","False","","_mitreAttackTechnique:T1115, _mitreAttackTactic:TA0009","First Seen pbpaste Usage from User","A user has executed a pbpaste command not seen since the baseline period. The pbpaste binary can be used to read the contents of a clipboard. This rule utilizes data from the ""LOOBins"" project: https://github.com/infosecB/LOOBins. more information regarding this specific binary can be found via:  https://www.loobins.io/binaries/pbpaste/"
"Microsoft","Windows","FIRST-S00058","first_seen","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1006","First Seen vssadmin command From User","Threat actors may use the vssadmin utility to create volume shadow copies on a Windows operating system and retrieve the Active Directory database (NTDS.dit) file in order to extract credential material. This activity should be treated as high priority if not performed by an authorized systems administrator as part of normal and planned systems maintenance. If this activity is performed as part of normal system maintenance, the rule can be tuned to exclude these groups of users."
"Microsoft","Windows","FIRST-S00060","first_seen","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1006","First Seen wbadmin command From User","Threat actors may use the wbadmin utility to create volume shadow copies and/or backups on a Windows operating system and retrieve the Active Directory database (NTDS.dit) file in order to extract credential material. This activity should be treated as high priority if not performed by an authorized systems administrator as part of normal and planned systems maintenance."
"Microsoft","Windows","FIRST-S00008","first_seen","Discovery","True","True","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1033","First Seen whoami command From User","Observes for a user performing a whoami command for the first time."
"","","FIRST-S00030","first_seen","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1550.002, _mitreAttackTechnique:T1187","First Seen Outbound Connection to External IP Address on Port 445 from IP Address","External connections over the internet to port 445 could be indictative of hash leak attempts, including exploitation attempts for vulnerabilities such as CVE-2023-2397. This alert looks at a source IP address making a connection to a new external destination IP address since the baseline period."
"Fortinet","Fortigate","LEGACY-S00037","match","Execution","True","False","","_mitreAttackTactic:TA0002","Fortinet Critical App-Risk","This signal fires when Fortinet identifies a critical risk application in use within the network. "
"Fortinet","Fortigate","LEGACY-S00038","match","Execution","True","False","","_mitreAttackTactic:TA0002","Fortinet High App-Risk","This signal fires when Fortinet detects a high risk application within the environment"
"Google","Google Cloud Platform","MATCH-S00620","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.001","GCP Audit Cloud SQL Database Modified","Detect when a Cloud SQL DB has been modified."
"Google","Google Cloud Platform","MATCH-S00621","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.007","GCP Audit GCE Firewall Rule Modified","Detect when a firewall rule is created, modified or deleted."
"Google","Google Cloud Platform","MATCH-S00622","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.007","GCP Audit GCE Network Route Created or Modified","Detect when a firewall route is created or modified."
"Google","Google Cloud Platform","MATCH-S00623","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.007","GCP Audit GCE VPC Network Modified","Detect when a VPC network is created."
"Google","Google Cloud Platform","MATCH-S00615","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1136, _mitreAttackTechnique:T1136.003","GCP Audit IAM CreateServiceAccount Observed","This signal fires for all observances of the CreateServiceAccount action in the IAM event source. Hostile actors will create service accounts to persist access. Use this signal in context of other activity to determine intent."
"Google","Google Cloud Platform","MATCH-S00624","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1098, _mitreAttackTechnique:T1098.001","GCP Audit IAM Custom Role Created or Modified","Detect when a custom role is created or modified."
"Google","Google Cloud Platform","MATCH-S00631","templated_match","Impact","True","False","","_mitreAttackTechnique:T1531, _mitreAttackTactic:TA0040","GCP Audit IAM Custom Role Deletion","Identifies an Identity and Access Management (IAM) role deletion in Google Cloud Platform (GCP). A role contains a set of permissions that allows you to perform specific actions on Google Cloud resources. An adversary may delete an IAM role to inhibit access to accounts utilized by legitimate users."
"Google","Google Cloud Platform","MATCH-S00630","templated_match","Impact","True","False","","_mitreAttackTechnique:T1531, _mitreAttackTactic:TA0040","GCP Audit IAM DeleteServiceAccount Observed","Identifies when a service account is deleted in Google Cloud Platform (GCP). A service account is a special type of account used by an application or a virtual machine (VM) instance, not a person. Applications use service accounts to make authorized API calls, authorized as either the service account itself, or as Google Workspace or Cloud Identity users through domain-wide delegation. An adversary may delete a service account in order to disrupt their target's business operations."
"Google","Google Cloud Platform","MATCH-S00629","templated_match","Impact","True","False","","_mitreAttackTechnique:T1531, _mitreAttackTactic:TA0040","GCP Audit IAM DisableServiceAccount Observed","Identifies when a service account is disabled in Google Cloud Platform (GCP). A service account is a special type of account used by an application or a virtual machine (VM) instance, not a person. Applications use service accounts to make authorized API calls, authorized as either the service account itself, or as Google Workspace or Cloud Identity users through domain-wide delegation. An adversary may disable a service account in order to disrupt to disrupt their target's business operations."
"Google","Google Cloud Platform","MATCH-S00614","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552.005","GCP Audit KMS Activity","GCP KMS is an encryption and key management web service. Besides encrypting and decrypting data, users and administrators can use this service to create keys, manage keys etc. This signal indicates activity that enables and disables keys explicitly. This activity has been surveyed to be a low volume event and could be considered suspicious given other activity involving the entity. Additionally, monitoring for these events is required to achieve certain industry audit compliance."
"Google","Google Cloud Platform","MATCH-S00613","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1485, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552.005","GCP Audit Key Deleted or Disabled","Deleting cryptographic key material managed by KMS can be risky. The risk is that after key material is deleted, cypher text may remain that is now indecipherable. This signal indicates that a key has been scheduled or canceled for deletion. This signal in context of other signals around this entity may describe a hostile pattern of attack."
"Google","Google Cloud Platform","MATCH-S00611","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0043, _mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","GCP Audit ListQueues","This could indicate that an adversary is attempting to collect information for later attack. When successful, the List Queues event returns all queues that may be valid targets for further probing/attack."
"Google","Google Cloud Platform","MATCH-S00626","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.005, _mitreAttackTechnique:T1562, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.008, _mitreAttackTechnique:T1562.001","GCP Audit Logging Sink Modified","Detect when a change to a GCP logging sink has been made. This could stop audit logs from being sent."
"Google","Google Cloud Platform","MATCH-S00627","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.005, _mitreAttackTechnique:T1562, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.008, _mitreAttackTechnique:T1562.001","GCP Audit Pub/Sub Subscriber Modified","Detect when a change to a GCP Pub/Sub Subscription has been made. This could stop audit logs from being sent."
"Google","Google Cloud Platform","MATCH-S00628","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.005, _mitreAttackTechnique:T1562, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.008, _mitreAttackTechnique:T1562.001","GCP Audit Pub/Sub Topic Deleted","Detect when a GCP Pub/Sub Subscribtion has been deleted. This could stop audit logs from being sent."
"Google","Google Cloud Platform","THRESHOLD-S00088","threshold","Unknown/Other","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1069, _mitreAttackTechnique:T1087, _mitreAttackTechnique:T1526, _mitreAttackTechnique:T1087.004, _mitreAttackTechnique:T1069.003","GCP Audit Reconnaissance Activity","This signal identifies GCP API GET and LIST actions that when observed in combination could indicate an actors intent to enumerate the environment. These events are generally benign, and occur during normal operations. Use this signal as context around an unfolding security story."
"Google","Google Cloud Platform","MATCH-S00612","templated_match","Collection","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552.005","GCP Audit Secrets Manager Activity","Administrative changes to the GCP Secrets Manager aren't overtly hostile, but are generally low volume and can be considered sensitive. These signals highlight when these actions occur and can be used in context of other suspicious activity to raise the risk of a hostile entity. Several Secrets Manager API actions are included and assessed as sensitive."
"Google","Google Cloud Platform","THRESHOLD-S00089","threshold","Initial Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.005","GCP Audit Unauthorized API Calls","An IAM account sent multiple requests to perform a wide distinct number of GCP Cloud actions in a short time frame while receiving the error codes. This could indicate an account attempting to enumerate their access across the GCP account."
"Google","Google Cloud Platform","MATCH-S00618","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526, _mitreAttackTechnique:T1069, _mitreAttackTechnique:T1087, _mitreAttackTechnique:T1087.004, _mitreAttackTechnique:T1069.003","GCP Bucket Enumerated","Detects when a service account lists out GCS buckets."
"Google","Google Cloud Platform","MATCH-S00619","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1530","GCP Bucket Modified","Detect when an administrative change to a GCS Bucket has been made. This could change the retention policy or bucket lock."
"Google","Google Cloud Platform","MATCH-S00616","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1530","GCP Bucket Open","A GCP request occurred to either create a new public or open bucket. While there are some use cases for GCP S3 public buckets, most are generally private. The security operations center should have a strong understanding of which buckets are allowed to be public."
"Google","Google Cloud Platform","MATCH-S00617","templated_match","Initial Access","True","False","","_mitreAttackTechnique:T1190, _mitreAttackTactic:TA0001, _mitreAttackTactic:TA0008, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1068","GCP GCPloit Exploitation Framework Used","Generates a signal when the GCPloit exploitation framework is detected. This framework can be used to escalate privileges and move laterally from compromised high privilege accounts."
"Google","Google Cloud Platform","CHAIN-S00013","chain","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1212","GCP IDS Detection Followed by API Call","Detects a GCP IDS hit followed by an API call, indicating the source IP was able to gain access to GCP."
"Google","Google Cloud Platform","MATCH-S00709","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1612, _mitreAttackTactic:TA0005","GCP Image Creation","Detects the creation of an image in GCP."
"Google","Google Cloud Platform","MATCH-S00710","templated_match","Impact","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1485","GCP Image Deletion","Detects the deletion of an image in GCP."
"Google","Google Cloud Platform","THRESHOLD-S00104","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","GCP Image Discovery","Detects various discovery commands used for images in GCP."
"Google","Google Cloud Platform","MATCH-S00711","templated_match","Persistence","True","False","","_mitreAttackTechnique:T1525, _mitreAttackTactic:TA0003","GCP Image Modification","Detects the modification of an image in GCP."
"Google","Google Cloud Platform","MATCH-S00712","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1578, _mitreAttackTechnique:T1578.002","GCP Instance Creation","Detects the creation of an instance in GCP."
"Google","Google Cloud Platform","MATCH-S00713","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1578, _mitreAttackTechnique:T1578.003","GCP Instance Deletion","Detects the deletion of an instance in GCP."
"Google","Google Cloud Platform","THRESHOLD-S00105","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","GCP Instance Discovery","Detects various discovery commands used for instances in GCP."
"Google","Google Cloud Platform","MATCH-S00714","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1578","GCP Instance Modification","Detects the modification of an instance in GCP."
"Google","Google Cloud Platform","MATCH-S00625","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.005","GCP Permission Denied","The caller doesn't have permission to execute the specified operation."
"Google","Google Cloud Platform","THRESHOLD-S00091","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1046, _mitreAttackTechnique:T1595, _mitreAttackTechnique:T1595.001","GCP Port Scan","Attackers will often perform reconnaissance against customer environments to better understand resources on the network. This rule looks for a single source IP scanning for different ports across the same destination."
"Google","Google Cloud Platform","THRESHOLD-S00090","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1046, _mitreAttackTechnique:T1595, _mitreAttackTechnique:T1595.001","GCP Port Sweep","Attackers will often perform reconnaissance against customer environments to better understand resources on the network. This rule looks for a single source IP scanning for the same port across multiple destinations."
"","GitHub Enterprise Audit","MATCH-S00952","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1078","GitHub - Administrator Added or Invited","Detects additions or invitations of GitHub Administrators. Illegitimate addition of administrative users could be an indication of priviledge escalation or persistence by adversaries. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","MATCH-S00953","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.008","GitHub - Audit Logging Modification","Detects modifications to the GitHub Enterprise Audit Log. Modifications and deletions have the potential to reduce visibility of malicious activity. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","MATCH-S00954","templated_match","Impact","True","False","","_mitreAttackTactic:TA0040","GitHub - Copilot Seat Cancelled by GitHub","Observes for GitHub staff manually revoking copilot access for a user. This action is likely to be rare and may be indicative of a user violating the [acceptable use policy for GitHub](https://docs.github.com/en/site-policy/acceptable-use-policies). This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","FIRST-S00091","first_seen","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1078","GitHub - First Seen Activity From Country for User","Detects GitHub user activity from a new country. User account compromises can be detected through unusual geolocation in some cases. To lower possible false positives, a tuning expression for expected country names or codes can be added,. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","FIRST-S00090","first_seen","Credential Access","True","False","","_mitreAttackTactic:TA0006","GitHub - First Seen Application Interacting with API","Detects new application usage of the GitHub API. New applications utilizing the API may be routine, however this may also reveal malicious applications utilzing the API. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","MATCH-S00950","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098","GitHub - Member Invitation or Addition","Detects new user additions or invitations to the business or organizations GitHub. New user additions/invitations should be monitored as they could be a vector for malicious actors to establish access or persistence. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","","MATCH-S00955","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1098","GitHub - Member Permissions Modification","Detects modifications of GitHub user permissions. Added permissions for a user should be monitored for potential privilege escalation by an adversary. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","MATCH-S00956","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0006","GitHub - OAuth Application Activity","Detects OAuth application activities within GitHub. OAuth application management and access activity should be monitored for potential abuse by malicous actors, either by creating malicious access paths within GitHub, or destruction of GitHub infrastructure. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","MATCH-S00957","templated_match","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1537, _mitreAttackTactic:TA0010","GitHub - Organization Transfer","Detects transfers of an organization to another enterprise This is a sensitive activity that should be monitored to ensure organizations and their repositories are not being transferred without proper authorization. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","","OUTLIER-S00026","outlier","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1078","GitHub - Outlier in Distinct User Agent Strings by User","Detects an outlier in the number of distinct user agent strings for a GitHub user. Unusual user agent strings for a user account could indicate account takeover. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","","OUTLIER-S00028","outlier","Impact","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1485","GitHub - Outlier in Removal Actions by User","Detects a higher than usual number of removal actions undertaken by a user. This detection has a broad scope to detect any unusual number of destroy, delete, or remove actions undertaken by a user to help detect a range of different potential destructive activities in GitHub."
"","","OUTLIER-S00027","outlier","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTactic:TA0010","GitHub - Outlier in Repository Cloning or Downloads","Detects an unusual number of repository clones for a user. Unusual repository cloning could indicate data exfiltration or discovery. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","MATCH-S00958","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1553, _mitreAttackTechnique:T1553.006","GitHub - PR Review Requirement Removed","Detects GitHub pull request review requirements being removed from a repository either via branch protection rule or ruleset. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","","LEGACY-S00039","match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1204.001, _mitreAttackTechnique:T1204.002, _mitreAttackTechnique:T1204.003, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","GitHub Raw URL Resource Request","Github.com is the most popular code repo site on the internet. Typically users of GitHub will look at the code from the Github.com website or clone it locally to their system. You can however request a raw version of a individual file directly. Attackers like to use GitHub as well to host their malicious code and will often download malicious files and scripts directly from the site which uses the domain raw.githubusercontent.com instead of github.com. This signal looks for HTTP requests to that raw domain to monitor individual file downloads from the site."
"","GitHub Enterprise Audit","MATCH-S00959","templated_match","Impact","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1485","GitHub - Repository Public Key Deletion","Detects deletions of SSH keys in GitHub. Unusual deletions could represent an adversary attempting to disrupt normal operations by denying access. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","MATCH-S00960","templated_match","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1537, _mitreAttackTactic:TA0010","GitHub - Repository Transfer","Detects transfers of a repository to another organization or user. This is a sensitive activity that GitHub places in the ""Danger Zone"" of repository setting and should be monitored to ensure no unauthorized transfers are taking place. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","MATCH-S00961","templated_match","Exfiltration","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTechnique:T1213","GitHub - Repository Visibility Changed to Public","Detects a user making a repository public. This action should be closely monitored and mitigative actions taken even if the published repository is deleted, or reverted to private. Reference: https://trufflesecurity.com/blog/anyone-can-access-deleted-and-private-repo-data-github. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","MATCH-S00962","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0010, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1222","GitHub - Repository Visibility Permissions Changed","Detects repository visibility permissions being changed to allow members of an organization to change the visibility of repositories. This activity introduces the potential for data leakage if a private or internal repository is changed to public and should be monitored to ensure no inadvertent or malicious publication of a repository. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","MATCH-S00963","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1098, _mitreAttackTechnique:T1098.004","GitHub - SSH Key Created for Private Repo","Detects the creation of an SSH key for a private GitHub repository.  Performed maliciously, creating an SSH key could create a parallel access path for an attacker. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","MATCH-S00964","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0006, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1548.002, _mitreAttackTechnique:T1548","GitHub - SSO Recovery Codes Access Activity","Detects activities accessing SSO recovery codes. SSO recovery codes can enable a user to bypass normal more stringent authentication routes. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","MATCH-S00951","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552","GitHub - Secret Scanning Alert","Observes for secret scanning alerts from GitHub. Secrets detected by GitHub Enterprise Cloud undergo validation by GitHub automatically, to determine whether they are actively in use, this is not surfaced in the audit log, and will require separate inspection. For more information see : [Evaluating alerts from secret scanning](https://docs.github.com/en/code-security/secret-scanning/managing-alerts-from-secret-scanning/evaluating-alerts). This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","MATCH-S00965","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1552","GitHub - Secret Scanning Potentially Disabled","Detects actions which disable or modify secret scanning policies for an organization or repository. Modifying or disabling secret scanning may lead to inadvertent leaking of credentials. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","MATCH-S00966","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1556, _mitreAttackTechnique:T1556.006","GitHub - Two-Factor Authentication Disabled for Organization","Observes for two-factor authentication being disabled for a GitHub organization. Removing two-factor authentication requirements significantly degrades the security of the GitHub organization by permitting password only authentication. This detection was developed utilizing GitHub Enterprise Audit logging. Refer to https://help.sumologic.com/docs/integrations/app-development/github/#collecting-logs-for-github for instructions on ingesting GitHub Enterprise Audit logs."
"","GitHub Enterprise Audit","MATCH-S00949","templated_match","Resource Development","True","False","","_mitreAttackTechnique:T1588, _mitreAttackTactic:TA0042","GitHub - Vulnerability Alerts","Detects vulnerability alerts created for a GitHub repository."
"","","MATCH-S00098","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002","Global YARA Rule","A YARA rule matched on a collected file"
"","","MATCH-S00535","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1105, _mitreAttackTechnique:T1548, _mitreAttackTechnique:T1548.002","Golden SAML Indicator : Certificate Export","Observes for multiple methods of certificate export which may indicate that an attacker is attempting to bypass multifactor authentication using a stolen certificate.

This rule utilizes indicators from Windows command line auditing, PowerShell auditing, and Sysmon named pipe connections."
"Google","Google Workspace","MATCH-S00117","templated_match","Impact","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1530","Google Workspace - Access - Access Transparency","Google Access Transparency Activity Events"
"Google","Google Workspace","MATCH-S00133","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","Google Workspace - Admin Activity","The admin activity report returns information on the Admin console activities of all of your account's administrators."
"Google","Google Workspace","MATCH-S00115","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","Google Workspace - Admin - User Settings - Turn Off 2SV","Admin disabled 2SV for user"
"Google","Google Workspace","MATCH-S00125","templated_match","Exfiltration","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1530","Google Workspace - Drive - Drive Open To Public","Google Drive resource shared publicly"
"Google","Google Workspace","MATCH-S00301","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1550, _mitreAttackTechnique:T1550.001","Google Workspace - Excessive OAuth Application Permissions Scope","Alert when an OAuth application has requested a high number of permissions to aspects of Google Workspace."
"Google","Google Workspace","MATCH-S00128","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0006, _mitreAttackTactic:TA0042, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1586, _mitreAttackTechnique:T1586.002","Google Workspace - Login - Account Warning","Google Accounts warnings"
"Google","Google Workspace","MATCH-S00129","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","Google Workspace - Login - Government Attack Warning","Government-backed attack warnings"
"Google","Google Workspace","MATCH-S00121","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","Google Workspace - Mobile - Suspicious Activity","Google Workspace alert for mobile suspicious activity"
"Google","Google Workspace","MATCH-S00227","templated_match","Execution","False","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1550, _mitreAttackTechnique:T1550.001","Google Workspace - Unauthorized OAuth Application","Alert when a non-approved OAuth Application has been identified on Google Workspace. This rule is disabled by default as a list of approved OAuth applications is required to be enabled. The approved applications should be added to the rule logic under the 'application not in' condition."
"Google","Google Workspace","MATCH-S00120","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","Google Workspace - User Accounts - 2SV Disabled","User disabled 2SV"
"","","MATCH-S00414","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.002, _mitreAttackTechnique:T1003.005","Grabbing Sensitive Hives via Reg Utility","Dump sam, system or security hives using REG.exe utility."
"","","MATCH-S00325","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1036, _mitreAttackTechnique:T1036.005, _mitreAttackTechnique:T1036.004, _mitreAttackTechnique:T1036.003, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003, _mitreAttackTechnique:T1105","Greenbug Campaign Indicators","Detects tools and process executions as observed in a Greenbug campaign in May 2020"
"","","MATCH-S00894","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1185, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1539, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1550.004","HAR file creation observed on host","HAR files contain session telemetry and network traffic. These file types are typically generated using the ""developer tools"" options on modern browsers like Chrome, Edge or Firefox. These files may contain various sensitive data such as session keys, tokens or cookies which may be extracted by a threat actor in order to access systems  which the keys, tokens or cookies in the HAR files have access to. Ensure that this operation is expected and ensure to sanitize the HAR file of any sensitive credential material."
"","","LEGACY-S00040","match","Unknown/Other","False","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1190","HTTP CloudFlare Protocol Violation or Empty Response","Error code 520 is used as a catch-all status when the origin server returns something that is unexpected, not tolerated, or not interpreted. This can include protocol violations and empty responses."
"","","LEGACY-S00041","match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","HTTP External Request to PowerShell Extension","Attackers will often download a PowerShell script from an external web server to help maintain persistence or to invoke additional functionally on Windows machines. It is not common for internal computers to download PowerShell scripts over HTTP from an external web server, but in some rare cases software like Anti-Virus does perform this behavior."
"","","LEGACY-S00042","match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","HTTP Request to Domain in Non-Standard TLD","HTTP request to a domain that is not under an ICANN-standard TLD. These TLDs are provided by alternate DNS root servers such as OpenNIC. Their use on corporate networks is fundamentally suspicious and potentially a sign of abuse by threat actors."
"","","LEGACY-S00043","match","Initial Access","False","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","HTTP Request with Single Header","HTTP requests typically have multiple headers. It is odd in some cases if the event only contains a single header. This produces a low severity signal when an HTTP event is observed containing only one header in the request."
"","","THRESHOLD-S00015","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTactic:TA0011, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1595, _mitreAttackTechnique:T1190, _mitreAttackTechnique:T1595.001, _mitreAttackTechnique:T1595.002, _mitreAttackTactic:TA0009, _mitreAttackTechnique:T1213, _mitreAttackTechnique:T1213.001","HTTP Response Error Spike - External","HTTP web services provide response codes to client requests. The response code numbers in the 400s are used to indicate a client related error and response code numbers in the 500s represent server related errors. This rule looks for a web client receiving a large frequency of web errors within a short period of time. It is unusual for a web client to cause this many errors in a short period of time. Common occurrences for this behavior is scanning/probing activity or scripted web clients which are now encountering errors due to a misconfiguration or recent change. This rule alerts when a host external to the monitored network triggers the threshold."
"","","THRESHOLD-S00016","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTactic:TA0011, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1595, _mitreAttackTechnique:T1190, _mitreAttackTechnique:T1595.001, _mitreAttackTechnique:T1595.002, _mitreAttackTactic:TA0009, _mitreAttackTechnique:T1213, _mitreAttackTechnique:T1213.001","HTTP Response Error Spike - Internal","HTTP web services provide response codes to client requests. The response code numbers in the 400s are used to indicate a client related error and response code numbers in the 500s represent server related errors. This rule looks for a web client receiving a large frequency of web errors within a short period of time. It is unusual for a web client to cause this many errors in a short period of time. Common occurrences for this behavior is scanning/probing activity or scripted web clients which are now encountering errors due to a misconfiguration or recent change. This rule alerts when a host on the monitored network triggers the threshold."
"Amazon AWS","","THRESHOLD-S00114","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTactic:TA0011, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1595.001, _mitreAttackTechnique:T1190","HTTP Response Error Spike to AWS EKS","HTTP web services provide response codes to client requests. The response code numbers in the 400s are used to indicate a client related error and response code numbers in the 500s represent server related errors. This rule looks for a AWS EKS cluster receiving a large frequency of web errors within a short period of time. It is unusual for a web client to cause this many errors in a short period of time. Common occurrences for this behavior is scanning/probing activity or scripted web clients which are now encountering errors due to a misconfiguration or recent change. This rule alerts when a host on the monitored network triggers the threshold."
"","","LEGACY-S00044","match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1036, _mitreAttackTechnique:T1036.004, _mitreAttackTechnique:T1190","HTTP Shell Script Download Disguised as a Common Web File","Attackers who have compromised Unix/Linux machines will sometimes download additional payloads using clear text HTTP where a shell script is downloaded disguised with another file extension. This signal looks for HTTP requests to common web file extensions where the network sensor detected a shell script was returned."
"","","MATCH-S00203","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001, _mitreAttackTechnique:T1071.004","HTTP activity over port 53 - Possible SIGRED","Detects a possible exploitation of CVE-2020-1350 (aka SIGRED) using rare HTTP requests over port 53. HTTP should rarely (if ever) hosted on port 53. Technique:  T1068.  Derived from SOC Prime logic."
"","","LEGACY-S00045","match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","HTTP request for single character file name","Many threats are served from websites using lazy single character based filenames like 1.exe, etc. These nondescript file names are rare with most legitimate content. This rule looks for requests to retrieve high risk file extensions from such paths."
"","","LEGACY-S00046","match","Command and Control","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1132, _mitreAttackTechnique:T1132.001, _mitreAttackTactic:TA0009, _mitreAttackTechnique:T1213, _mitreAttackTechnique:T1213.001","Hexadecimal User-Agent","User-Agent strings with hexadecimal values are often indicative of malware."
"","","MATCH-S00666","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1046","High Severity Intrusion Signature","This rule looks for an intrusion product detecting a high severity intrusion signature sourcing from an internal IP."
"","","THRESHOLD-S00078","threshold","Execution","True","False","NetworkDNS","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1568, _mitreAttackTechnique:T1568.001, _mitreAttackTechnique:T1568.002, _mitreAttackTechnique:T1568.003","High Volume of DNS 'Any' Queries","Observes for a large number of DNS 'Any' queries which may be indicative of a Distributed Denial of Service Attack (DDoS)"
"","","LEGACY-S00047","match","Persistence","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0001, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1190, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1204.003, _mitreAttackTechnique:T1204.002, _mitreAttackTechnique:T1204.001","High risk file extension download without hostname and referrer","Although executable and dynamic-link libraries (.exe, .dll) are regularly downloaded from the Internet, benign ones are normally downloaded with the hostname and referrer fields populated. Thus, downloads from an IP address without referrer carry an elevated risk."
"","","LEGACY-S00048","match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001, _mitreAttackTactic:TA0009, _mitreAttackTechnique:T1213, _mitreAttackTechnique:T1213.001","Houdini/Iniduoh/njRAT User-Agent","User-Agent strings used by Houdini/Iniduoh/njRAT malware."
"","","MATCH-S01050","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1505.003, _mitreAttackTechnique:T1505","IIS - Executable File Added to Directory","Context:
Executable files added to Microsoft Internet Information Server (IIS) directories can indicate the installation of a web shell by an attacker. For example, the ToolShell exploit (CVE-2025-53770, CVE-2025-53771) included the installation of spinstall10.aspx in an executable directory.

Detection:
This detection will trigger when files executable by IIS are added to directories that frequently have execute permissions.

Recommended Actions:
Determine whether the addition of the executable file was an expected action, and if not, consider disconnecting the IIS server from the network for forensic analysis. Review logs indicating  unusual network activity originating from the IIS server to other internal assets.

Tuning Recommendations: 
Add executable directories specific to your IIS installation(s) to the rule expression by duplicating the rule and modifying it. Add exclusions as necessary to processes expected to add IIS script files to IIS directories."
"","Bro","LEGACY-S00049","match","Discovery","True","False","","_mitreAttackTactic:TA0043, _mitreAttackTechnique:T1046, _mitreAttackTechnique:T1595, _mitreAttackTechnique:T1595.001","IP Address Scan - External","A scan of IP addresses"
"","Bro","LEGACY-S00050","match","Discovery","True","False","","_mitreAttackTactic:TA0043, _mitreAttackTechnique:T1046, _mitreAttackTechnique:T1595, _mitreAttackTechnique:T1595.001","IP Address Scan - Internal","A scan of IP addresses"
"","","MATCH-S00367","templated_match","Lateral Movement","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.002, _mitreAttackTechnique:T1021.003, _mitreAttackTechnique:T1021.006, _mitreAttackTechnique:T1047, _mitreAttackTechnique:T1559, _mitreAttackTechnique:T1559.001","Impacket Lateralization Detection","Detects wmiexec/dcomexec/atexec/smbexec from Impacket framework"
"Microsoft","Windows","MATCH-S00482","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.002, _mitreAttackTechnique:T1021.006, _mitreAttackTechnique:T1036, _mitreAttackTechnique:T1036.004, _mitreAttackTechnique:T1036.005, _mitreAttackTechnique:T1543, _mitreAttackTechnique:T1543.003","Impacket-Obfuscation SMBEXEC Utility","From FireEye Red Team Tool Countermeasures: Impacket-Obfuscation is a slightly obfuscated version of the open source Impacket framework. This IOC looks for artifacts from the execution of SMBEXEC python script which is part of Impacket-Obfuscation framework."
"","","MATCH-S00483","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1047","Impacket-Obfuscation WMIEXEC Utility","From FireEye Red Team Tool Countermeasures: Impacket-Obfuscation is a slightly obfuscated version of the open source Impacket framework. This IOC looks for artifacts from the execution of WMIEXEC python script which is part of Impacket-Obfuscation framework."
"","","THRESHOLD-S00097","threshold","Initial Access","True","False","Authentication","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1586, _mitreAttackTechnique:T1586.001, _mitreAttackTechnique:T1586.002","Impossible Travel - Successful","This signal triggers when there are two successful logins from the same user with different country codes indicating possible credential theft. It is recommended to add filtering criteria to the expression to reduce false positives, such as known VPN addresses."
"","","THRESHOLD-S00098","threshold","Initial Access","True","False","Authentication","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1586, _mitreAttackTechnique:T1586.001, _mitreAttackTechnique:T1586.002","Impossible Travel - Unsuccessful","This signal triggers when there are two failed logins from the same user with different country codes indicating a possible credential theft attempt. It is recommended to add filtering criteria to the expression to reduce false positives, such as known VPN addresses."
"","","THRESHOLD-S00079","threshold","Discovery","False","False","","_mitreAttackTactic:TA0043, _mitreAttackTechnique:T1595, _mitreAttackTechnique:T1595.001, _mitreAttackTechnique:T1595.002","Inbound Port Scan","This rule detects port scanning activity from external actors against public facing assets."
"","","MATCH-S00669","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1046","Informational Severity Intrusion Signature","This rule looks for an intrusion product detecting an informational severity intrusion signature sourcing from an internal IP."
"Microsoft","Windows","MATCH-S00138","templated_match","Lateral Movement","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1078.004","Interactive Logon with Service Account","Detects an interactive login using a service account. Service accounts should only be used by applications or services and not users. An interactive logon indicates a user has the service account credentials."
"Microsoft","Windows","MATCH-S00816","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021.001","Interactive Logon to Domain Controller","Detects an interactive login to a domain controller. Direct access in this manner is rarely necessary and should be closely audited given the potential impact of a compromised domain controller."
"","Bro","LEGACY-S00053","match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Internal Communication on Unassigned Low Ports - Destination Match","Many ports in the 0-1023 are unassigned by the IANA.  These can be used as communication channels inside a network, as there are rarely legitimate services using these ports."
"","","THRESHOLD-S00080","threshold","Discovery","False","False","Network","_mitreAttackTactic:TA0043, _mitreAttackTechnique:T1595, _mitreAttackTechnique:T1046, _mitreAttackTechnique:T1595.001","Internal Port Scan","This rule detects port scanning activity from one internal IP address to another, possibly indicating an attacker enumerating the network for lateral movement."
"","","THRESHOLD-S00081","threshold","Discovery","False","False","Network","_mitreAttackTactic:TA0043, _mitreAttackTechnique:T1046, _mitreAttackTechnique:T1595, _mitreAttackTechnique:T1595.001","Internal Port Sweep","This rule detects port scanning activity from one internal IP address to numerous others on the same destination port, possibly indicating an attacker enumerating the network for lateral movement."
"","","THRESHOLD-S00514","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1046","Intrusion Scan - Targeted","This rule looks for an intrusion product detecting an internal IP sending different exploits to another IP in a short timeframe."
"","","THRESHOLD-S00515","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1046","Intrusion Sweep","This rule looks for an intrusion product detecting an internal IP sending the same exploit to multiple IPs in a short timeframe."
"","","MATCH-S00322","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.001","Judgement Panda Credential Access Activity","Detects Russian group activity as described in Global Threat Report 2019 by Crowdstrike"
"","","MATCH-S00334","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0006, _mitreAttackTactic:TA0009, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.002, _mitreAttackTechnique:T1560, _mitreAttackTechnique:T1560.001","Judgement Panda Exfil Activity","Detects Judgement Panda activity as described in Global Threat Report 2019 by Crowdstrike"
"","","MATCH-S00700","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1555, _mitreAttackTechnique:T1555.005","KeePass Brute Force Tool Detection","Detects the use of a PowerShell KeePass brute force tool used in a dictionary attack to find and dump the passwords of a KeePass kdbx file."
"","","MATCH-S00703","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1555, _mitreAttackTechnique:T1555.005","KeeThief Detection","KeeThief is a tool that allows for the extraction of KeePass 2.X key material from memory, as well as the backdooring and enumeration of the KeePass trigger system."
"Microsoft","Windows","MATCH-S00364","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1212","Kerberos Manipulation","This method triggers on rare Kerberos Failure Codes caused by manipulations of Kerberos messages."
"","","MATCH-S00702","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1555, _mitreAttackTechnique:T1555.001, _mitreAttackTechnique:T1555.002","Keychain Credential Dumping","Attackers may dump the content of the keychain storage data from a system to acquire credentials."
"","","MATCH-S00701","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1555, _mitreAttackTechnique:T1555.001","Keychain Directory Zipped","This rule the Keychains directory on MacOS being zipped. This is a common technique used by malware in order to grab the keychains of an infected system."
"","","MATCH-S00445","templated_match","Impact","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1486","Known Ransomware File Extensions","Observes for common file extensions associated with ransomware indicating the presence of encrypted files.

Some known ransomware file extensions are shared with other applications and may cause this rule to fire.

File extension list sourced from:
https://techviral.net/ransomware-encrypted-file-extensions/"
"Amazon AWS","CloudWatch","MATCH-S00653","templated_match","Discovery","True","False","","_mitreAttackTechnique:T1526, _mitreAttackTactic:TA0007, _mitreAttackTactic:TA0002, _mitreAttackTechnique:T1106","Kubernetes AWS Suspicious kubectl Calls","Kubectl calls are not malicious by nature. However IP, user and user agent can reveal potential malicious activity, specially anonymous users suspicious IPs and sensitive objects such as configmaps or secrets."
"Kubernetes","Kubernetes","MATCH-S00639","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0001, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.007","Kubernetes Anonymous Request Authorized","Detect when an unauthenticated request user is permitted in Kubernetes."
"","","MATCH-S00651","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1053, _mitreAttackTechnique:T1053.007","Kubernetes CreateCronjob","Detects kubectl used to create Kubernetes cronjobs. Kubernetes Job is a controller that creates one or more pods and ensures that a specified number of them successfully terminate. Kubernetes Job can be used to run containers that perform finite tasks for batch jobs. Kubernetes CronJob is used to schedule Jobs. Attackers may use Kubernetes CronJob for scheduling execution of malicious code that would run as a container in the cluster."
"","","MATCH-S00652","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1053, _mitreAttackTechnique:T1053.007","Kubernetes DeleteCronjob","Detects kubectl used to delete Kubernetes cronjobs. Kubernetes Job is a controller that creates one or more pods and ensures that a specified number of them successfully terminate. Kubernetes Job can be used to run containers that perform finite tasks for batch jobs. Kubernetes CronJob is used to schedule Jobs. Attackers may use Kubernetes CronJob for scheduling execution of malicious code that would run as a container in the cluster."
"","","MATCH-S00650","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1053, _mitreAttackTechnique:T1053.007","Kubernetes ListCronjobs","Detects kubectl used to list Kubernetes cronjobs. Kubernetes Job is a controller that creates one or more pods and ensures that a specified number of them successfully terminate. Kubernetes Job can be used to run containers that perform finite tasks for batch jobs. Kubernetes CronJob is used to schedule Jobs. Attackers may use Kubernetes CronJob for scheduling execution of malicious code that would run as a container in the cluster."
"","","MATCH-S00648","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.007","Kubernetes ListSecrets","Detects kubectl used to list Kubernetes secrets. A Kubernetes secret is an object that lets users store and manage sensitive information, such as passwords and connection strings in the cluster. Secrets can be consumed by reference in the pod configuration. Attackers who have permissions to retrieve the secrets from the API server (by using the pod service account, for example) can access sensitive information that might include credentials to various services."
"Kubernetes","Kubernetes","MATCH-S00640","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1609, _mitreAttackTechnique:T1610, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1204.003","Kubernetes Pod Created in Kube Namespace","Detect when a user is creating a pod in one of the Kubernetes default namespaces. The only users creating pods in the kube-system namespace should be cluster administrators. Furthermore, it is best practice to not run any cluster critical infrastructure in the kube-system namespace. The kube-public namespace is intended for Kubernetes objects which should be readable by unauthenticated users. Thus, a pod should likely not be created in the kube-public namespace."
"Kubernetes","Kubernetes","MATCH-S00641","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1609, _mitreAttackTechnique:T1610, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1204.003","Kubernetes Pod Created with hostNetwork","Detect when a pod is attached to the host network. Attaching the hostNetwork permits a pod to access the nodeâ€™s network adapter allowing a pod to listen to all network traffic for all pods on the node and communicate with other pods on the network namespace."
"","","MATCH-S00647","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1609","Kubernetes Pod Deletion","Detects the deletion of Kubernetes pods using kubectl. Adversaries may delete pods as a way to clean up after executing their actions."
"","","MATCH-S00837","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1613","Kubernetes Secrets Enumeration via Kubectl","Adversaries may enumerate various Kubernetes secrets on hosts they have compromised in order to escalate privileges or to look for persistence avenues."
"Kubernetes","Kubernetes","MATCH-S00642","templated_match","Execution","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1136, _mitreAttackTechnique:T1136.003, _mitreAttackTechnique:T1136.001, _mitreAttackTechnique:T1136.002","Kubernetes Service Account Created in Kube Namespace","Detect when a user is creating a service account in one of the Kubernetes default namespaces. The only users creating service accounts in the kube-system namespace should be cluster administrators. Furthermore, it is best practice to not run any cluster critical infrastructure in the kube-system namespace. The kube-public namespace is intended for kubernetes objects which should be readable by unauthenticated users. Thus, a service account should likely not be created in the kube-public namespace."
"","","MATCH-S00649","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.007","Kubernetes Service Account Token File Accessed","Detects access to the Kubernetes service account access token that is stored within a container in a cluster."
"Kubernetes","Kubernetes","MATCH-S00643","templated_match","Execution","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.007","Kubernetes Service Created with NodePort","Detect when a serviceâ€™s port is attached to the nodeâ€™s IP. Exposing the serviceâ€™s port to the the nodeâ€™s IP allows other hosts on the network namespace to access this service."
"Kubernetes","Kubernetes","MATCH-S00645","templated_match","Execution","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.007","Kubernetes User Attached to a Pod","Detect when a user attaches to a pod. A user should not need to attach to a pod. Attaching to a pod allows a user to attach to any process in a running container which may give an attacker access to sensitive data."
"Kubernetes","Kubernetes","MATCH-S00646","templated_match","Execution","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.007","Kubernetes User Exec into a Pod","Detect when a user execs into a pod. A user should not need to exec into a pod. Execing into a pod allows a user to execute any process in container which is not already running. It is most common to execute the bash process to gain an interactive shell. If this is an attacker, they can access any data which the pod has permissions to, including secrets."
"","","MATCH-S00461","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1202","LNKSmasher Utility Commands","From FireEye Red Team Tool Countermeasures:
LNKSmasher embeds an arbitrary payload in an LNK that can be executed by the embedded command. This IOC will detect the commands executed by both the new and old version of LNKSmasher."
"Microsoft","Windows","MATCH-S00340","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001","LSASS Memory Dump","Detects memory dumping from LSASS.

For this rule to work, Microsoft SysInternal Sysmon must be running on the endpoint."
"","","MATCH-S00429","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001","LSASS Memory Dumping","Detect creation of dump files containing the memory space of lsass.exe, which contains sensitive credentials. Identifies usage of Sysinternals procdump.exe to export the memory space of lsass.exe which contains sensitive credentials."
"","","MATCH-S00457","templated_match","Exfiltration","False","False","","_mitreAttackTactic:TA0010, _mitreAttackTechnique:T1567, _mitreAttackTechnique:T1567.001, _mitreAttackTechnique:T1567.002","Large File Upload","Observes for file uploads above 50MB in size. It is recommended to tune this rule to desired file size threshold for your organization as well as to exclude users/systems typically sending large outbound files."
"","","MATCH-S00396","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1095","Large Outbound ICMP Packets","A typical ping packet will be very small. A large ICMP packet may indicate the presence of command and control traffic."
"LastPass","LastPass","MATCH-S00844","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1136","LastPass - Account Created","Detects createLPaccount events from LastPass"
"LastPass","LastPass","MATCH-S00854","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006","LastPass - Failed Login","Detects Failed Login events from LastPass"
"LastPass","LastPass","MATCH-S00846","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098","LastPass - Folder Permissions Updated","Detects updatefolderpermissions events from LastPass"
"LastPass","LastPass","MATCH-S00855","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006","LastPass - Login","Detects Login events from LastPass"
"LastPass","LastPass","MATCH-S00847","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098","LastPass - Master Password Changed","Detects masterpasswordchanged events from LastPass"
"LastPass","LastPass","MATCH-S00848","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098","LastPass - Password Changed","Detects passwordchanged events from LastPass"
"LastPass","LastPass","MATCH-S00849","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098","LastPass - Personal Share","Detects personalshare events from LastPass"
"LastPass","LastPass","MATCH-S00850","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1484, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0004","LastPass - Policy Added","Detects addpolicy events from LastPass"
"LastPass","LastPass","MATCH-S00851","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1484, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0004","LastPass - Policy Deleted","Detects deletepolicy events from LastPass"
"LastPass","LastPass","MATCH-S00852","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1484, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0004","LastPass - Shared Folder Created","Detects createdsharedfolder events from LastPass"
"LastPass","LastPass","MATCH-S00853","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098","LastPass - Super Admin Password Reset","Detects superadminpasswordreset events from LastPass"
"Microsoft","Windows","CHAIN-S00004","chain","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.002","Lateral Movement Using the Windows Hidden Admin Share","Detects pivoting to an internal host from another internal host. Attackers will connect to the ADMIN$ share of an internal host and upload a program to execute remote commands to fully compromise the host."
"","Bro","LEGACY-S00054","match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1210","Likely doublepulsar Infected","Hosts infected with the Doublepulsar typically exhibit this type of SMB behavior"
"Linux","Linux OS Syslog","MATCH-S00784","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0007, _mitreAttackTechnique:T1040","Linux Host Entered Promiscuous Mode","Promiscuous mode causes a network interface to send all traffic frames it receives to the host's CPU rather than only the frames designated for the receiver. This is required for several packet sniffing tools, such as tcpdump or Wireshark, and should be scrutinized for legitimacy. Network administrators may need to be tuned out of this rule."
"","","MATCH-S00687","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004","Linux Security Tool Usage","This rule monitors for usage of the default command or script names associated with penetration testing tools used on Linux machines. While these commands can be renamed to avoid detection, less sophisticated attackers will often neglect to do so."
"","","MATCH-S00746","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1547.006","Loadable Kernel Module Dependency Install","Detects commands associated with the installation of loadable kernel modules. LKMs can be used on Linux systems to accomplish persistence by modifying the kernel to execute malicious programs at boot automatically."
"","","MATCH-S00745","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1547.006, _mitreAttackTactic:TA0007","Loadable Kernel Module Enumeration","Detects commands associated with enumerations of loadable kernel modules. LKMs can be used on Linux systems to accomplish persistence by modifying the kernel to execute malicious programs at boot automatically."
"","","MATCH-S00723","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1547.006","Loadable Kernel Module Modifications","Detects commands associated with modifications to loadable kernel modules. LKMs can be used on Linux systems to accomplish persistence by modifying the kernel to execute malicious programs at boot automatically."
"","","MATCH-S00505","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.003","Local User Created","Observes for the creation of a local Windows user account. Informational signal, severity 0."
"","","MATCH-S00509","templated_match","Credential Access","False","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.003","Logon with Local Credentials","Observes for unexpected local logins. This rule includes 2 match lists to be populated with the active directory domains and permitted local accounts."
"","","THRESHOLD-S00099","threshold","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0001, _mitreAttackTechnique:T1068, _mitreAttackTechnique:T1190","Long URL Containing SQL Commands","Observes for long URLs with possible SQL commands within them, an indication of SQL injection activity"
"","","MATCH-S00668","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1046","Low Severity Intrusion Signature","This rule looks for an intrusion product detecting a low severity intrusion signature sourcing from an internal IP."
"Microsoft","Windows","MATCH-S00578","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001, _mitreAttackTechnique:T1112","Lsass Registry Key Modified","This rule monitors for changes to lsass.exe-related registry keys that are often edited to enable or obfuscate activity related to dumping the process."
"","Bro","THRESHOLD-S00018","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1087, _mitreAttackTechnique:T1087.001, _mitreAttackTechnique:T1087.002, _mitreAttackTechnique:T1087.003, _mitreAttackTechnique:T1087.004","MS-LSAT Username Enumeration","The MS-LSAT Remote Protocol provides a number of RPC calls that can be used to map security principal SIDs to usernames. Attackers could use this technique to perform username enumeration and identify accounts on targeted systems."
"","","MATCH-S00352","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1140, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.005","MSHTA Suspicious Execution","Detection for mshta.exe suspicious execution patterns sometimes involving file polyglotism."
"","","MATCH-S00573","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1036, _mitreAttackTechnique:T1036.005","MS Office Memory Corruption Vulnerability Exploit","Observes for exploitation of Microsoft Office Memory Corruption Vulnerability (CVE-2015-1641)"
"","","MATCH-S00811","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1203","MS Office Product Spawning Msdt.exe - CVE-2022-30190","Monitors for exploitation of CVE-2022-30190 as indicated by a Microsoft Office executable spawning msdt.exe. More information on this vulnerability can be found at the Microsoft Security Response Center: https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/"
"","","MATCH-S00729","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1553.001, _mitreAttackTactic:TA0005","MacOS Gatekeeper Bypass","The com.apple.quarantine flag is usually automatically set for downloaded files and invokes Apple's Gatekeeper program for file analysis. As such, attackers may attempt to remove this flag from malware payloads using the xattr command. Note that files downloaded via curl, external media, or from shared drives on the local network do not set the com.apple.quarantine flag."
"","","MATCH-S00731","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1553.006","MacOS System Integrity Protection Disabled","The System Integrity Protection (SIP) feature of MacOS helps to prevent the execution of unauthorized code and disabling this feature can be an indicator of a malicious actor attempting to bypass default security features. Tuning for this rule may be necessary if software developers in the organization use MacOS and need to disable SIP to run their code."
"","","MATCH-S00534","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1547, _mitreAttackTechnique:T1647, _mitreAttackTechnique:T1547.007, _mitreAttackTechnique:T1543.004, _mitreAttackTechnique:T1543.001, _mitreAttackTechnique:T1543, _mitreAttackTechnique:T1037.002, _mitreAttackTechnique:T1037","MacOS - Re-Opened Applications","This rule looks for processes referencing the plist files that determine which applications are re-opened when a user reboots their machine. This may also detect commands associated with login hooks being executed."
"Microsoft","Windows","MATCH-S00579","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1055, _mitreAttackTechnique:T1055.001, _mitreAttackTechnique:T1055.002, _mitreAttackTechnique:T1055.003, _mitreAttackTechnique:T1055.009, _mitreAttackTechnique:T1055.012","Malicious Named Pipes","Observes for known pipe names associated with malicious activity"
"","","MATCH-S00161","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.004, _mitreAttackTechnique:T1003.005, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003, _mitreAttackTechnique:T1059.001, _mitreAttackTechnique:T1134, _mitreAttackTechnique:T1134.001, _mitreAttackTechnique:T1134.002, _mitreAttackTechnique:T1134.003","Malicious PowerShell Get Commands","This rule detects commandlets from common PowerShell exploitation frameworks."
"","","MATCH-S00190","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001, _mitreAttackTechnique:T1003.002, _mitreAttackTechnique:T1003.003, _mitreAttackTechnique:T1003.004, _mitreAttackTechnique:T1003.005, _mitreAttackTechnique:T1003.006, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003, _mitreAttackTechnique:T1059.001, _mitreAttackTechnique:T1134, _mitreAttackTechnique:T1134.001, _mitreAttackTechnique:T1134.002, _mitreAttackTechnique:T1134.003","Malicious PowerShell Invoke Commands","Detects Commandlet names from well-known PowerShell exploitation frameworks."
"","","MATCH-S00198","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001, _mitreAttackTechnique:T1003.002, _mitreAttackTechnique:T1003.003, _mitreAttackTechnique:T1003.004, _mitreAttackTechnique:T1003.005, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003, _mitreAttackTechnique:T1059.001, _mitreAttackTechnique:T1134, _mitreAttackTechnique:T1134.001, _mitreAttackTechnique:T1134.002, _mitreAttackTechnique:T1134.003","Malicious PowerShell Keywords","This rule detects well known keywords from PowerShell exploitation frameworks."
"Microsoft","Windows","MATCH-S00582","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1543, _mitreAttackTechnique:T1569, _mitreAttackTechnique:T1543.003, _mitreAttackTechnique:T1569.002","Malicious Service Installs","Observes for several known malicious services being installed on a system"
"","","MATCH-S00519","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1569, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1569.002, _mitreAttackTechnique:T1204.002, _mitreAttackTechnique:T1204.003","Malware Cleaned","Detects malware that was cleaned."
"","","MATCH-S00518","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1569, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1569.002, _mitreAttackTechnique:T1204.002, _mitreAttackTechnique:T1204.003","Malware Not Cleaned","Detects malware that failed to be cleaned."
"","","THRESHOLD-S00517","threshold","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1569, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1569.002, _mitreAttackTechnique:T1204.002, _mitreAttackTechnique:T1204.003","Malware Outbreak","Detects the same malware signature on multiple hosts in a short timeframe. This indicates malware may be spreading in the environment."
"","","MATCH-S00331","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1055, _mitreAttackTechnique:T1055.001, _mitreAttackTechnique:T1055.003, _mitreAttackTechnique:T1055.009, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.013","MavInject Process Injection","Detects process injection using the signed Windows tool Mavinject32.exe"
"McAfee","Web Gateway","MATCH-S00638","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","McAfee Web Gateway - Suspicious or Malicious Categories","This rule triggers any time there is a Suspicious or Malicious McAfee Web Gateway category which could indicate there is a problem with the host making the connection."
"McAfee","Web Gateway","MATCH-S00042","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","McAfee Web Gateway - Poor Reputation","Observes for sites categorized as having a poor reputation by McAfee Web Gateway"
"","","MATCH-S00667","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1046","Medium Severity Intrusion Signature","This rule looks for an intrusion product detecting a medium severity intrusion signature sourcing from an internal IP."
"","","MATCH-S00355","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1543, _mitreAttackTechnique:T1569, _mitreAttackTechnique:T1543.003, _mitreAttackTechnique:T1569.002","Meterpreter or Cobalt Strike Getsystem Service Start","Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service starting."
"","","MATCH-S00725","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218.001","Microsoft CHM File Observed","Compiled HTML Files (.chm) are blocked by default on modern Windows operating systems and are also vulnerable to malicious code embedding. These factors make the presence of .chm files on company assets both unusual and risky."
"","","MATCH-S00763","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1137.006, _mitreAttackTechnique:T1137","Microsoft Office Add-In Persistence","Detects additions to Microsoft Office add-ins on a host. Add-ins can be used by an adversary to gain poersistence as they are executed on Office applications being launched."
"","","MATCH-S00813","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1203","Microsoft Support Diagnostic Tool Invoking PowerShell - CVE-2022-30190","Monitors for exploitation of CVE-2022-30190 as indicated by the Microsoft Support Diagnostic Tool Invoking PowerShell. More information on this vulnerability can be found at the Microsoft Security Response Center: https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/"
"","","MATCH-S00812","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1203","Microsoft Support Diagnostic Tool with BrowseForFile - CVE-2022-30190","Monitors for exploitation of CVE-2022-30190 as indicated by the Microsoft Support Diagnostic Tool being observed with the BrowseForFile command. More information on this vulnerability can be found at the Microsoft Security Response Center: https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/"
"","","MATCH-S00888","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1566","Microsoft Teams External Access Enabled","Microsoft Teams External Access has been enabled, this settings allows any users that are external to your Teams/Office organization to message users that are within your Teams/Office organization. If this setting change is unplanned or unexpected it is recommended that this activity be reviewed.  MIcrosoft Teams provides administrators the ability to allow only specific external domains to message users within the organization. Look for Office 365 events with the ""MessageSent"" or ""MemberAdded"" event names in order to gain more detail as to what users were invited to which Teams channels - if any."
"","","MATCH-S00889","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1566","Microsoft Teams Guest Access Enabled","Microsoft Teams Guest Access has been enabled globally, this settings allows any users that are external to your Teams/Office organization to be invited into your Teams/Office organization. If this setting change is unplanned or unexpected it is recommended that this activity be reviewed. MIcrosoft Teams provides administrators the ability to allow only specific guest actions to take place within the Teams/Office organization."
"","","MATCH-S00681","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTactic:TA0010, _mitreAttackTechnique:T1020, _mitreAttackTechnique:T1020.001, _mitreAttackTechnique:T1114, _mitreAttackTechnique:T1114.001, _mitreAttackTechnique:T1114.002, _mitreAttackTechnique:T1114.003","Mimecast Message Held","You may have a DLP policy in place to hold a message due to some security risk. It depends on the policy and this rule can be tuned to include or exclude certain policies."
"Mimecast","Mimecast","LEGACY-S00183","match","Execution","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0002, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Mimecast - Message with Virus Detections from IP","Mimecast detected a message with one or more virus detections."
"Mimecast","Mimecast","LEGACY-S00184","match","Execution","False","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0002, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Mimecast - Message with Virus Detections to Recipient","Mimecast detected a message with one or more virus detections."
"Mimecast","Mimecast","LEGACY-S00185","match","Collection","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Mimecast - SPAM Message from IP","Mimecast detected an email message with an elevated SPAM score."
"Mimecast","Mimecast","LEGACY-S00186","match","Collection","False","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Mimecast - SPAM Message to Recipient","Mimecast detected an email message with an elevated SPAM score."
"Microsoft","Windows","MATCH-S00397","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1555, _mitreAttackTechnique:T1547, _mitreAttackTechnique:T1547.005, _mitreAttackTechnique:T1555.003, _mitreAttackTechnique:T1555.004, _mitreAttackTechnique:T1134, _mitreAttackTechnique:T1134.005, _mitreAttackTechnique:T1098, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001, _mitreAttackTechnique:T1003.002, _mitreAttackTechnique:T1003.004, _mitreAttackTechnique:T1003.006, _mitreAttackTechnique:T1207, _mitreAttackTechnique:T1558, _mitreAttackTechnique:T1558.001, _mitreAttackTechnique:T1558.002, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1550, _mitreAttackTechnique:T1550.002, _mitreAttackTechnique:T1550.003","Mimikatz Loaded Images Detected","Observes for image accesses of images used for credential dumping via Mimikatz"
"Microsoft","Windows","MATCH-S00404","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1555, _mitreAttackTechnique:T1547, _mitreAttackTechnique:T1547.005, _mitreAttackTechnique:T1555.003, _mitreAttackTechnique:T1555.004, _mitreAttackTechnique:T1134, _mitreAttackTechnique:T1134.005, _mitreAttackTechnique:T1098, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001, _mitreAttackTechnique:T1003.002, _mitreAttackTechnique:T1003.004, _mitreAttackTechnique:T1207, _mitreAttackTechnique:T1558, _mitreAttackTechnique:T1558.001, _mitreAttackTechnique:T1558.002, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.004, _mitreAttackTechnique:T1550, _mitreAttackTechnique:T1550.002, _mitreAttackTechnique:T1550.003","Mimikatz via Powershell and EventID 4703","Observes for eventID 4703 with SeDebugPrivileges added by powershell. May indicate the presence of Mimikatz credential dumping."
"","","MATCH-S00750","templated_match","Persistence","True","True","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1037.003, _mitreAttackTechnique:T1037","Modification of Windows Network Logon Scripts","Detects modifications of Windows Network Logon Scripts on domain controllers. Windows Network Logon Scripts are distributed to systems on a domain and can be used by an adversary to establish persistence across a network."
"","","MATCH-S00466","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1105, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.007","MsiExec Web Install","Detects suspicious msiexec process starts with web addresses as parameter."
"","","THRESHOLD-S00112","threshold","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071","Multiple Azure Firewall Deny Events for IP","An Azure firewall has denied a large number of request from an IP address within a short time window."
"","","THRESHOLD-S00113","threshold","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071.001","Multiple Azure Firewall Deny Events for URL","An Azure firewall has denied a large number of requests to a URL within a short time window."
"","","MATCH-S00419","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1036, _mitreAttackTechnique:T1036.007","Multiple File Extensions","Observes for common file extensions appearing before the actual file extension (ex. totallynotmalware.pdf.exe)"
"Microsoft","Windows","THRESHOLD-S00077","threshold","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003","Multiple Windows Account Lockouts On Endpoint","Observes for multiple Windows account lockouts in a short period on a single endpoint. This could indicate password guessing or brute force activity."
"","","MATCH-S00574","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0001, _mitreAttackTechnique:T1203",".NET Framework Remote Code Execution Vulnerability","Observes for possible exploitation of CVE-2017-8759"
"","","MATCH-S00743","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.002","Network Connection from Control Panel - Sysmon","Native Window utilities are often employed by attackers to execute malicious code in order to abuse the elevated privileges of these processes and to blend in with normal system activity. This rule monitors for outbound TCP/UDP connections spawning from control.exe as this could indicate a second-stage payload acquisition. Note that sysmon event ID 3 does not record ICMP connections."
"","","MATCH-S00736","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.004","Network Connection from InstallUtil - Sysmon","Native Window utilities are often employed by attackers to execute malicious code in order to abuse the elevated privileges of these processes and to blend in with normal system activity. This rule monitors for outbound TCP/UDP connections spawning from installutil.exe as this could indicate a second-stage payload acquisition. Note that sysmon event ID 3 does not record ICMP connections."
"","","MATCH-S00737","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.005","Network Connection from MSHTA - Sysmon","Native Window utilities are often employed by attackers to execute malicious code in order to abuse the elevated privileges of these processes and to blend in with normal system activity. This rule monitors for outbound TCP/UDP connections spawning from mshta.exe as this could indicate a second-stage payload acquisition. Note that sysmon event ID 3 does not record ICMP connections."
"","","MATCH-S00738","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.007","Network Connection from Msiexec - Sysmon","Native Window utilities are often employed by attackers to execute malicious code in order to abuse the elevated privileges of these processes and to blend in with normal system activity. This rule monitors for outbound TCP/UDP connections spawning from msiexec.exe as this could indicate a second-stage payload acquisition. Note that sysmon event ID 3 does not record ICMP connections."
"","","MATCH-S00744","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.008","Network Connection from Odbcconf - Sysmon","Native Window utilities are often employed by attackers to execute malicious code in order to abuse the elevated privileges of these processes and to blend in with normal system activity. This rule monitors for outbound TCP/UDP connections spawning from odbcconf.exe or regasm.exe as this could indicate a second-stage payload acquisition. Note that sysmon event ID 3 does not record ICMP connections."
"","","MATCH-S00740","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.009","Network Connection from Regsvcs/Regasm - Sysmon","Native Window utilities are often employed by attackers to execute malicious code in order to abuse the elevated privileges of these processes and to blend in with normal system activity. This rule monitors for outbound TCP/UDP connections spawning from regsvcs.exe or regasm.exe as this could indicate a second-stage payload acquisition. Note that sysmon event ID 3 does not record ICMP connections."
"","","MATCH-S00742","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.010","Network Connection from Regsvr32 - Sysmon","Native Window utilities are often employed by attackers to execute malicious code in order to abuse the elevated privileges of these processes and to blend in with normal system activity. This rule monitors for outbound TCP/UDP connections spawning from regsvr32.exe as this could indicate a second-stage payload acquisition. Note that sysmon event ID 3 does not record ICMP connections."
"","","MATCH-S00741","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.011","Network Connection from Rundll32 - Sysmon","Native Window utilities are often employed by attackers to execute malicious code in order to abuse the elevated privileges of these processes and to blend in with normal system activity. This rule monitors for outbound TCP/UDP connections spawning from rundll32.exe as this could indicate a second-stage payload acquisition. Note that sysmon event ID 3 does not record ICMP connections."
"","","MATCH-S00739","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.012","Network Connection from Verclsid - Sysmon","Native Window utilities are often employed by attackers to execute malicious code in order to abuse the elevated privileges of these processes and to blend in with normal system activity. This rule monitors for outbound TCP/UDP connections spawning from verclsid.exe as this could indicate a second-stage payload acquisition. Note that sysmon event ID 3 does not record ICMP connections."
"Microsoft","Windows","THRESHOLD-S00059","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1135","Network Share Scan","Detects multiple network share access attempts from one internal host to another. Attackers will often scan the network for open network shares in order to pivot between internal hosts."
"Microsoft","Windows","THRESHOLD-S00060","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1135","Network Share Sweep","Detects multiple network share access attempts from one internal host to another for a single share. Attackers will often scan the network for specific open network shares, such as ADMIN$ used for PSEXEC, in order to pivot between internal hosts."
"","","MATCH-S00868","templated_match","Defense Evasion","True","True","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1078.004","New Binding Role Created on AWS EKS","A  role binding grants a resource superuser or administrative access to a Kubernetes cluster. Ensure this action is expected and performed by known Kubernetes administrators."
"","","MATCH-S00867","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1078.004","New Cluster Admin Binding Role Created on AWS EKS","A cluster-admin role binding grants a resource superuser or administrative access to a Kubernetes cluster. Ensure this action is expected and performed by known Kubernetes administrators."
"Amazon AWS","CloudTrail","MATCH-S00655","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1578, _mitreAttackTechnique:T1610, _mitreAttackTechnique:T1578.002, _mitreAttackTactic:TA0005","New Container Uploaded to AWS ECR","New Container Uploaded to AWS ECR"
"Kubernetes","Kubernetes","MATCH-S00644","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1609, _mitreAttackTechnique:T1610, _mitreAttackTechnique:T1204.003","New Kubernetes Namespace Created","Detect when a user is creating a Kubernetes namespace."
"","","MATCH-S00156","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0003, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.001, _mitreAttackTechnique:T1059.003","New Suspicious cmd.exe / regedit.exe / powershell.exe Service Launch","The Service Control Manager, or services.exe, has no legitimate reason to launch commands like cmd.exe, powershell.exe, or regedit.exe. Incidentally, a common way for malware to masquerade as something legitimate is to call itself service.exe."
"Microsoft","Windows","MATCH-S00152","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1036, _mitreAttackTechnique:T1036.003, _mitreAttackTechnique:T1036.004, _mitreAttackTechnique:T1036.005","New or Renamed Windows User Account Mimicking a Machine Account","A new or renamed user account which starts with a $ following machine account naming conventions.  Attackers could use this to bypass detection logic where machine names are filtered from rules."
"","","MATCH-S00895","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1006","NinjaCopy Usage Detected","NinjaCopy is a legacy PowerShell tool that can copy files from an NTFS volume in a manner that bypasses SACL auditing as well as DACL controls such as only allowing SYSTEM to open a file. This tool is often used to exfiltrate the Active Directory database (NTDS.dit) file from domain controllers in order to extract credential material. Usage of this tool in an environment should be considered highly suspciious."
"","Bro","LEGACY-S00181","match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.004","Noncompliant Protocol Tunnel Over Common Service Port","Tools or malware may be configured to send communications over a network by using a common service port to carry unrelated traffic. This is often done to bypass security controls or to obfuscate malicious traffic by mimicking a legitimate service. For example, this is often done with UDP based VPN tunnels connecting over port 53. https://attack.mitre.org/techniques/T1043/ describes the use of this technique by attackers."
"","","MATCH-S00402","templated_match","Execution","True","False","","","Normalized Security Signal","Passes through an alert from an endpoint security product and adjusts the severity accordingly based on the severity provided in the log."
"","","MATCH-S00288","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1486, _mitreAttackTechnique:T1210, _mitreAttackTechnique:T1083, _mitreAttackTechnique:T1070, _mitreAttackTechnique:T1070.001, _mitreAttackTechnique:T1036, _mitreAttackTechnique:T1036.004, _mitreAttackTechnique:T1036.005, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.002, _mitreAttackTechnique:T1053, _mitreAttackTechnique:T1053.005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.011, _mitreAttackTechnique:T1518, _mitreAttackTechnique:T1518.001, _mitreAttackTechnique:T1569, _mitreAttackTechnique:T1569.002, _mitreAttackTechnique:T1529, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1047","NotPetya Ransomware Activity","Detects NotPetya ransomware activity by identifying one of these occurring: the extracted passwords are passed back to the main module via named pipe, the file system journal of drive C is deleted or windows eventlogs are cleared using wevtutil."
"Microsoft","Office 365","MATCH-S00455","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","O365 - Successful Authentication with PowerShell User Agent","Detects a successful authentication to Office 365 where the user agent string contains PowerShell. By default, PowerShell will appear in the user agent string when used in authentication attempts for 0365. This can be an indication of a PowerShell Exploitation framework being used to authenticate."
"Microsoft","Office 365","MATCH-S00068","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098, _mitreAttackTechnique:T1098.003, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","O365 - Users Password Changed","This is usually routine administrative activity, but should be monitored in case an administrative user has been compromised."
"Microsoft","Office 365","MATCH-S00069","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098, _mitreAttackTechnique:T1098.003, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","O365 - Users Password Reset","Detects typically routine administrative activity, but should be monitored in case an administrative user has been compromised."
"","","MATCH-S01053","templated_match","Unknown/Other","True","False","","","OCSF Compliance Finding","Passes through compliance findings from OCSF sources.

Compliance Control: {{fields['compliance.control']}} 
Finding Info: {{fields['finding_info.desc']}} 
Finding Origin: {{fields['metadata.product.name']}}"
"","","MATCH-S01054","templated_match","Unknown/Other","True","False","","","OCSF Detection Finding","Passes through detection findings from OCSF sources.

Remediation Info: {{fields['remediation.references.1']}} 
Finding Info: {{fields['finding_info.desc']}} 
Finding Origin: {{fields['metadata.product.name']}}"
"","","MATCH-S01055","templated_match","Unknown/Other","True","False","","","OCSF Vulnerability Finding","Passes through vulnerability findings from OCSF sources.

Remediation Info: {{fields['remediation.references.1']}} 
Finding Info: {{fields['finding_info.desc']}} 
Finding Origin: {{fields['metadata.product.name']}}"
"","","MATCH-S00828","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1114.003","Office 365 Exchange Transport Rule Created","Threat actors may create, update or otherwise modify various Office 365 inbox rules to delete sensitive emails - such as those originating from security teams - or automatically forward emails to a mailbox in their control."
"","","MATCH-S00829","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1114.003","Office 365 Exchange Transport Rule Enabled","Threat actors may create, update or otherwise modify various Office 365 inbox rules to delete sensitive emails - such as those originating from security teams - or automatically forward emails to a mailbox in their control."
"","","MATCH-S00830","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1114.003","Office 365 Forwarding Rule Created","Threat actors may create, update or otherwise modify various Office 365 inbox rules to automatically forward emails to a mailbox in their control."
"","","MATCH-S00833","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1114.003","Office 365 Inbox Rule Created","Threat actors may create, update or otherwise modify various Office 365 inbox rules to delete sensitive emails - such as those originating from security teams - or automatically forward emails to a mailbox in their control."
"","","MATCH-S00832","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1114.003","Office 365 Inbox Rule Updated","Threat actors may create, update or otherwise modify various Office 365 inbox rules to delete sensitive emails - such as those originating from security teams - or automatically forward emails to a mailbox in their control."
"","","MATCH-S00831","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.008","Office 365 Unified Audit Logging Disabled","Cloud environments such as Office 365 and Azure allow for collection and analysis of audit telemetry that provides insight into what activities a user does within the Office 365 environment. If a threat actor has sufficient permissions, they can disable logging to avoid detection of their potentially malicious activities."
"","","MATCH-S00137","templated_match","Execution","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0002, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1204.001, _mitreAttackTechnique:T1204.002, _mitreAttackTechnique:T1204.003, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1566.003, _mitreAttackTechnique:T1598.001, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003, _mitreAttackTechnique:T1598","Office Application or Browser Launching Shell","This alert detects a shell launched by an office product or browser that should not be spawning shell processes. Attackers may inject code into Office documents or abuse Windows utilities to spawn shells that will execute malicious commands."
"Okta","","MATCH-S00906","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1550.001","Okta - Application Created","This rule looks for an Okta application being created. Ensure that this activity is expected and authorized. Only Okta administrators should be creating applications. Check the Okta administrator portal for more details regarding the application in question such as scopes and access levels. The field ""fields[""target.1.alternateId""]"" contains the name of the application that was created"
"Okta","","MATCH-S00903","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1098.005","Okta - Device Added To User","An Okta device was added to a user. This activity may occur as part of normal user operations such as lost device. It is recommended that other events around this activity â€“ particularly Okta events â€“ be reviewed to determine if this activity is expected. The â€œtargetâ€ element in the full event has the details of the type of device being added. This information can be used to confirm the activity with the user in question if deemed necessary."
"Okta","","MATCH-S00904","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1098.005","Okta - Device Removed From User","An Okta device was removed from a user. It is recommended that the user performing the action be cross-referenced to a list of approved Okta administrators. In addition, examine the IP address of the user who is performing the action to determine of this activity is expected. The ""target.1."" fields of the detailed event contain information regarding which device was removed."
"","","FIRST-S00070","first_seen","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1078.004","Okta - First Seen Application Accessed by User","This signal looks for a user that is accessing an application behind Okta SSO that is first seen since the baseline period. Ensure that access of this application is expected and authorized, look for other Okta events around the user account in question to determine whether access to this application is expected and authorized."
"Okta","","FIRST-S00067","first_seen","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1550.001","Okta - First Seen Client ID/ASN combo in successful OIDC token grant","This signal looks for a new Client ID value ( mapped to the user_username field ) and ASN combination being issued an OIDC token, excluding the Okta Browser Plugin and Okta Dashboard. Use the Okta admin portal and look at the ""Applications"" section to cross-reference the Client ID value - ensure that the IP address that is requesting the token is known and that this operation is expected and authorized."
"Okta","","FIRST-S00068","first_seen","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.005, _mitreAttackTechnique:T1078.004","Okta - First Seen User Accessing Admin Application","A user not seen since the baseline period has accessed the Okta admin application. Ensure that this user is expected to perform Okta administrative activities. If this user is expected and authroized, consider adding the user to the ""Okta_Admins"" match list to exclude the user from this signal."
"Okta","","FIRST-S00066","first_seen","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1087.004","Okta - First Seen User Requesting Report","This signal looks for a first seen user requesting an export of an Okta report. The various Okta report types can be found in the â€œReportsâ€ section of the Okta administrative portal and can include various report types such as application password help, MFA usage and reports around user access. During the October 2023 Okta incident, threat actors downloaded reports from Okta portals to extract information regarding user contact information. Ensure that the user that is requesting such reports is authorized and that this activity is expected. If a suspicious report generation event occurs, look at the â€œtargetâ€ element within the event to gain more detailed information as to the type of report being generated and exported."
"","","CHAIN-S00020","chain","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1621","Okta - MFA Denied Followed by Successful Logon","This signal looks for a single user explicitly denying at least two (2) multi factor authentication prompts, followed by a successful Okta login via multi factor authentication within a twenty-five (25) minute window. This logic is designed to catch successful MFA fatigue type attacks. If you find this signal is triggering on legitimate events, consider excluding certain users via tuning expressions. You can also consider tweaking the time window within the ""Grouped by"" portion of the rule. "
"","","OUTLIER-S00018","outlier","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1078.004","Okta - Outlier in ASNs Used to Access Applications","This signal looks for an outlier in the number of distinct autonomous system numbers (ASNs) that a particular user utilizes to access Okta resources within an hour time period. This is designed to alert on various forms of token or credential theft as well as general Okta session anomalies."
"","","OUTLIER-S00017","outlier","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1621","Okta - Outlier in MFA Attempts Denied by User","This signal builds an hourly baseline of MFA denied events per user and triggers when an outlier in the number of denied attempts is detected. This signal is designed to trigger on MFA-fatigue type attacks. If false positives are detected, consider excluding certain users from the alerting logic or raise the minimum count value within the rule configuration."
"","","OUTLIER-S00016","outlier","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1528","Okta - Outlier in OIDC token request failures","This signal looks for an outlier in the number of OpenID Connect (OIDC) token request failures for an Okta client application. Use the Okta admin portal to correlate the Client ID ( mapped to user_username ) to determine what application is being targeted. Pivot off the Client ID and IP address values to examine the raw Okta events in order to ensure that this activity is planned and expected. This activity can occur during setup and development of Okta applications and integrations."
"Okta","","MATCH-S00907","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1078.004","Okta - Policy Rule Added","An Okta policy rule has been added through the Okta admin application. The field ""fields[""target.1.displayName""]"" contains the name of this rule for investigation purposes. Ensure that this activity is planned and performed by an authorized Okta administrator. Examine other generated signals for the user to further investigation activities."
"Okta","","MATCH-S00905","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1098.001, _mitreAttackTechnique:T1098.003","Okta - Programmatic Access to Users API Endpoint","This signal looks for programmatic (PowerShell, Golang, Python or Curl) access to the Okta â€œusersâ€ API endpoint. This endpoint provides functionality to perform various actions on Okta user accounts such as password resets and account unlocks. A full list of functionality for this endpoint can be found in the Okta documentation here: https://developer.okta.com/docs/reference/api/users/- The â€œSuccessâ€ field will indicate whether this API request was successful or not and the â€œDescriptionâ€ field will contain the event that was generated by the API request. Both failed and successful requests should be investigated. Ensure that this request was performed for legitimate purposes such as developer workflows or other automation mechanisms. Consider adding a match list exclusion with authorized accounts who perform requests to this Okta API endpoint via programmatic methods if this signal is triggering false positives."
"","","AGGREGATION-S00008","aggregation","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1078.004","Okta - Session Anomaly (Multiple ASNs)","This rule detects when a user has utilized multiple distinct ASNs when performing authentication through Okta. This activity could potentially indicate credential theft or a general session anomaly. Examine other Okta related events surrounding the time period for this signal, pivoting off the username value to examine if any other suspicious activity has taken place. If this rule is generating false positives, adjust the threshold value and consider excluding certain user accounts via tuning expression."
"","","AGGREGATION-S00007","aggregation","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1078.004","Okta - Session Anomaly (Multiple Operating Systems)","This rule detects when a user has utilized multiple distinct operating systems when performing authentication through Okta. This activity could potentially indicate credential theft or a general session anomaly. Examine other Okta related events surrounding the time period for this signal, pivoting off the username value to examine if any other suspicious activity has taken place. If this rule is generating false positives, adjust the threshold value and consider excluding certain user accounts via tuning expression or a match list."
"","","AGGREGATION-S00009","aggregation","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1078.004","Okta - Session Anomaly (Multiple User Agents)","This rule detects when a user has utilized multiple distinct User Agents when performing authentication through Okta. This activity could potentially indicate credential theft or a general session anomaly. Examine other Okta related events surrounding the time period for this signal, pivoting off the username value to examine if any other suspicious activity has taken place. If this rule is generating false positives, adjust the threshold value and consider excluding certain user accounts via tuning expression."
"Okta","","MATCH-S00635","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004, _mitreAttackTactic:TA0003, _mitreAttackTechnique:T1136, _mitreAttackTechnique:T1136.003, _mitreAttackTechnique:T1552.005, _mitreAttackTechnique:T1552","Okta API Token Created","Detect when a new Okta API token is created."
"Okta","","MATCH-S00433","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004","Okta Account Lockout","Observes for Okta user account lock out events"
"Okta","","MATCH-S00769","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1114.002, _mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098","Okta Account Primary Email Address Update","An Okta accounts primary email address has been updated. An adversary may modify an Okta accounts email address to evade detection by users or to gather information about the organization and establish persistence through credential resets."
"Okta","","MATCH-S00634","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1552.005, _mitreAttackTechnique:T1552","Okta Admin App Access Attempt Failed","Detects failed access attempts to the Okta admin app. This is where policies are set, users are managed, and apps are controlled."
"Okta","","MATCH-S00633","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1552.005, _mitreAttackTechnique:T1552","Okta Admin App Accessed","Detects access to the Okta admin app. This is where policies are set, users are managed, and apps are controlled. The match list Okta_Admins should be populated with users authorized to access the Okta admin app."
"Okta","","MATCH-S00632","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004, _mitreAttackTactic:TA0003, _mitreAttackTechnique:T1136, _mitreAttackTechnique:T1136.003, _mitreAttackTechnique:T1552.005, _mitreAttackTechnique:T1552","Okta Administrator Access Granted","Detects Okta administrator access being granted. This is where policies are set, users are managed, and apps are controlled."
"Okta","","MATCH-S00765","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098","Okta Credential Access User Impersonation","A session impersonation access event has occurred. This most likely indicates Okta support or administrative access has occurred and should be reviewed and verified."
"Okta","","MATCH-S00768","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1111","Okta MFA Bypass Attempt","Attempts to bypass MFA can be indicative of malicious actors having compromised the password for an account but not the corresponding MFA token and such attempts should be audited for legitimacy."
"Okta","","MATCH-S00766","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1111","Okta MFA Deactivated for User","This rule detects multi-factor authentication (MFA) being disabled for a user. An adversary or malicious insider may deactivate MFA in order to bypass security controls. The Okta_Admins match list should be created and populated with administrator users permitted to perform this activity."
"Okta","","MATCH-S00767","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1111","Okta MFA Device Reset","An accounts multi-factor authentication (MFA) device has been reset. This can indicate an attacker attempting to bypass or intercept MFA for an account which they have already compromised."
"","","MATCH-S00908","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1078.004","Okta - MFA Request Denied by User","This signal will trigger when a user denies an MFA request within the Okta authenticator application. Examine other authentication attempts for this particular user and undertake confirmation efforts to ensure that  this activity is expected and valid."
"Okta","","MATCH-S00636","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1552.005, _mitreAttackTechnique:T1552","Okta User Attempted to Access Unauthorized App","Detect when an Okta user is denied access to an app."
"OneLogin","","MATCH-S00605","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1106, _mitreAttackTechnique:T1552.005, _mitreAttackTechnique:T1552","OneLogin - API Credentials - New Key Created","Detects creation of API Keys. API Keys should be closely monitored to prevent unauthorized access."
"OneLogin","","MATCH-S00609","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1111","OneLogin - Login Failed - MFA Unsuccessful","Detects the failure to authenticate due to a bad one time passcode (OTP)."
"","","MATCH-S00556","templated_match","Exfiltration","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1571","Outbound Data Transfer Protocol Over Non-standard Port","This rule detects commonly used data transfer protocols being used over non-standard ports, which could indicate an attempt to obfuscate exfiltration or command and control activity."
"","","MATCH-S00554","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Outbound IRC Traffic","This rule detects outbound traffic over IRC, which could indicate a compromised host being used for command and control or exfiltration operations."
"","","LEGACY-S00056","match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.002","Outbound TFTP Traffic","TFTP is rarely used externally and has been observed as a means to deliver malicious code from the outside."
"","","THRESHOLD-S00048","threshold","Unknown/Other","False","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Outbound Traffic to Countries Outside the United States","Traffic was observed leaving your network destined to some countries outside the United States within a time frame. This rule is shipped disabled by default as is intended for environments based in the United States with very tight network restriction policies. "
"","","OUTLIER-S00019","outlier","Discovery","True","False","","_mitreAttackTechnique:T1526, _mitreAttackTactic:TA0007","Outlier in AWS Bedrock API Calls from User","An outlier in the number of API calls made to AWS Bedrock from a user within an hour time period was observed. These events may be part of normal Bedrock operations or may be indicative of enumeration/discovery attempts. Observe the username, role, user agent and source IP to confirm whether this activity is expected. If this signal is triggering frequently, consider excluding certain authorized users via tuning expression."
"","","OUTLIER-S00022","outlier","Discovery","True","False","","_mitreAttackTechnique:T1526, _mitreAttackTactic:TA0007","Outlier in AWS Bedrock Foundation Model Enumeration Calls from User ","An outlier in the number of Foundation Model Enumeration API Calls from a user within an hour time period was observed. These events may be part of normal Bedrock operations or may be indicative of enumeration/discovery attempts. Observe the username, role, user agent and source IP to confirm whether this activity is expected. If this signal is triggering frequently, consider excluding certain authorized users via tuning expression."
"","","OUTLIER-S00013","outlier","Exfiltration","True","False","","_mitreAttackTechnique:T1030, _mitreAttackTechnique:T1071, _mitreAttackTactic:TA0010, _mitreAttackTactic:TA0011","Outlier in Data Outbound Per Day by Admin or Sensitive Device","A larger than typical amount of data has been observed being sent outbound from a Sensitive Device or an Admin user. It is recommended to investigate the device associated with this IP, the Internet destinations and traffic associated with this anomalous behavior. A normalized record search for the source IP and external network traffic, within the period of time of the detection will help identify suspicious activity. This rule is dependent on the Match Lists ""domain_controllers"" and ""admin_usernames"" being populated with the sensitive device IPs and admin usernames. Additionally, Entity Tagging offers a similar and extensible alternative to Match Lists. To add more sensitive Match Lists, or Entity Tagging, please use Rule Tuning Expressions. For further customization, consider adjusting the severity of this rule and/or using entity severity as needed to increase the severity of this rule."
"","","OUTLIER-S00015","outlier","Exfiltration","True","False","","_mitreAttackTechnique:T1030, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1567, _mitreAttackTactic:TA0010, _mitreAttackTactic:TA0011","Outlier in Data Outbound Per Hour by Admin or Sensitive Device","A larger than typical amount of data has been observed being sent outbound from a Sensitive Device or an Admin user. It is recommended to investigate the device associated with this IP, the Internet destinations and traffic associated with this anomalous behavior. A normalized record search for the source IP and external network traffic, within the period of time of the detection will help identify suspicious activity. This rule is dependent on the Match Lists ""domain_controllers"" and ""admin_usernames"" being populated with the sensitive device IPs and admin usernames. Additionally, Entity Tagging offers a similar and extensible alternative to Match Lists. To add more sensitive Match Lists, or Entity Tagging, please use Rule Tuning Expressions. For further customization, consider adjusting the severity of this rule and/or using entity severity as needed to increase the severity of this rule."
"","","OUTLIER-S00032","outlier","Exfiltration","False","False","","_mitreAttackTactic:TA0010, _mitreAttackTechnique:T1567.002","Outlier in Data Transferred from an S3 Bucket by User","[Disabled by Default] This rule detects an unusual amount of data transferred outbound from an S3 bucket (requires AWS Data events are required). Verify if the user, role and IP address associated with this activity are authorized. This rule is disabled by default due to potential signal volume. Before enabling, consider excluding authorized users with regular large transfers via match lists, and adjust floor value and model sensitivity as needed."
"","","OUTLIER-S00031","outlier","Exfiltration","False","False","","_mitreAttackTactic:TA0010, _mitreAttackTechnique:T1567.002","Outlier in Data Transferred into an S3 Bucket by User","[Disabled by Default] Detects unusual amounts of inbound data transfers to S3 buckets (requires AWS Data events). Verify if the user, role, and IP address associated with this activity are authorized. This rule is disabled by default due to potential alert volume. Before enabling, consider excluding authorized users with regular large transfers via match lists, and adjust floor value and model sensitivity as needed."
"","","MATCH-S00755","templated_match","Persistence","True","True","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1137, _mitreAttackTechnique:T1137.003","Outlook Form Creation","Detects Outlook Form creation.  Outlook forms can be used to execute code on a compromised machine and establish persistence."
"","","MATCH-S00756","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1137, _mitreAttackTechnique:T1137.004","Outlook Homepage Modification","Detects modifications to the Microsoft Outlook Homepage. Outlook Homepage is a legacy feature that can be leveraged by an adversary to insert malicious code and establish persistence."
"","","MATCH-S00900","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1649","Overly-Permissive Active Directory Certificate Template Loaded","This alert looks at Active Directory Certificate Services Auditing Events to look for a certificate template issued that allows domain users full control over the certificate in addition to allowing an ""Any Purpose"" Certificate Application Policy. Specifically, this misconfiguration can exploit the ""ESC1"" attack path via https://posts.specterops.io/certified-pre-owned-d95910965cd2. This combination allows a threat actor to turn a certificate obtained from a vulnerable template into a Kerberos Ticket Granting Ticket (TGT) which could enable privilege escalation paths."
"","","MATCH-S00683","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1222, _mitreAttackTechnique:T1222.002, _mitreAttackTechnique:T1548, _mitreAttackTechnique:T1548.001","Overly Permissive Chmod Command","Setting a file's permissions to '777' with the chmod command allows all users to read, write, and execute said file, presenting an avenue for exploitation and privilege escalation on the host."
"Microsoft","","MATCH-S00890","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098.001","Owner Added to Azure Service Principal","An owner was added to an Azure service principal - threat actors may add owners to Azure service principals for privilege escalation or persistence avenues. Ensure this action is expected and approved."
"","","MATCH-S00698","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1574, _mitreAttackTechnique:T1574.007","PATH Set to Current Directory","The PATH environment variable should always be set to an absolute directory pathing. Referencing the current directory is considered bad practice as it can lead to unintentional file execution or malicious abuse, as with CVE-2021-4034 (pkexec privilege escalation)."
"","","LEGACY-S00057","match","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.002, _mitreAttackTechnique:T1021.006","PsExec Admin Tool Detection","Detects PSEXESVC.EXE being written to remote computer via SMB/CIFS. This is a service executable that is copied in place and started when a remote client connects to a host with PsExec."
"Microsoft","Windows","MATCH-S00610","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.002, _mitreAttackTechnique:T1021.006","PSExec Named Pipe Created by Non-PsExec Process","Observes for creation of a PSExec named pipe not by PSExec. This may be an indication of a malicious process coopting a privileged named pipe used by PSExec."
"","","MATCH-S00465","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1018","PXELoot Utility","From FireEye Red Team Tool Countermeasures:
PXELoot (PAL) is a C# tool designed to aid in the discovery and exploitation of misconfigurations in Windows Deployment Services (WDS)."
"","Docker","MATCH-S00659","templated_match","Execution","True","False","","_mitreAttackTechnique:T1609, _mitreAttackTactic:TA0002","Package Management Utility in Container","Package management utilities should be considered anomalous when used inside containers as containers should be provisioned with the correct tools for the task assigned to them at the image level."
"Microsoft","Azure","THRESHOLD-S00095","threshold","Initial Access","True","False","Authentication","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1110, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1586, _mitreAttackTechnique:T1586.001, _mitreAttackTechnique:T1586.002, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1110.003, _mitreAttackTechnique:T1110.002, _mitreAttackTechnique:T1110.001","Password Attack from Host","Detects multiple failed login attempts from a single source with unique usernames over a 24 hour timeframe. This is designed to catch both slow and quick password spray type attacks. The threshold and time frame can be adjusted based on the customer's environment."
"Microsoft","Azure","THRESHOLD-S00116","threshold","Initial Access","True","False","Authentication","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1110, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1586, _mitreAttackTechnique:T1586.001, _mitreAttackTechnique:T1586.002, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1110.003, _mitreAttackTechnique:T1110.002, _mitreAttackTechnique:T1110.001","Password Attack from IP","Detects multiple failed login attempts from a single source with unique usernames over a 24 hour timeframe. This is designed to catch both slow and quick password spray type attacks. The threshold and time frame can be adjusted based on the customer's environment."
"","","LEGACY-S00058","match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1102, _mitreAttackTechnique:T1102.002, _mitreAttackTechnique:T1102.003","Pastebin Raw URL Resource Request","Attackers will often host malicious code on pastebin.com and attempt to download their additional payloads if their initial attack is successful. They will download the post with the raw URI. Generally the malicious content hosted on Pastebin.com is quickly removed automatically by the poster setting an expire time."
"Microsoft","Windows","MATCH-S00704","templated_match","Persistence","True","True","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1112, _mitreAttackTechnique:T1547, _mitreAttackTechnique:T1547.001","Persistence Registry Key Modification","This rule detects modifications to registry keys commonly targeted to achieve persistence."
"","","THRESHOLD-S00520","threshold","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1569, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1569.002, _mitreAttackTechnique:T1204.002, _mitreAttackTechnique:T1204.003","Persistent Malware Infection","Single host with multiple malware infections with the same signature in a short timeframe."
"","","MATCH-S00697","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1068","Pkexec Privilege Escalation - CVE-2021-4034","Monitors for audit message and command line parameters that indicate attempted exploitation of pkexec vulnerability CVE-2021-4034."
"","","MATCH-S00887","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1572","Port Forwarding Enabled via Visual Studio Code","A local port has been forwarded and made available for external connectivity utilizing the Visual Studio Code port forwarding feature. Ensure that this activity is expected and approved, as it may be used by developers for legitimate purposes. This activity could potentially circumvent existing egress/ingress controls by exposing local services to the internet. Look for other events around this time frame in order to ascertain the purpose for the port forwarding activities. If tuning of the rule is required, create a list that contains developers who utilize this functionality and exclude it from the expression."
"","Bro","LEGACY-S00059","match","Discovery","True","False","","_mitreAttackTactic:TA0043, _mitreAttackTechnique:T1595, _mitreAttackTechnique:T1046, _mitreAttackTechnique:T1595.001","Port Scan - External","External port scan. A host external to the monitored network was detected as showing behavior consistent with a scan for a port on multiple destination addresses in a short time."
"","Bro","LEGACY-S00060","match","Discovery","True","False","","_mitreAttackTactic:TA0043, _mitreAttackTechnique:T1595, _mitreAttackTechnique:T1046, _mitreAttackTechnique:T1595.001","Port Scan - Internal","Internal port scan. A host on the monitored network was detected as showing behavior consistent with a scan for a port on multiple destination addresses in a short time."
"","","THRESHOLD-S00026","threshold","Credential Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0006, _mitreAttackTactic:TA0042, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1586, _mitreAttackTechnique:T1586.001, _mitreAttackTechnique:T1586.002","Possible Credential Abuse","This signal logic is designed to catch repetitive attempts to call (and presumably attempt to auth via) login pages for drupal, wordpress, and jira."
"","","LEGACY-S00061","match","Exfiltration","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTechnique:T1048, _mitreAttackTechnique:T1048.003","Possible DNS Data Exfiltration","Some families of malware use data nested within the subdomain portion of a DNS query as a means of data exfiltration. This can be identified by looking for DNS queries where the full query is substantially longer than the top-level domain (e.g., ooo.nu6tgnzvgm2tmmbzgq4a.rkgotw5.5z5i6fjnugmxfowy.beevish.com is substantially longer than beevish.com). This technique is described in https://attack.mitre.org/techniques/T1001/."
"","","LEGACY-S00008","match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1568, _mitreAttackTechnique:T1568.001, _mitreAttackTechnique:T1568.002, _mitreAttackTechnique:T1568.003","Possible Dynamic DNS Domain","This rule looks for DNS query/reply domains which appear to be associated with a dynamic DNS service."
"","","MATCH-S00835","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1568, _mitreAttackTechnique:T1568.001, _mitreAttackTechnique:T1568.002, _mitreAttackTechnique:T1568.003","Possible Dynamic URL Domain","This rule looks for URL/refferer domains which appear to be associated with a dynamic DNS service."
"","","MATCH-S00637","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Possible Malicious Download","This rule triggers any time there is potentially a download from a suspicious categorized site."
"","","MATCH-S00451","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1072","Possible Malicious Nirsoft Tool Usage","Detects command line parameters common with Nirsoft tools."
"","","THRESHOLD-S00028","threshold","Exfiltration","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1090, _mitreAttackTechnique:T1090.002, _mitreAttackTechnique:T1573, _mitreAttackTechnique:T1573.001","Possible TOR Connection","The subject and issuer of the SSL certificate match the pattern for certificates used by TOR connections."
"Amazon AWS","","MATCH-S00876","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1078.004","Potential AWS Security Credential Access via curl","A curl command being issued to access sensitive AWS actions related to AWS Secret Manager, System Manager, Lambda Functions or RDS should be uncommon and could be an indication of unexpected credential access. Especially if no authorized uses of curl is used to manage AWS systems."
"","","CHAIN-S00019","chain","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1649","Potential Active Directory Certificate Services Enrollment Agent Misconfiguration","This alert looks for two events in a particular order, the first event involves a certificate template being loaded with a certificate request agent application policy. The second event involves the same event type, but with a client authentication application policy. Together, these events may indicate exploitation of an â€œenrollment agentâ€ misconfiguration. Threat actors may abuse this misconfiguration to forge certificates and Kerberos Ticket Granting Tickets (TGT). Specifically, this misconfiguration can exploit the ""ESC3"" attack path via https://posts.specterops.io/certified-pre-owned-d95910965cd2. If this event is deemed suspicious, look for authentication events (4624) that utilize this certificate template. Also ensure that this change was expected and approved within the environment."
"Microsoft","","CHAIN-S00012","chain","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1078, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078.004","Potential Azure Persistence via Automation Accounts","Azure automation accounts are normally used for automation of various tasks, however, they can also be abused to create Azure Active Directory accounts for threat actor persistence."
"Microsoft","Windows","MATCH-S00459","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1029, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001, _mitreAttackTechnique:T1567, _mitreAttackTechnique:T1567.001, _mitreAttackTechnique:T1567.002","Potential Cobalt Strike Profile","From FireEye Red Team Tool Countermeasures: This IOC detects indicators associated with cobalt strike beacon network activity."
"","","MATCH-S00865","templated_match","Unknown/Other","True","False","","","Potential Docker Escape via Command Line","This rule looks for whether the raw Docker socket was used for container creation as well as a bind mount of /hostfs which could facilitate a container escape and allow command execuiton on the Docker host."
"","","CHAIN-S00014","chain","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1611","Potential Docker container escape via Cgroups","A Docker container running with the privileged flag may be exploited by threat actors, potentially resulting in an escape from the Docker container to the host that it is running on. This can result in various privilege escalation opportunities."
"","","MATCH-S00558","templated_match","Unknown/Other","False","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.005","Potential Inbound VNC Traffic","Observes for successful TCP traffic to default VNC ports or explicit VNC/RFB traffic detected"
"","","CHAIN-S00011","chain","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.004","Potential InstallUtil Allow List Bypass","This rule looks for a suspicious InstallUtil command line followed by an observed outgoing network connection from the InstallUtil process, indicating potentially malicious use of the InstallUtil binary."
"","","MATCH-S00822","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1555.003, _mitreAttackTechnique:T1003","Potential Microsoft Office In-Memory Token Theft","Office applications and Web Browsers connecting to Office services can potentially store credential material in their memory space. This event indicates that a process has accessed the memory space of an Office process that may potentially contain token material."
"","","MATCH-S00753","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1137, _mitreAttackTechnique:T1137.001","Potential Microsoft Office Template Abuse","Detects modifications to files and registry entries related to Microsoft Office Template Macros. These can be abused by an adversary to gain persistence."
"Microsoft","Windows","MATCH-S00200","templated_match","Lateral Movement","False","False","Authentication","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1550, _mitreAttackTechnique:T1550.002","Potential Pass the Hash Activity","The behavior discovered here loosely matches the behavior of known pass the hash tools.  A Pass the Hash (PtH) attack is a way for an attacker to move laterally through a type of credential theft.  Because this behavior is known to occur in some environments during normal activity, tuning is recommended and attention paid to a possible spike in signals after enabling this rule."
"","","MATCH-S00546","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.001, _mitreAttackTechnique:T1562.002, _mitreAttackTechnique:T1562.004, _mitreAttackTechnique:T1562.006","Potential Reconnaissance Obfuscation","From Solorigate TTPs: Firewall rules were added via command line to reduce noise from subsequent reconnaissance using NSLOOKUP and ADFIND."
"","","MATCH-S00824","templated_match","Impact","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1496","Potential XMRig Execution with Traffic","Adversaries may leverage the resources of co-opted systems in order to solve resource intensive problems, which may impact system and/or hosted service availability."
"","Bro","LEGACY-S00062","match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0002, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1204.002","Potential malicious JVM download","A document was downloaded and opened followed by a file download using a Java user-agent."
"","Bro","LEGACY-S00063","match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1204.002","Potential malicious document executed","A document was downloaded and opened followed shortly by an executable or dll download shortly thereafter"
"","","MATCH-S00898","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1649","Potentially Misconfigured Active Directory Certificate Template Loaded","This alert looks at Active Directory Certificate Services Auditing Events to look for a certificate template issued that allows all domain users the ability to enroll the template. Combined with other misconfigurations within a certificate template, this can potentially allow a threat actor to turn a certificate obtained from such a vulnerable template into a Kerberos Ticket Granting Ticket (TGT) which could enable privilege escalation paths."
"","","MATCH-S00901","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1649","Potentially Vulnerable Active Directory Certificate Services Template Loaded","This alert looks at Active Directory Certificate Services Auditing Events to look for a certificate template issued that allows the enrolee to supply a subject and allows all domain users to enroll. This combination allows a threat actor to turn a certificate obtained from a vulnerable template into a Kerberos Ticket Granting Ticket (TGT) which could enable privilege escalation paths. Specifically, this misconfiguration can exploit the ""ESC1"" attack path via https://posts.specterops.io/certified-pre-owned-d95910965cd2."
"","Bro","LEGACY-S00064","match","Execution","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0002, _mitreAttackTactic:TA0042, _mitreAttackTechnique:T1190","Potentially vulnerable software detected","The software version has a known vulnerability"
"","","LEGACY-S00065","match","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.001, _mitreAttackTechnique:T1059.003, _mitreAttackTechnique:T1021.006, _mitreAttackTechnique:T1021.002","PowerShell via SMB","PowerShell being accessed via SMB should never occur in a Windows environment, and indicates malicious activity."
"","","MATCH-S00136","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.001, _mitreAttackTechnique:T1059.003, _mitreAttackTechnique:T1132, _mitreAttackTechnique:T1132.001, _mitreAttackTechnique:T1132.002, _mitreAttackTechnique:T1140","PowerShell Encoded Command","PowerShell can execute encoded Base64 strings with the Encoded Command cmdlet. Attackers will often use Base64 to obfuscate their payloads until they can decode and execute it with PowerShell."
"","","MATCH-S00149","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1105, _mitreAttackTechnique:T1059.001, _mitreAttackTechnique:T1059.003","PowerShell File Download","PowerShell scripts are commonly used as droppers, which will download additional tools onto a compromised host."
"","Bro","LEGACY-S00066","match","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.006, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.001, _mitreAttackTechnique:T1059.003","PowerShell Remote Administration","Remote Administration from Powershell is logged by default in the admin$temp  folder.  These commands should only be associated with IP addresses that are expected to carry out remote administration tasks."
"Microsoft","Windows","MATCH-S00425","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.011, _mitreAttackTechnique:T1021.006, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.001, _mitreAttackTechnique:T1059.003","PowerShell Rundll32 Remote Thread Creation","Detects PowerShell remote thread creation in Rundll32.exe."
"","","MATCH-S00449","templated_match","Execution","False","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.001, _mitreAttackTechnique:T1059.003","Powershell Execution Policy Bypass","Observes for parameters used to bypass the Powershell execution policy

Requires command line auditing or Sysmon to function

It is recommended to tune this rule to hosts/users that are not ordinarily bypassing Powershell execution policy."
"Microsoft","Windows","MATCH-S00580","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.001, _mitreAttackTechnique:T1059.003, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.006","Powerview Add-DomainObjectAcl DCSync AD Extend Right","Backdooring domain object to grant the rights associated with DCSync to a regular user or machine account using Powerview\Add-DomainObjectAcl DCSync Extended Right cmdlet, will allow to re-obtain the pwd hashes of any user/computer"
"","","MATCH-S00866","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1611","Privileged Pod Created on AWS EKS","Privileged containers have all capabilities of the host machine. These privileged containers may perform actions directly on the host that they are running on. Ensure that this event is expected and occurs from a user account or IP address that normally works with privileged containers within the cluster. Customers are encouraged to set up an exclusion list for spec.securitycontext.capabilities for pods that are frequently going to be managed with privileged escalation."
"","","MATCH-S00427","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001","Process Dump via Rundll32 and Comsvcs.dll","Detects a process memory dump performed via ordinal function 24 in comsvcs.dll."
"","","MATCH-S00187","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0002, _mitreAttackTechnique:T1190, _mitreAttackTechnique:T1203","Process Execution Inside Webserver Root Folder","A process was executed from inside a web hosting directory. This signal could indicate when adversaries upload a malicious file to the webserver and run the file as a process. Approved web applications that require process execution from inside the web hosting directory should be excluded from the rule and filtered out."
"","","MATCH-S00691","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.010, _mitreAttackTechnique:T1218.011, _mitreAttackTechnique:T1059.003","Productivity App Spawning Rundll32 or Regsvr32","Detects productivity applications spawning regsvr32 or rundll32. This activity has been attributed to the Qbot and Bazar trojans."
"Proofpoint","Proofpoint on Demand","MATCH-S00694","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Proofpoint POD Suspicious Email","Detects emails with a spam score greater than 50 using Proofpoint POD."
"Proofpoint","Targeted Attack Protection","MATCH-S00078","templated_match","Initial Access","False","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Proofpoint TAP - IP Sent Email with Malware","Proofpoint TAP detected an IP address sending an email with a malware score 75 or higher. Records indicating the email was permitted will have a higher signal score compared to those automatically blocked by Proofpoint."
"Proofpoint","Targeted Attack Protection","MATCH-S00079","templated_match","Initial Access","False","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Proofpoint TAP - IP Sent Email with Malware Link","Proofpoint TAP detected a user clicking on a link containing malware in an email sent from an IP address. This rule only includes messages where Proofpoint considers the malware link still active. Records indicating the link was permitted will have a higher signal score compared to those automatically blocked by Proofpoint."
"Proofpoint","Targeted Attack Protection","MATCH-S00080","templated_match","Initial Access","False","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Proofpoint TAP - IP Sent Email with Phishing Link","Proofpoint TAP detected a user clicking on a phishing link in an email sent from an IP address. This rule only includes messages where Proofpoint considers the phishing link still active. Records indicating the link was permitted will have a higher signal score compared to those automatically blocked by Proofpoint."
"Proofpoint","Targeted Attack Protection","MATCH-S00081","templated_match","Initial Access","False","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Proofpoint TAP - IP Sent Impostor Email","Proofpoint TAP detected an IP address sending an email with an impostor score 75 or higher. Records indicating the email was permitted will have a higher signal score compared to those automatically blocked by Proofpoint."
"Proofpoint","Targeted Attack Protection","MATCH-S00082","templated_match","Initial Access","False","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Proofpoint TAP - IP Sent Phishing Email","Proofpoint TAP detected an IP address sending an email with a phishing score 75 or higher. Records indicating the email was permitted will have a higher signal score compared to those automatically blocked by Proofpoint."
"Proofpoint","Targeted Attack Protection","MATCH-S00084","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Proofpoint TAP - User Clicked Malware Link in Email","Proofpoint TAP detected a user clicking on a malware link in an email. This rule only includes messages where Proofpoint considers the malware link still active. Records indicating the link was permitted will have a higher signal score compared to those automatically blocked by Proofpoint."
"Proofpoint","Targeted Attack Protection","MATCH-S00085","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Proofpoint TAP - User Clicked Phishing Link in Email","Proofpoint TAP detected a user clicking on a phishing link in an email. This rule only includes messages where Proofpoint considers the phishing link still active. Records indicating the link was permitted will have a higher signal score compared to those automatically blocked by Proofpoint."
"Proofpoint","Targeted Attack Protection","MATCH-S00083","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Proofpoint TAP - User Received Email with Malware","Proofpoint TAP detected a user receiving an email with a malware score 75 or higher. Records indicating the email was permitted will have a higher signal score compared to those automatically blocked by Proofpoint."
"Proofpoint","Targeted Attack Protection","MATCH-S00086","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Proofpoint TAP - User Received Impostor Email","Proofpoint TAP detected a user receiving an email with an impostor score 75 or higher. Records indicating the email was permitted will have a higher signal score compared to those automatically blocked by Proofpoint."
"Proofpoint","Targeted Attack Protection","MATCH-S00087","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Proofpoint TAP - User Received Phishing Email","Proofpoint TAP detected a user receiving an email with a phishing score 75 or higher. Records indicating the email was permitted will have a higher signal score compared to those automatically blocked by Proofpoint."
"","","MATCH-S00439","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1113","Psr.exe Capture Screenshots","The psr.exe captures desktop screenshots and saves them on the local machine."
"","","MATCH-S00584","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001, _mitreAttackTechnique:T1003","Pwndrp Access","Observes for possible attempts to download PwnDrp red team tooling"
"","","MATCH-S00575","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003, _mitreAttackTechnique:T1543, _mitreAttackTechnique:T1543.003","QBot Process Creation","Observes for Qbot process creation behavior"
"","","MATCH-S00265","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.002, _mitreAttackTechnique:T1003.005","QuarksPwDump Dump File Observed","Signal identifies the observance of a filename consistent with QuarksPwDump file password dumper."
"","","MATCH-S00751","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1037, _mitreAttackTechnique:T1037.004","Unix/Linux RC Script Modification","Detects modifications to RC Script files. These scripts are executed on system startup and may be used by an adversary to establish persistence."
"","","LEGACY-S00067","match","Lateral Movement","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1021.001, _mitreAttackTechnique:T1021","Administrator Login via RDP","This rule looks for successful logins over RDP for administrator accounts."
"","","THRESHOLD-S00031","threshold","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1110, _mitreAttackTechnique:T1110.001, _mitreAttackTechnique:T1110.002, _mitreAttackTechnique:T1110.003, _mitreAttackTechnique:T1110.004, _mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1021.001, _mitreAttackTechnique:T1021","RDP Brute Force Attempt","An attacker is making a brute force attempt to gain access to an RDP server."
"","","CHAIN-S00024","chain","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1110.001, _mitreAttackTechnique:T1110","RDP Brute Force Login Attempt","Detection:
This rule correlates a high number of failed authentication attempts with repeated inbound connections over port 3389 (the default RDP port).

Scenario:
An adversary may attempt to discover an account password by using brute force tools against hosts that allow Remote Desktop Protocol (RDP) connections.

Recommended Actions:
Review the destination host and consider whether blocking RDP connections to it from the Internet is appropriate. Review the source IP addresses of the brute force activity and consider blocking it at the firewall. Review the account names that are being used in the brute force attacks and consider forcing password resets for the accounts.

Tuning Recommendations: 
Add the IP addresses of your vulnerability scanners to the ""vuln_scanners"" list. 
Note that this rule is more likely to trigger when the destination host is a multi-user Terminal Server or if more than one user connects to the host from the same IP address (such as via NAT). Increase the record count that trigger this rule if necessary."
"","","CHAIN-S00023","chain","Unknown/Other","True","False","","_mitreAttackTechnique:T1078","Administrative Remote Interactive Brute Force Login","Detection:
This rule correlates a high number of failed authentication attempts with  a successful remote interactive login (such as via RDP) coming from the same source IP address and user account. 

Context:
An adversary may discover an account password by using brute force tools against hosts that allow Remote Desktop Protocol (RDP) connections. Upon discovering the correct password the attacker proceeds to log in via RDP.

Recommended Actions:
Determine whether this activity was benign, ideally by contacting the user. If the activity is determined to be malicious, log out all sessions from the compromised account and force a password reset. Investigate the activities of the user account originating from the RDP host to look for signs of persistence and lateral movement. Consider taking the RDP host offline for investigation. Block all connections from the source host.

Tuning Recommendations: 
Add the IP addresses of your vulnerability scanners to the ""vuln_scanners"" list. Adjust the record counts that trigger this rule if necessary."
"","","LEGACY-S00068","match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1110, _mitreAttackTechnique:T1110.001, _mitreAttackTechnique:T1110.002, _mitreAttackTechnique:T1110.003, _mitreAttackTechnique:T1110.004, _mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1021.001, _mitreAttackTechnique:T1021","RDP Brute Force - Success","Hydra and Ncrack are popular tools for attempting brute force attacks to access a targeted system. In this case, a brute force attempt against an RDP server has succeeded and the attacker has gained access to the targeted system."
"","","LEGACY-S00069","match","Execution","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1021.001, _mitreAttackTechnique:T1021, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1219","RDP Error Messages","When setting up an RDP connection, there are a number of  negotiation steps that happen.  If a connection is enrypted, not all of these can be analyzed.  Errors can indicate an operational issue or potential exploitation of a vulnerability in negotiation."
"","","MATCH-S00176","templated_match","Lateral Movement","True","False","Authentication","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1021.001, _mitreAttackTechnique:T1021","RDP Login from Localhost","RDP login with a localhost source address may indicate a tunneled login and an attacker attempting to move through the environment."
"","","MATCH-S00502","templated_match","Lateral Movement","False","False","","_mitreAttackTactic:TA0008, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1219, _mitreAttackTechnique:T1021.001, _mitreAttackTechnique:T1021","RDP Traffic to Unexpected Host","Observes for RDP traffic to hosts not within an allow list.

Note that this rule requires the creation and population of a match list for known OK hosts named 'RDP_Hosts'"
"","","LEGACY-S00071","match","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1219, _mitreAttackTechnique:T1021.001, _mitreAttackTechnique:T1021","RDP with non-standard client","While the product_id of the RDP client is not required, a missing one or one that does not look like a client access license can indicate an RDP attack with hacker software (ie NCRACK, hydra)."
"Microsoft","Windows","MATCH-S00545","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1112, _mitreAttackTechnique:T1546, _mitreAttackTechnique:T1546.011","Registry Keys For Creating Shim Databases","This rule looks for registry activity associated with application compatibility shims, which can be leveraged by attackers for various nefarious purposes."
"","","MATCH-S00747","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1547.014","Registry Modification - Active Setup","Detects modifications to the active setup registry key. Active setup can be used to execute programs at user login."
"","","MATCH-S00705","templated_match","Persistence","True","False","","_mitreAttackTechnique:T1547.002, _mitreAttackTactic:TA0003, _mitreAttackTechnique:T1547, _mitreAttackTechnique:T1556.002","Registry Modification - Authentication Package","Malicious authentication packages can be added via the Windows Registry. This rule requires registry monitoring to be setup on the endpoint."
"Microsoft","Windows","MATCH-S00730","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1553.006","Registry Modification - Code Signing","The Driver Signature Enforcement functionality in Windows ensures that only approved, unaltered programs are able to run on a system. Modifications to this policy can indicate an attempt to bypass these built-in protections. Tuning for this rule may be required for developer machines as code signing protections often interfere with the software development process."
"","","MATCH-S00754","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1137, _mitreAttackTechnique:T1137.002","Registry Modification - Microsoft Office Test Function Registry Entry","Observes for modifications to the Microsoft Office Test registry key. This key allows for an arbitrary DLL to be executed on Office launch. This can be used by an adversary to establish persistence."
"","","MATCH-S00733","templated_match","Persistence","True","False","","_mitreAttackTechnique:T1547, _mitreAttackTactic:TA0003, _mitreAttackTechnique:T1547.012","Registry Modification - Print Processors","Observes for modifications to registry entries defining print processors for the print spooler service. The print spooler runs with  system level permissions and this technique can be used to establish persistence."
"Microsoft","Windows","MATCH-S00735","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1553.003","Registry Modification - SIP or Trust Provider","Trust Providers and Subject Interface Packages (SIPs) can be modified via the Windows Registry to allow attackers to execute malicious code with heightened permissions and less oversight. This rule monitors for changes to several Registry keys containing values that modify these settings."
"","","MATCH-S00722","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1547, _mitreAttackTechnique:T1547.005","Registry Modification - Security Support Provider","Malicious Security Support Providers can be added via the Windows Registry. This rule requires registry monitoring to be setup on the endpoint."
"","","MATCH-S00706","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1547, _mitreAttackTechnique:T1547.003","Registry Modification - Time Providers","Malicious time providers can be added via the Windows Registry. This rule requires registry monitoring to be setup on the endpoint."
"","","MATCH-S00749","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1037, _mitreAttackTechnique:T1037.001","Registry Modification - Windows Logon Script","Logon scripts are executed on user logon and can be used to establish persistence. This detection requires registry monitoring."
"","","MATCH-S00707","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1547, _mitreAttackTechnique:T1547.004, _mitreAttackTechnique:T1129","Registry Modification - Winlogon Helper DLL","Malicious Winlogon Helper Dlls can be added via the Windows Registry. This rule requires registry monitoring to be setup on the endpoint."
"Microsoft","Windows","MATCH-S00569","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1112","Registry Persistence Mechanisms","Observes for registry keys associated with persistence activity"
"","","MATCH-S00689","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.010","Regsvr32.exe Silent Mode from TEMP Directory","Detects regsvr32 ran in silent mode from a temp directory. This activity has been attributed to the Qbot and Bazar trojans."
"","","MATCH-S00475","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1127.001, _mitreAttackTechnique:T1127","Renamed MSBUILD.EXE by Arguments","From FireEye Red Team Tool Countermeasures: This alert looks for renamed msbuild.exe process executions based on common command line arguments used for msbuild.exe. Attackers frequently use msbuild.exe (or renamed versions of this binary) to execute arbitrary CSharp payloads written to disk most commonly as .csproj files (though any file with an extension ending in ""proj"" will work) either referenced on the command line or located in the same directory as the msbuild.exe binary. The XML payload on disk should be acquired and examined to determine the functionality of the payload."
"","","LEGACY-S00072","match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.004","Request to DNS over HTTPS (DoH) Service Provider","DNS over HTTPS (RFC 8484, DoH) is a web based name resolution service that allows clients to resolve DNS records over web services. DoH operates over standards compliant HTTPS and is therefore typically encrypted and validated TLS over port 443/tcp. In some environments this may be abused as a method to bypass security and policy controls. Some malicious actors leverage DoH to tunnel DNS traffic over HTTPS, and research has demonstrated the ability to carry out other DNS related abuse such as malware C2 over DoH as well."
"Cisco Systems","","MATCH-S00501","templated_match","Collection","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0001, _mitreAttackTechnique:T1557, _mitreAttackTechnique:T1557.002, _mitreAttackTechnique:T1200","Rogue DHCP Server - Cisco","Observes for Cisco events indicating the presence of a rogue DHCP server"
"","","MATCH-S00328","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0006, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1550, _mitreAttackTechnique:T1550.003, _mitreAttackTechnique:T1558, _mitreAttackTechnique:T1558.003","Rubeus Hack Tool","Detects command line parameters associated with use of the Rubeus hack tool"
"","","MATCH-S00498","templated_match","Privilege Escalation","True","False","Audit","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0006, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1550, _mitreAttackTechnique:T1550.003, _mitreAttackTechnique:T1558, _mitreAttackTechnique:T1558.003","Rubeus Hack Tool Logon Process Name","From FireEye Red Team Tool Countermeasures:
Rubeus is a utility  that provides Kerberos abuse capabilities. This rule is looking for the  hardcoded LogonProcessName value, ""User32LogonProcesss""."
"","","MATCH-S00690","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.011","Rundll32.exe Load from TEMP Directory with By Ordinal Load","Detects rundll32 loaded from a temp directory with a by ordinal load. This activity has been attributed to the Qbot and Bazar trojans."
"","","MATCH-S00346","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1547, _mitreAttackTechnique:T1547.001, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1486, _mitreAttackTechnique:T1059.003","Ryuk Ransomware Endpoint Indicator","Indicates a process has started with charachteristics that are highly similar to the Ryuk ransomware's execution behavior."
"","","MATCH-S00506","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1543, _mitreAttackTechnique:T1543.003","SC Exe Manipulating Windows Services","Observes for command line arguments with sc.exe indicating Windows services being modified"
"","","THRESHOLD-S00032","threshold","Lateral Movement","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1110, _mitreAttackTechnique:T1110.001, _mitreAttackTechnique:T1110.002, _mitreAttackTechnique:T1110.003, _mitreAttackTechnique:T1110.004, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.002","SMB Brute Force Attempt","This rule looks for failed SMB login attempts."
"","","LEGACY-S00073","match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.002","SMB External to Internal File Share Access","This signal identifies external sources connecting to file shares.  Do to the vulnerabilities and insecurities of SMB this type of traffic should be prohibited. "
"","Bro","LEGACY-S00074","match","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.002","SMB Internal to External traffic","SMB/CIFS is a workgroup protocol for file sharing intended to be used among trusted systems on an internal LAN. A number of risks are associated with internal systems connecting to untrusted external SMB servers, including exploit delivery, credential harvesting, and data exfiltration. SMB access should be limited to the enterprise network to prevent participation in unknown SMB related attacks. Limited exceptions may exist, such as file server access over extranet connections."
"","","LEGACY-S00075","match","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.002","SMB - Remote execution and/or persistence via scheduled task using ATSVC ","Remote execution and/or persistence via scheduled task using ATSVC named pipe."
"","","THRESHOLD-S00033","threshold","Lateral Movement","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTactic:TA0008, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1135, _mitreAttackTechnique:T1595, _mitreAttackTechnique:T1595.001, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.002","SMB Scanning Detected","This rule looks for a host scanning other SMB hosts for specific commands similar to WannaCry"
"","","LEGACY-S00076","match","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.002","SMB write to hidden admin share","SMB is primarily used for remote file access across a network.  SMB access to admin shares should be a rare occurrence, especially by a non-administrator account.  Such access is often a part of an attack pivot once an attacker has compromised one machine in a network."
"","","MATCH-S00560","templated_match","Unknown/Other","False","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071.003, _mitreAttackTechnique:T1071","SMTP Traffic from Non-SMTP Servers","Observes for SMTP traffic on non-SMTP hosts. This may be indicative of spambot activity. This rule requires that a match list of known OK SMTP servers is populated."
"","Bro","LEGACY-S00077","match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1190","SQL Injection Attacker","SQL Injection attempt detected"
"","Bro","LEGACY-S00078","match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1190","SQL Injection Victim","Successful SQL Injection attack detected"
"","","LEGACY-S00079","match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1190","SQL-Select-From","Requests to web applications containing SQL statement keywords may indicate attempts to compromise the web application or access data in a backend database engine in an unauthorized manner. This technique is described at https://attack.mitre.org/techniques/T1190/."
"","Bro","THRESHOLD-S00034","threshold","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1110, _mitreAttackTechnique:T1110.001, _mitreAttackTechnique:T1110.002, _mitreAttackTechnique:T1110.003, _mitreAttackTechnique:T1110.004, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.004","SSH Authentication Failures","Many SSH authentication failures from the same source IP in a short period of time can signal a brute-force attack."
"","Bro","LEGACY-S00080","match","Lateral Movement","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTactic:TA0042, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.004","SSH Interesting Hostname Login","""Interesting hostname"" in this context include those that start with dns, ns, smtp, mail, pop, imap, www, and ftp.  Using SSH to hosts that appear to be purposed as servers corresponding to one of these hostnames is considered suspicious."
"","","MATCH-S00826","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098.004, _mitreAttackTechnique:T1098.001","SSH Keys Added to EC2 Instance","A set of SSH keys has been added to an AWS EC2 instance."
"","Bro","LEGACY-S00084","match","Defense Evasion","True","False","","_mitreAttackTactic:TA0042, _mitreAttackTechnique:T1587.003, _mitreAttackTechnique:T1587, _mitreAttackTechnique:T1608, _mitreAttackTechnique:T1608.003","SSL Certificate Expired","A server responded on a SSL or TLS service using an expired certificate."
"","Bro","LEGACY-S00085","match","Defense Evasion","True","False","","_mitreAttackTactic:TA0042, _mitreAttackTechnique:T1587.003, _mitreAttackTechnique:T1587, _mitreAttackTechnique:T1608, _mitreAttackTechnique:T1608.003","SSL Certificate Expires Soon","A server responded on a SSL or TLS service using a certificate that will expire soon."
"","Bro","LEGACY-S00086","match","Initial Access","True","False","","_mitreAttackTactic:TA0042, _mitreAttackTechnique:T1608, _mitreAttackTechnique:T1608.003","SSL Certificate Not Valid Yet","A server responded on a SSL or TLS service using a certificate with a future-dated NotValidBefore attribute."
"","Bro","LEGACY-S00087","match","Credential Access","True","False","","_mitreAttackTactic:TA0042, _mitreAttackTechnique:T1608, _mitreAttackTechnique:T1608.003","SSL Heartbleed Attack","SSL Heartbleed Attack detected"
"","Bro","LEGACY-S00088","match","Credential Access","True","False","","_mitreAttackTactic:TA0042, _mitreAttackTechnique:T1587.003, _mitreAttackTechnique:T1587, _mitreAttackTechnique:T1608, _mitreAttackTechnique:T1608.003","SSL Heartbleed Attack Successful","SSL Heartbleed Attack Successful"
"","Bro","LEGACY-S00089","match","Credential Access","True","False","","_mitreAttackTactic:TA0042, _mitreAttackTechnique:T1608, _mitreAttackTechnique:T1608.003","SSL Heartbleed Many Requests","Indicates we saw many heartbeat requests without a reply. Might be an attack."
"","Bro","LEGACY-S00090","match","Credential Access","True","False","","_mitreAttackTactic:TA0042, _mitreAttackTechnique:T1608, _mitreAttackTechnique:T1608.003","SSL Heartbleed Odd Length","SSL Heartbleed Odd Length"
"","Bro","LEGACY-S00091","match","Execution","True","False","","_mitreAttackTactic:TA0042, _mitreAttackTechnique:T1608, _mitreAttackTechnique:T1608.003","SSL Invalid Server Cert","A server responded on a SSL or TLS service using a certificate identified as invalid by the Network Sensor."
"Microsoft","Windows","THRESHOLD-S00061","threshold","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1135","SYSVOL Share Sweep","When attempting to pivot within an internal AD network, attacks will query the Domain Controllers for passwords stored within group policy files. This is typically done by querying the SYSVOL share.  A host querying the SYSVOL share is suspicious activity and could be indicative of this type of attack."
"","","MATCH-S00468","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001","SafetyKatz Credential Stealer","From FireEye Red Team Tool Countermeasures:
SafetyKatz is a combination of slightly modified version of Mimikatz project and .NET PE Loader."
"Salesforce","Salesforce","MATCH-S00774","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098, _mitreAttackTechnique:T1098.001","Salesforce Custom Permission Creation","Custom Permissions in Salesforce are used to give access to users for certain apps or processes that you have configured and which cannot be controlled by profile or permission set directly. This rule is used to monitor this activity as adversaries could abuse this to escalate privileges. Salesforce admin match lists are exclude in this rule in an attempt to reduce the false positives due to expected admin activity. These match lists should be created and populated with Salesforce admin usernames and IPs."
"Salesforce","Salesforce","THRESHOLD-S00108","threshold","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1213, _mitreAttackTechnique:T1530","Salesforce Excessive Documents Downloaded","Detects when an entity downloads multiple documents or attachments in a short timeframe. This type of activity is indicative of exfiltration. Salesforce admin match lists are exclude in this rule in an attempt to reduce the false positives due to expected admin activity. These match lists should be created and populated with Salesforce admin usernames and IPs."
"Salesforce","Salesforce","MATCH-S00773","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1078.004, _mitreAttackTechnique:T1078","Salesforce LoginAs Event","Generates severity 0 signals for LoginAs Salesforce events. The purpose of this rule is to track LoginAs activity for both the source and target user to provide additional context for Insights. The third party match list exclusion should be populated to exclude known permitted third party domains from triggering this rule. Its common for third party support accounts to use the LoginAs function. Salesforce admin match lists are exclude in this rule in an attempt to reduce the false positives due to expected admin activity. These match lists should be created and populated with Salesforce admin usernames and IPs."
"Salesforce","Salesforce","MATCH-S00770","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1078.004, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1078","Salesforce Login Attempt from Disabled Account","Detects when a disabled account attempts to log into Salesforce"
"Salesforce","Salesforce","MATCH-S00780","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098","Salesforce Permission Set Addition","Detects permission set additions in Salesforce. While these additions can be routine, their function can be abused for malicious intent. Salesforce admin match lists are exclude in this rule in an attempt to reduce the false positives due to expected admin activity. These match lists should be created and populated with Salesforce admin usernames and IPs."
"Salesforce","Salesforce","MATCH-S00778","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098","Salesforce Permission Set Assigned","Detects permission set assignments. While this is a routine activity, permission assignments could be used by an adversary for persistence and privilege escalation. Salesforce admin match lists are exclude in this rule in an attempt to reduce the false positives due to expected admin activity. These match lists should be created and populated with Salesforce admin usernames and IPs."
"Salesforce","Salesforce","MATCH-S00779","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098","Salesforce Permission Set Creation","Detects permission set creations in Salesforce. While these creations can be routine, their function can be abused for malicious intent. Salesforce admin match lists are exclude in this rule in an attempt to reduce the false positives due to expected admin activity. These match lists should be created and populated with Salesforce admin usernames and IPs."
"Salesforce","Salesforce","MATCH-S00782","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1485, _mitreAttackTechnique:T1531","Salesforce Permission Set Deletion","Detects permission set deletions in Salesforce. While these deletions can be routine, their function can be abused for malicious intent. Salesforce admin match lists are exclude in this rule in an attempt to reduce the false positives due to expected admin activity. These match lists should be created and populated with Salesforce admin usernames and IPs."
"Salesforce","Salesforce","MATCH-S00781","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098","Salesforce Permission Set Modification","Detects various permission set changes in Salesforce. While these changes can be routine, their function can be abused for malicious intent. Salesforce admin match lists are exclude in this rule in an attempt to reduce the false positives due to expected admin activity. These match lists should be created and populated with Salesforce admin usernames and IPs."
"Salesforce","Salesforce","MATCH-S00772","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1213, _mitreAttackTechnique:T1530","Salesforce Report Exported","Detects when a report is exported. Reports contain a variety of information that adversaries may attempt to exfiltrate. Salesforce admin match lists are exclude in this rule in an attempt to reduce the false positives due to expected admin activity. These match lists should be created and populated with Salesforce admin usernames and IPs."
"Salesforce","Salesforce","MATCH-S00777","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098","Salesforce Role Creation","Detects role creation. While this is a routine activity, role creation could be used by an adversary for persistence and privilege escalation. Salesforce admin match lists are exclude in this rule in an attempt to reduce the false positives due to expected admin activity. These match lists should be created and populated with Salesforce admin usernames and IPs."
"Salesforce","Salesforce","MATCH-S00775","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1136, _mitreAttackTechnique:T1136.003","Salesforce User Creation","Detects user creation. While this is a routine activity, user creation could be used by an adversary for persistence. Salesforce admin match lists are exclude in this rule in an attempt to reduce the false positives due to expected admin activity. These match lists should be created and populated with Salesforce admin usernames and IPs."
"Salesforce","Salesforce","MATCH-S00776","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098","Salesforce User Role Changed","Detects role changes. While this is a routine activity, role changes could be used by an adversary for persistence and privilege escalation. Salesforce admin match lists are exclude in this rule in an attempt to reduce the false positives due to expected admin activity. These match lists should be created and populated with Salesforce admin usernames and IPs."
"Salesforce","Salesforce","MATCH-S00771","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1213, _mitreAttackTechnique:T1530","Salesforce WaveDownload Event","Wave Download events represent downloads made from lens explorations and dashboard widgets in the Tableau CRM user interface. A Wave Download event type is captured when a user downloads images ( .png ), Microsoft Excel data ( .xls ), or comma-separated values ( .csv ) files. Salesforce admin match lists are exclude in this rule in an attempt to reduce the false positives due to expected admin activity. These match lists should be created and populated with Salesforce admin usernames and IPs."
"","","MATCH-S00528","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1486, _mitreAttackTechnique:T1070, _mitreAttackTechnique:T1070.004, _mitreAttackTechnique:T1027, _mitreAttackTechnique:T1027.001, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003","Samsam Test File Write","The rule looks for a file named ""test.txt"" written to the windows system directory tree, which is consistent with Samsam propagation."
"","","MATCH-S00153","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1053, _mitreAttackTechnique:T1053.002, _mitreAttackTechnique:T1053.005, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.001, _mitreAttackTechnique:T1059.003","Scheduled Task Created via PowerShell","Attackers have been known to leverage PowerShell for scheduled task creation for the purpose of maintaining persistence in a Windows based environment."
"Microsoft","Windows","MATCH-S00214","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1053, _mitreAttackTechnique:T1053.002, _mitreAttackTechnique:T1053.005","Scheduled Task Creation with Suspicious Task Executable","Attackers may create scheduled tasks to execute commands in various scenarios. Inclusion of commonly abused or high risk Windows executables may be an indication of an attack."
"","","MATCH-S00529","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.006, _mitreAttackTechnique:T1053, _mitreAttackTechnique:T1053.002, _mitreAttackTechnique:T1053.005","Schtasks Scheduling Job On Remote System","This rule looks for flags passed to schtasks.exe on the command-line that indicate a job is being scheduled on a remote system."
"","","MATCH-S00530","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1053, _mitreAttackTechnique:T1053.002, _mitreAttackTechnique:T1053.005","Schtasks Used For Forcing A Reboot","This rule looks for flags passed to schtasks.exe on the command-line that indicate that a forced reboot of system is scheduled."
"","","LEGACY-S00093","match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1105, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003","Script/CLI UserAgent string","This pattern discovers HTTP communications from an internal source where a development library or command line client user-agent string was observed (e.g. Wget, cURL, etc.). Use of these techniques by attackers is described in https://attack.mitre.org/techniques/T1105/ and https://attack.mitre.org/techniques/T1064/."
"","","MATCH-S00547","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1047","Script Execution Via WMI","This rule looks for scripts launched via WMI."
"","","MATCH-S00447","templated_match","Execution","False","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003","Script Interpreter Launched by Cmd","Observes for wscript or cscript being executed by cmd.

It is recommended this rule be tuned to exclude hosts/users that are expected to regularly make use of script interpreters."
"","","MATCH-S00478","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003","Seatbelt Utility","From FireEye Red Team Tool Countermeasures: Seatbelt is an open source C# project that performs a number of security oriented host-survey ""safety checks"" relevant from both offensive and defensive security perspectives. This IOC also detects some variations of this project namely Beltalowda and Shamwow."
"Microsoft","","MATCH-S00893","templated_match","Persistence","True","True","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098.001","Secret Added to Azure Service Principal","Secrets can be added to Azure Service Principals as a persistence mechanism. The properties.targetResources.1.modifiedProperties.1.newValue field will have details regarding the secret or certificate added."
"Microsoft","Windows","MATCH-S00437","templated_match","Impact","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1485","Secure Deletion with SDelete","Detects renaming of file with deletion with SDelete tool."
"","","MATCH-S00299","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001, _mitreAttackTechnique:T1003.002, _mitreAttackTechnique:T1555, _mitreAttackTechnique:T1555.004","SecurityXploded Tool","Detects the execution of SecurityXploded Tools"
"Bro","","LEGACY-S00094","match","Exfiltration","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0010, _mitreAttackTechnique:T1553, _mitreAttackTechnique:T1553.002","Self-signed Certificates","A server responded on a SSL or TLS service using a self-signed certificate."
"","","MATCH-S00834","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1112, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003.001","Sensitive Registry Key (WDigest) Edit","Enabling of Wdigest authentication may enable the storage of plain text credential material on Windows systems. WDigest is disabled by default on newer versions of Windows systems, manual enablement of this registry key may indicate suspicious activity and attempts at credential theft."
"","","LEGACY-S00095","match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1190","Server-Side Code Injection in URL","Attackers may use improper URL checking to inject code that is executed on a server.  This may be used in DoS attacks or to execute commands to elevate privilege.  The attack pattern is similar to Shellshock exploitation."
"","","CHAIN-S00010","chain","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1548, _mitreAttackTechnique:T1548.002","Service Installation Followed By Elevated CMD Prompt","This rule looks for the installation of an application by a non-Sytem user quickly followed by the execution of cmd.exe with System privileges on the same host. This indicates a privilege escalation attempt was likely successful and correlates directly to CVE-2021-41379. The rule is designed to work with standard Security and System event logging, but Sysmon process logging can substitute in place of event ID 4688."
"","","MATCH-S00296","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1070, _mitreAttackTechnique:T1070.004, _mitreAttackTechnique:T1490","Shadow Copies Deletion Using OS Utilities","When adversaries take destructive action (e.g. encrypting files for ransomware) 'shadow copies' of the file system volumes are often destroyed in order to prevent these files from being easily recovered.  This signal indicates that a command was observed that may indicate this destructive action."
"","","MATCH-S00406","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.003","Shadow Copy Creation","Observes for ntdsutil, vssadmin, wmic, or powershell creating shadow copies. This is another method to extract credentials."
"","","MATCH-S00471","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1047, _mitreAttackTechnique:T1053, _mitreAttackTechnique:T1053.005, _mitreAttackTechnique:T1547, _mitreAttackTechnique:T1547.001","SharPersist A Utility","From FireEye Red Team Tool Countermeasures:
This IOC detects windows persistence activity performed by the Sharpersist utility. It has multiple persistence functionalities such as Keepass, hotkey, new schedule task, Startup Folder and Scheduled Task Backdoor."
"","","MATCH-S00469","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1547, _mitreAttackTechnique:T1547.001, _mitreAttackTechnique:T1053, _mitreAttackTechnique:T1053.005","SharPersist Utility","From FireEye Red Team Tool Countermeasures:
This IOC detects a Windows Persistence Toolkit called SharPersist."
"","","MATCH-S00472","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.006, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003, _mitreAttackTechnique:T1559, _mitreAttackTechnique:T1559.001","SharPivot Utility","From FireEye Red Team Tool Countermeasures:
SHARPIVOT is a .NET console application that can be used to perform command execution against a remote target for the purposes of lateral movement."
"","","MATCH-S01051","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1190","SharePoint Server ToolShell Exploitation (CVE-2025-53770, CVE-2025-53771)","Context:
Exploits against two vulnerabilities in Microsoft SharePoint server, CVE-2025-53770 and CVE-2025-53771, are combined to execute code on Microsoft SharePoint without authentication. This attack has been nicknamed ""ToolShell"".

Detection:
This detection will trigger on the inital access and uploading of a malicious payload to the vulnerable SharePoint server.

Recommended Actions:
Follow the Microsoft guidance for how to protect against and remediate this attack: https://msrc.microsoft.com/blog/2025/07/customer-guidance-for-sharepoint-vulnerability-cve-2025-53770/#how-to-protect-your-environment"
"","","MATCH-S01052","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1505.003","SharePoint Server ToolShell Web Shell Interaction (CVE-2025-53771)","Context:
Exploits against two vulnerabilities in Microsoft SharePoint server, CVE-2025-53770 and CVE-2025-53771 are combined to execute code on Microsoft SharePoint without authentication. This attack has been nicknamed ""ToolShell"".

Detection:
This detection will trigger on GET requests occurring to the web shell post-exploitation .

Recommended Actions:
Follow the Microsoft guidance for how to protect against and remediate this attack: https://msrc.microsoft.com/blog/2025/07/customer-guidance-for-sharepoint-vulnerability-cve-2025-53770/#how-to-protect-your-environment"
"Microsoft","Office 365","THRESHOLD-S00101","threshold","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1213, _mitreAttackTechnique:T1213.002","Sharepoint - Excessive Documents Accessed by User","This rule detects when a large number of documents are accessed in a short timeframe. This behavior may be indicative of programmatic means being used to retrieve all data within the repository."
"Microsoft","Office 365","THRESHOLD-S00111","threshold","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1213, _mitreAttackTechnique:T1213.002","Sharepoint - Excessive Documents Accessed by External IP","This rule detects when a large number of documents are accessed in a short timeframe from an external IP. This behavior may be indicative of programmatic means being used to retrieve all data within the repository."
"Microsoft","Office 365","THRESHOLD-S00110","threshold","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1213, _mitreAttackTechnique:T1213.002","Sharepoint - External IP Downloaded Excessive Documents","This rule detects when a large number of documents are downloaded in a short timeframe. This behavior may be indicative of programmatic means being used to retrieve all data within the repository."
"Microsoft","Office 365","THRESHOLD-S00100","threshold","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1213, _mitreAttackTechnique:T1213.002","Sharepoint - Excessive Documents Downloaded","This rule detects when a large number of documents are downloaded in a short timeframe. This behavior may be indicative of programmatic means being used to retrieve all data within the repository."
"","","MATCH-S00473","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1070, _mitreAttackTechnique:T1070.006","SharpStomp Utility","From FireEye Red Team Tool Countermeasures:
SharpStomp is a C# utility that can be used to timestomp the specified file's creation, last access, and last write time."
"","","LEGACY-S00096","match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0042, _mitreAttackTechnique:T1190","Shellshock","HTTP requests with headers indicating an attempt to exploit CVE-2014-6271 and related vulnerabilities in the Bash shell using Bashdoor/Shellshock attack. This vulnerability is most often triggered in CGI scripts implemented against vulnerable versions of the shell."
"Microsoft","Windows","THRESHOLD-S00065","threshold","Lateral Movement","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.001, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003","Windows - Excessive User Interactive Logons Across Multiple Hosts","A user performed a significant number of Windows interactive logins to multiple destination hosts in the past 24 hours. This behavior can be expected for some accounts, such as administrators in a Windows environment. Tuning this rule is highly recommended to filter out usernames where applicable."
"","","MATCH-S00692","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0003, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003, _mitreAttackTechnique:T1053, _mitreAttackTechnique:T1053.005, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.010","Silent Regsvr32 Scheduled Task Creation on Command Line","Detects schtasks used to invoke a silent regsvr32 call. This activity has been attributed to the Qbot and Bazar trojans."
"Slack","","THRESHOLD-S00086","threshold","Exfiltration","True","False","","_mitreAttackTechnique:T1567, _mitreAttackTechnique:T1048, _mitreAttackTechnique:T1048.003, _mitreAttackTechnique:T1567.002, _mitreAttackTactic:TA0010","Slack - Mass Download Events","Adversaries may use an existing, legitimate external Web service to exfiltrate data rather than their primary command and control channel."
"Slack","","THRESHOLD-S00087","threshold","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1539","Slack - Possible Session Hijacking","Detects the same sessionID used from a new IP for the same user in a short period of time."
"","","MATCH-S00370","templated_match","Execution","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1486","Snatch Ransomware","Detects specific process characteristics of Maze ransomware word document droppers"
"","","MATCH-S00571","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1569, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1569.002, _mitreAttackTechnique:T1204.002, _mitreAttackTechnique:T1204.003","Sofacy Trojan Loader","Detects Trojan loader acitivty as used by APT28"
"","","MATCH-S00480","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1195, _mitreAttackTechnique:T1195.001, _mitreAttackTechnique:T1195.002","Solarwinds Suspicious Child Processes","From FireEye Red Team Tool Countermeasures: This rule identifies suspicious child processes of SolarWinds.Orion.Core.BusinessLayer.dll that may be evidence of the SUNBURST backdoor. The behavior of SolarWinds.Orion.Core.BusinessLayer.dll is dependent on per-enterprise configuration, so additional tuning may be required to exclude legitimate activity in a given environment. SUNBURST is a backdoor that has the ability to spawn and kill processes, write and delete files, set and create registry keys, gather system information, and disable a set of forensic analysis tools and services."
"","","MATCH-S00481","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1195, _mitreAttackTechnique:T1195.001, _mitreAttackTechnique:T1195.002","Solarwinds Suspicious URL Hostname","From FireEye Red Team Tool Countermeasures: This rule identifies URL requests mimicking SolarWinds network traffic, to non-SolarWinds domains. This rule will only match on instances where communication does not occur over SSL/TLS. These requests may be evidence of the SUNBURST backdoor. SUNBURST is a backdoor that has the ability to spawn and kill processes, write and delete files, set and create registry keys, gather system information, and disable a set of forensic analysis tools and services."
"","","MATCH-S00422","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1036, _mitreAttackTechnique:T1036.006","Spaces Before File Extension","Observes for files being executed that contain at least 5 spaces preceding the file extension. This may indicate an attempt to hide the true extension of a file."
"","","OUTLIER-S00001","outlier","Credential Access","True","True","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1110","Spike in Login Failures from a User","Detects excessive failed login attempts for the same username based on a daily outlier standard deviation for said user. This is designed to catch both slow and quick brute force type attacks using a user specific historic baseline. The minimum floor of failures expected by default is set to 10."
"","","OUTLIER-S00005","outlier","Execution","True","False","","_mitreAttackTactic:TA0002","Spike in AWS API Call from User","This rule is designed to detect spikes of excessive API call events within AWS performed by a user based on a daily outliers standard deviation using a designated historic baseline. The minimum floor of API Calls expected by default is set to 5. If excessive signaling is observed it is recommended adding expected users that are known to be involved with specific administrative or privileged activity in AWS to the AWS_admin_users match list."
"","","OUTLIER-S00011","outlier","Credential Access","True","False","","_mitreAttackTactic:TA0006","Spike in AWS AccessDenied Events by assumedrole","Assuming a role involves using a set of temporary security credentials that can be used to access AWS resources that a role might not normally have access to."
"","","OUTLIER-S00004","outlier","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1046","Spike in Azure Firewall Deny Events from Source IP","This rule is designed to detect spikes of excessive firewall deny events within Azure for the same source IP based on a daily outliers standard deviation using a designated historic baseline. The minimum floor of firewall denies expected by default is set to 30. Customers will need to adjust the Model Sensitivity threshold (standard deviation multiplier) and Minimum Count Value of this rule to align with their environment's normal vs abnormal firewall traffic patterns."
"","","OUTLIER-S00006","outlier","Exfiltration","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTechnique:T1030","Spike in Data Transferred Outbound by User","Observes excessive amount of bytes out proxy traffic from a username based on a daily outlier standard deviation using a designated historic baseline. The minimum sum of bytes out expected by default is set to 600000000."
"","","OUTLIER-S00008","outlier","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1110.001","Spike in Failed Azure Sign In Attempts Due to Bad Password from IP Address","Outlier in Failed Azure Sign In Attempts Due to Bad Password from IP Address due to exceeded standard deviation of what is expected for the IP Address based on a historic baseline. The minimum floor of failures expected by default is set to 2."
"","","OUTLIER-S00003","outlier","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1135","Spike in Failed Share Access by User","When attempting to pivot within an internal AD network, attacks will attempt to discover and traverse the available network shares. This detects excessive failed share access attempts for the same username based on a daily outlier standard deviation using a designated historic baseline. The minimum floor of failures expected by default is set to 10."
"","","OUTLIER-S00009","outlier","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059.001","Spike in PowerShell Command Line Length From Host","Observes for PowerShell command lines with excessive length found on a given system based on a daily outlier of standard deviation using a designated historic baseline of what has been previously observed for said system. The minimum PowerShell command line length expected by default is set to 3 characters."
"","","OUTLIER-S00002","outlier","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1135","Spike in Successful Distinct Share Access","When attempting to pivot within an internal AD network, attacks will attempt to discover and traverse the available network shares. This detects successful and unique share access attempts for the same username based on a daily outlier standard deviation using a designated historic baseline. The minimum floor of unique shares expected by default is set to 5."
"","","OUTLIER-S00010","outlier","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1102","Spike in URL Length from IP Address","Observes for an outlier in URL length sourcing from an IP Address based on a daily standard deviation using a designated historic baseline of what has been previously observed for said IP Address. This type of anomaly can linked with web based execution of Command and Control. The minimum URL length expected by default is set to 128 characters."
"","","OUTLIER-S00007","outlier","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1078.002","Spike in Windows Administrative Privileges Granted for User","Observes granting of administrative privileges in Windows environments where the number of systems accessed by a single user exceeds standard deviation of what is expected for the user based on a historic baseline. The minumum floor of unique systems expected by default is set to 1."
"","","MATCH-S00507","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1068","Spoolsv Child Process Created","Observes for Spoolsv launching unexpected child processes. This may be related to behavior in CVE-2018-8440"
"","","MATCH-S00783","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1190","Spring4Shell Exploitation - URL","Detects indicators found from SpringCore exploitation attempts."
"Microsoft","Azure","CHAIN-S00008","chain","Credential Access","True","False","Authentication","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1110, _mitreAttackTactic:TA0008, _mitreAttackTactic:TA0001, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1110.001, _mitreAttackTechnique:T1110.002, _mitreAttackTechnique:T1586","Successful Brute Force","Detects a series of failed logins followed by a successful login. This could indicate that an attacker was successful in guessing a user's password and has compromised their account. This rule does not leverage authentication logs with a normalizedAction of domainLogon and does not have a Domain version, meaning that Windows workstation logging is required to achieve full visibility."
"","","MATCH-S00196","templated_match","Lateral Movement","True","False","Authentication","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1550, _mitreAttackTechnique:T1550.002","Successful Overpass the Hash Attempt","Identifies a suspicious windows logon of type 9 (NewCredentials).  This signal is suspicious due to its similarity to the behavior observed when using Mimikatz's sekurlsa::pth tool."
"Sumo Logic","","MATCH-S00090","templated_match","Unknown/Other","True","False","","","Sumo Logic Scheduled Searches","This rule passes through Sumo Logic CIP scheduled search hits to CSE as signals."
"","","MATCH-S00470","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1195, _mitreAttackTechnique:T1195.001, _mitreAttackTechnique:T1195.002","Sunburst Suspicious File Writes","From FireEye Sunburst Countermeasures:
This rule identifies writes of specific file types associated with activity related to the SUNBURST backdoored version of the SolarWinds.Orion.Core.BusinessLayer.dll process. This rule may generate false positives depending on the configuration of SolarWinds in a given environment, and may require tuning to exclude legitimate activity. SUNBURST is a backdoor that has the ability to spawn and kill processes, write and delete files, set and create registry keys, gather system information, and disable a set of forensic analysis tools and services."
"","","MATCH-S00337","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1055, _mitreAttackTechnique:T1055.001, _mitreAttackTechnique:T1055.002, _mitreAttackTechnique:T1055.003, _mitreAttackTechnique:T1055.004, _mitreAttackTechnique:T1055.009, _mitreAttackTechnique:T1055.012, _mitreAttackTechnique:T1055.013, _mitreAttackTechnique:T1569.002, _mitreAttackTechnique:T1569","Suspect Svchost Activity","It is extremely abnormal for svchost.exe to spawn without any CLI arguments and is normally observed when a malicious process spawns the process and injects code into the process memory space."
"","","MATCH-S00841","templated_match","Credential Access","True","True","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.001","Suspicious AWS CLI Keys Access on Linux Host","Linux endpoints are often used to manage cloud resources. As a result, various keys and secrets material can often be found on file systems. Threat actors may attempt to download or view such credential material in order to access cloud resources."
"","","AGGREGATION-S00003","aggregation","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526","Suspicious AWS Lambda Enumeration","Threat actors will attempt to enumerate various system settings in order to explore privilege escalation avenues or to locate potentially sensitive data."
"","","MATCH-S00899","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1649","Suspicious Active Directory Certificate Modification","This alert looks for an Active Directory certificate being modified with the ""Any Purpose"" OID. Threat actors may abuse this misconfiguration to forge certificates and Kerberos Ticket Granting Tickets (TGT). Specifically, this misconfiguration can exploit the ""ESC2"" attack path via https://posts.specterops.io/certified-pre-owned-d95910965cd2. If this event is deemed suspicious, look for authentication events (4624) that utilize this certificate template. Also ensure that this change was expected and approved within the environment."
"","","MATCH-S00902","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1649","Suspicious Active Directory Certificate Modification - Enrollment Agent","This alert looks for an Active Directory certificate being modified with an Enrollment Agent value that allows an Active Directory principal to enroll a certificate on behalf of another user. Threat actors may abuse this misconfiguration to forge certificates and Kerberos Ticket Granting Tickets (TGT). Specifically, this misconfiguration can exploit the ""ESC3"" attack path via https://posts.specterops.io/certified-pre-owned-d95910965cd2. If this event is deemed suspicious, look for authentication events (4624) that utilize this certificate template. Also ensure that this change was expected and approved within the environment."
"Microsoft","","MATCH-S00817","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0007, _mitreAttackTechnique:T1526, _mitreAttackTechnique:T1098","Suspicious Azure Active Directory Device Code Authentication","Successful Device Code authentication flows result in the issuance of an Azure Primary Refresh Token which can be used to access, enumerate or - if the relevant permissions exist - to modify Azure resources."
"","Laurel Linux Audit","MATCH-S00842","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.001","Suspicious Azure CLI Keys Access on Linux Host","Linux endpoints are often used to manage cloud resources. As a result, various keys and secrets material can often be found on file systems. Threat actors may attempt to download or view such credential material in order to access cloud resources."
"","","MATCH-S00359","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1140","Suspicious Certutil Command","Detects a suspicious Microsoft certutil execution with sub commands like 'decode' sub command, which is sometimes used to decode malicious code with the built-in certutil utility."
"","","MATCH-S00356","templated_match","Exfiltration","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTechnique:T1020, _mitreAttackTechnique:T1020.001","Suspicious Compression Tool Parameters","Detects suspicious command line arguments of common data compression tools."
"","","MATCH-S00362","templated_match","Exfiltration","True","False","","_mitreAttackTactic:TA0010, _mitreAttackTechnique:T1567, _mitreAttackTechnique:T1567.001, _mitreAttackTechnique:T1567.002","Suspicious Curl File Upload","Detects a suspicious curl process start the adds a file to a web request."
"Microsoft","Windows","LEGACY-S00105","match","Lateral Movement","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.001, _mitreAttackTechnique:T1021.006, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003","Suspicious DC Logon","Shows RemoteInteractive logons, such as RDP sessions, to domain controllers. Requires customer to setup the domain_controller_hostnames match list"
"","","MATCH-S00499","templated_match","Initial Access","True","False","Email","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Suspicious Email Attachment Extension","Observes for e-mail attachments with file extensions commonly used by attackers or associated with malware."
"","Bro","LEGACY-S00106","match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Suspicious Email Origin","The email has originated from a suspicious location"
"","","MATCH-S00476","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1036, _mitreAttackTechnique:T1036.005","Suspicious Execution of Search Indexer","From FireEye Red Team Tool Countermeasures: This IOC detects suspicious execution of searchindexer. This technique is known to be used by Cobaltstrike which inject malicious code into a newly spawned searchindexer process to evade detection."
"Microsoft","Windows","MATCH-S00293","templated_match","Exfiltration","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTactic:TA0010, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1025, _mitreAttackTechnique:T1052, _mitreAttackTechnique:T1052.001, _mitreAttackTechnique:T1092","Suspicious External Device Installation","Detects removable media attached to a device that was previously denied by policy. External media can be used to exfiltrate sensitive data and is also a common source of infections, so some organizations block their use. Attempts to use these devices could indicate the intent for malicious activity."
"","Laurel Linux Audit","MATCH-S00843","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552, _mitreAttackTechnique:T1552.001","Suspicious GCP CLI Keys Access on Linux Host","Linux endpoints are often used to manage cloud resources. As a result, various keys and secrets material can often be found on file systems. Threat actors may attempt to download or view such credential material in order to access cloud resources."
"","","LEGACY-S00182","match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0007, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003, _mitreAttackTechnique:T1059.001, _mitreAttackTechnique:T1083, _mitreAttackTechnique:T1132, _mitreAttackTechnique:T1548, _mitreAttackTactic:TA0009, _mitreAttackTechnique:T1213, _mitreAttackTechnique:T1213.001","Suspicious HTTP User-Agent","Common administrative tools may be used by malware authors and attackers who use live-off-the-land methods to operate on victim networks."
"","","AGGREGATION-S00004","aggregation","Unknown/Other","True","True","","","Suspicious K8s Enumeration","Threat actors will attempt to enumerate various system settings in order to explore privilege escalation avenues or to locate potentially sensitive data."
"Amazon AWS","CloudTrail","MATCH-S00840","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTechnique:T1648","Suspicious Lambda Function - IAM Policy Attached","A Lambda function has been used to assign an IAM role to a user, this may be potentially malicious or unexpected activity, particularly if Lambda is not used to assign IAM roles in the environment."
"","","CHAIN-S00015","chain","Execution","True","True","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0001","Suspicious Linux Execution Chain","This alert looks for a number of search expressions that result in a suspicious Linux execution chain. Specifically, a file that is created in a users' home directory or in /tmp, followed by a chmod and file execution, as well as the process making a network connection."
"","","MATCH-S00464","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.007","Suspicious Non-Standard InstallUtil Execution","From FireEye Red Team Tool Countermeasures:
This alert looks for evidence of the native signed Windows binary InstallUtil.exe being used to load PE files. This technique can be used to bypass application whitelisting and has been observed used in the wild."
"","","MATCH-S00917","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1010","Suspicious PowerShell Application Window Discovery COM method ","This PowerShell COM method allows for discovery of running application windows, along with the process path and window location coordinates.  Investigation of the host is recommended to identify the behavior leading to and around the execution of this PowerShell process."
"","","MATCH-S00191","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.005, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003, _mitreAttackTechnique:T1059.001, _mitreAttackTechnique:T1134, _mitreAttackTechnique:T1134.001, _mitreAttackTechnique:T1134.002, _mitreAttackTechnique:T1134.003","Suspicious PowerShell Keywords","Detects keywords that could indicate the use of a PowerShell exploitation framework."
"","","MATCH-S00920","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1010","Suspicious PowerShell Window Discovery Cmdlet execution","Detects the use of PowerShell for Applicaiton Window Discovery to identify open application windows to gather information on running programs, collect potential data, and discover security tooling. Investigation into the host and user to identify the process executing the PowerShell function. Reference: https://www.ired.team/offensive-security/enumeration-and-discovery/t1010-application-window-discovery"
"Microsoft","Windows","MATCH-S00135","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1112, _mitreAttackTechnique:T1547, _mitreAttackTechnique:T1547.001","Suspicious Registry Key Modification","This rule detects modifications to registry keys commonly targeted to achieve persistence."
"","","MATCH-S00164","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1505, _mitreAttackTechnique:T1505.003","Suspicious Shells Spawned by Web Servers","Web servers that spawn shell processes could be the result of a successfully placed web shell or an other attack"
"","","MATCH-S00500","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0009, _mitreAttackTactic:TA0043, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003","Suspicious Shortcut File Launching Process","Observes for a shortcut (lnk) executing a process from directories common in various phishing tools."
"","","AGGREGATION-S00005","aggregation","Discovery","True","False","","_mitreAttackTactic:TA0043, _mitreAttackTechnique:T1589, _mitreAttackTechnique:T1592, _mitreAttackTechnique:T1590.005, _mitreAttackTechnique:T1590.002, _mitreAttackTechnique:T1590.001","Suspicious System Enumeration Occurring in Quick Succession","Threat actors will attempt to enuerate various system settings in order to explore privilige escalation avenues or to locate potentially sensitive data."
"Microsoft","Windows","MATCH-S00350","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1571","Suspicious Typical Malware Back Connect Ports","Detects programs that connect to typical malware back connect ports based on statistical analysis from two different sandbox system databases."
"","","MATCH-S00431","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001","Suspicious Use of Procdump","Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter in combination with the lsass.exe process. This way we're also able to catch cases in which the attacker has renamed the procdump executable."
"","","MATCH-S00477","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003, _mitreAttackTechnique:T1127, _mitreAttackTechnique:T1127.001","Suspicious Use of Workflow Compiler for Payload Execution","From FireEye Red Team Tool Countermeasures: This IOC detects indicators associated with suspicious execution of Microsoft WorkFlow Compiler. This is known to be used by Cobaltstrike for lateral movement with specially crafted XLM and OXLM files."
"Microsoft","Windows","MATCH-S00158","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1136, _mitreAttackTechnique:T1136.001, _mitreAttackTechnique:T1136.002","Suspicious Windows ANONYMOUS LOGON Account Created","Detects the creation of suspicious accounts similar to ANONYMOUS LOGON.  These accounts could be created as a covering detection vs network type 3 logons for shared resources, such as folders or printers."
"Microsoft","Windows","MATCH-S00551","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1074, _mitreAttackTechnique:T1074.001","Suspicious Writes To System Volume Information","This rule detects writes to the 'System Volume Information' folder by something other than the System process."
"Microsoft","Windows","MATCH-S00550","templated_match","Collection","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0009, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003, _mitreAttackTechnique:T1074, _mitreAttackTechnique:T1074.001","Suspicious Writes To Windows Recycle Bin","This rule detects writes to the recycle bin by a process other than explorer.exe."
"","","MATCH-S00918","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1201","Suspicious cat of PAM common-password policy","The Pluggable Authentication Module (PAM) in Linux allows system administrators to choose how applications authenticate users. The common-password file defines behavior of password use in Linux subsystems. This detection looks for use of cat to display the contents of the common-password file, which should not be a common occurrence on systems. It is recommended to investigate the host upon which this detection occurs to understand the exposure of the password policies for the system."
"","","MATCH-S00886","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1222.002","Suspicious chmod Execution","This alert looks for a ""chmod"" execution on a file that is found on the /tmp directory of a Linux or macOS host. Threat actors may download and copy files to this directory and add execution bits or change permissions on these files."
"","","MATCH-S00342","templated_match","Execution","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1217","Suspicious use of Dev-Tools-Launcher","DevToolsLauncher.exe has a switch 'LaunchForDeploy' that takes the location of another binary to launch.  Attackers have abused this ability to launch their own non-trusted code."
"Microsoft","Windows","MATCH-S00699","templated_match","Impact","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1561, _mitreAttackTechnique:T1561.001, _mitreAttackTechnique:T1561.002","Sysmon - RawAccessRead Event","The RawAccessRead event detects when a process conducts reading operations from the drive using the \\.\ denotation. This technique is often used by malware for data exfiltration of files that are locked for reading, as well as to avoid file access auditing tools. The event indicates the source process and target device."
"","","MATCH-S00279","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1055, _mitreAttackTechnique:T1055.001, _mitreAttackTechnique:T1129","TAIDOOR RAT DLL Load","Looks for process creation with command line references that are consistent with the Chinese TAIDOOR remote access trojan (RAT)"
"","","MATCH-S00595","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0002, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001, _mitreAttackTechnique:T1106, _mitreAttackTechnique:T1102, _mitreAttackTechnique:T1102.002","Telegram API Access","Detects suspicious requests to Telegram API without the usual Telegram User-Agent"
"","","LEGACY-S00107","match","Threat Intelligence","True","False","","","Threat Intel Match - IP Address","A record flagged an IP address from a threat intelligence match list"
"","","MATCH-S00555","templated_match","Threat Intelligence","True","False","Authentication","","Threat Intel - Inbound Traffic Context","This rule detects allowed inbound traffic from an IP address associated with a known malicious campaign as designated by threat intelligence."
"","","LEGACY-S00108","match","Threat Intelligence","True","False","","","Threat Intel - Matched File Hash","A record flagged a file hash from a threat intelligence match list"
"","","LEGACY-S00109","match","Threat Intelligence","True","False","","","Threat Intel - Matched Domain Name","A record flagged a hostname or domain from a threat intelligence match list"
"","","LEGACY-S00110","match","Threat Intelligence","True","False","","","Threat Intel - Device IP Matched Threat Intel Domain Name","A record flagged a hostname or domain from a threat intelligence match list"
"","","LEGACY-S00111","match","Threat Intelligence","True","False","","","Threat Intel - Device IP Matched Threat Intel URL","A record flagged a URL from a threat intelligence match list"
"","","MATCH-S00815","templated_match","Unknown/Other","True","False","Authentication","","Threat Intel - Successful Authentication from Threat IP","This rule detects successful authentications from an IP address associated with a known malicious campaign as designated by threat intelligence."
"Microsoft","Windows","THRESHOLD-S00075","threshold","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1558, _mitreAttackTechnique:T1558.003","Too Many Kerberos Encryption Downgrade SPNs (Kerberoasting)","Kerberoasting is an attack method that allows an attacker to crack the passwords of service accounts in Active Directory offline and without fear of detection. This is facilitated by requesting service tickets that have data encrypted with weak encryption types (typically RC4). This technique is described in https://attack.mitre.org/techniques/T1208/."
"","","THRESHOLD-S00036","threshold","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1572, _mitreAttackTechnique:T1071.004, _mitreAttackTechnique:T1071","Too many empty/refused DNS queries","The DNS request/response was empty or refused. This may be an indication of DNS tunneling. (Excludes IPv4/IPv6 multicast DNS and LLMNR traffic)."
"","","MATCH-S00561","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Traffic From Embargoed Countries","Observes for traffic originating from an embargoed country. As embargoes vary from country to country, a match list must be populated with embargoed countries."
"","","MATCH-S00562","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Traffic To Embargoed Countries","Observes for traffic destined to an embargoed country. As embargoes vary from country to country, a match list must be populated with embargoed countries."
"","","MATCH-S00559","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Traffic to Honeypot IP","This rule monitors for traffic being sent to a honeypot, indicating an attacker may be on the network attempting to move laterally. Requires configuration of the honeypot_ip_addresses list in order to function."
"","","MATCH-S00563","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1090, _mitreAttackTechnique:T1090.002, _mitreAttackTechnique:T1090.003","Traffic to Proxy Anonymizers","Observes for outbound traffic to a proxy anonymizer. This rule requires a list populated with IP addresses of known proxy anonymizers."
"","","MATCH-S00588","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1482","Trickbot Malware Recon Activity","Trickbot enumerates domain/network topology and executes certain commands automatically every few minutes. This detection attempts to identify that activity based off of commands rarely observed in an enterprise network."
"","","MATCH-S00925","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1552","Trufflehog AWS Credential Verification Detected","Trufflehog is a tool that can be utilized to find and verify secrets. When Trufflehog locates AWS credentials, it attempts to validate them using the GetCallerIdentity API call. This signal looks for the default Trufflehog User Agent within CloudTrail telemetry, combined with the GetCallerIdentity API call. Within this telemetry, the user_username field will contain the value of the username associated with the secret or credential that Trufflehog is attempting to verify. Look at the events surrounding the source IP address of this event. Look for any potential areas that may have contained keys or secrets for the user_username value."
"","","MATCH-S00577","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003","Turla Group Commands","Observes for command lines associated with Turla group"
"Microsoft","Windows","MATCH-S00313","templated_match","Exfiltration","False","False","","_mitreAttackTactic:TA0009, _mitreAttackTactic:TA0010, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1025, _mitreAttackTechnique:T1052, _mitreAttackTechnique:T1052.001, _mitreAttackTechnique:T1092","Unauthorized External Device Installation","Detects a removable media device attached to a host. External media can be used to exfiltrate sensitive data and is also a common source of infections, so some organizations block their use. Attempts to use these devices could indicate the intent for malicious activity. Customer should populate a list of devices that should not have external media installed on them."
"","","MATCH-S00531","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.001, _mitreAttackTechnique:T1562.002, _mitreAttackTechnique:T1562.003, _mitreAttackTechnique:T1562.006","Unload Sysmon Filter Driver","Attackers often disable security tools to avoid detection. This rule looks for the usage of process fltMC.exe to unload a Sysmon Driver that will stop sysmon from collecting the data."
"","Docker","MATCH-S00656","templated_match","Defense Evasion","False","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1525","Unrecognized Container Image","Monitors for unrecognized container images that may indicate an attempt to bypass security controls on existing images or escalate privileges. This rule is disabled by default to allow for proper configuration of the match lists used to determine recognized images."
"","","MATCH-S00757","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1137, _mitreAttackTechnique:T1137.005","Unsafe Outlook Rule Creation Enabled","Detects a registry modification that enables the creation of Outlook mail rules that can run scripts. This functionality is disabled by default. The addition of the EnableUnsafeClientMailRules registry entry is highly suspicious. This feature can be used by an adversary to establish persistence."
"Microsoft","Windows","MATCH-S00344","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0003, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001, _mitreAttackTechnique:T1547.008","Unsigned Image Loaded by LSASS","Detects an unsigned image being loaded by LSASS as this may indicate attempted credential access. This rule may also detect persistence activity via LSASS driver loads.

Note that this rule requires Microsoft SysInternals Sysmon installed with Image Loaded (Event Id 7) logging enabled."
"","","MATCH-S00762","templated_match","Collection","True","False","","_mitreAttackTactic:TA0009, _mitreAttackTechnique:T1074, _mitreAttackTechnique:T1074.001","Unusual Staging Directory - PolicyDefinitions","Detects executable file extension written to the PolicyDefinitions directory. This activity has been associated with destructive malware"
"","","MATCH-S00567","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1112, _mitreAttackTechnique:T1547, _mitreAttackTechnique:T1547.001","Ursnif Malware Registry Key","Observes for the creation of a registry key associated with Ursnif malware"
"","","MATCH-S00463","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1127, _mitreAttackTechnique:T1127.001","UserInit Process Launched by MSBuild.exe","From FireEye Red Team Tool Countermeasures:
MSBuild is the build system for Visual Studio. This IOC detects the suspicious execution of userinit process by MSBUILD."
"Microsoft","Windows","THRESHOLD-S00064","threshold","Privilege Escalation","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1098, _mitreAttackTechnique:T1098.001, _mitreAttackTechnique:T1098.002, _mitreAttackTechnique:T1098.003, _mitreAttackTechnique:T1136, _mitreAttackTechnique:T1136.001, _mitreAttackTechnique:T1136.002, _mitreAttackTechnique:T1531","User Account Created and Deleted in 24 Hours","User Account Created and Deleted in 24 Hours. The temporary existence of a user account may be suspicious activity."
"","","MATCH-S00504","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003","User Added to Local Administrators","Observes for a user being added to the Windows local administrators group."
"","","CHAIN-S00007","chain","Defense Evasion","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1098, _mitreAttackTechnique:T1098.001, _mitreAttackTechnique:T1098.002, _mitreAttackTechnique:T1098.003, _mitreAttackTechnique:T1136, _mitreAttackTechnique:T1136.001, _mitreAttackTechnique:T1136.002, _mitreAttackTechnique:T1531","User Created and Quickly Deleted on Linux Machine","Attackers will sometimes create and subsequently delete user accounts to perform post-exploitation activity in an attempted counter-forensic measure."
"","","LEGACY-S00165","match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1204, _mitreAttackTechnique:T1204.002, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.005","VBS file downloaded from Internet","Although Visual Basic scripts (.vbs) are sometimes regularly downloaded from the Internet, they are often part of malware establishment.  They carry an elevated risk."
"","","MATCH-S00892","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562.007","Value Added to Azure NSG Group","This alert looks for a value being added to an Azure Network Security Group (NSG) successfully. Depending on the environment, other Azure services such as Azure FIrewall may provide egress and ingress controls. Ensure this activity is authorized and expected. The raw data for the event contains the exact values being modified."
"","","MATCH-S00761","templated_match","Impact","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1489, _mitreAttackTechnique:T1490","Volume Shadow Copy Service Stopped","Detects the Volume Shadow Copy service being stopped using net stop. This activity is commonly seen in wiper malware and ransomware attacks."
"Microsoft","Windows","MATCH-S00583","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001, _mitreAttackTechnique:T1003.002, _mitreAttackTechnique:T1003.004, _mitreAttackTechnique:T1003.005, _mitreAttackTechnique:T1003.006","WCE wceaux.dll Access","Obvserves for access of wceaux.dll, which may be indicative of credential access."
"","","MATCH-S00379","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.005, _mitreAttackTechnique:T1216","WMIExec VBS Script","Detects suspicious file execution by wscript and cscript"
"","","MATCH-S00570","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1047","WMIPRVSE Spawning Process","Observes for child processes spawned by WMIPRVSE"
"","","MATCH-S00150","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1047","WMI Launching Shell","Observes for Windows Management Instrumentation (WMI) launching a shell"
"","","MATCH-S00147","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1047","WMI Managed Object Format (MOF) Process Execution","Attackers will often utilize The Managed Object Format (MOF) compiler to conceal and execute their malicious code within the WMI Repository."
"Microsoft","Windows","MATCH-S00523","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1047","WMI Permanent Event Subscription","This rule looks for the creation of WMI permanent event subscriptions."
"Microsoft","Windows","MATCH-S00524","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1047","WMI Permanent Event Subscription - Sysmon","This rule looks for the creation of WMI permanent event subscriptions."
"Microsoft","Windows","MATCH-S00760","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1047, _mitreAttackTactic:TA0007, _mitreAttackTechnique:T1018","WMI Ping Sweep","Detects when Win32_PingStatus is invoked to ping a device."
"","","MATCH-S00146","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.006, _mitreAttackTechnique:T1047","WMI Process Call Create","An attacker can use WMI to create malicious processes on the local or remote host to bypass application whitelisting, since WMI is an authorized Windows tool."
"","","MATCH-S00151","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1047","WMI Process Get Brief","An attacker can use WMI to execute scripts on a host by pointing to malicious XSL files."
"Microsoft","Windows","MATCH-S00522","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1047","WMI Temporary Event Subscription","This rule looks for the creation of WMI temporary event subscriptions."
"","","MATCH-S00316","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0007, _mitreAttackTactic:TA0008, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1083, _mitreAttackTechnique:T1210, _mitreAttackTechnique:T1222, _mitreAttackTechnique:T1222.001, _mitreAttackTechnique:T1486, _mitreAttackTechnique:T1490","WannaCry Ransomware","Uses data from process creation events to detect indicators of the WannaCry Ransomware."
"","","MATCH-S00400","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0043, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1566, _mitreAttackTechnique:T1566.001, _mitreAttackTechnique:T1566.002, _mitreAttackTechnique:T1566.003, _mitreAttackTechnique:T1598, _mitreAttackTechnique:T1598.001, _mitreAttackTechnique:T1598.002, _mitreAttackTechnique:T1598.003, _mitreAttackTechnique:T1036, _mitreAttackTechnique:T1036.004, _mitreAttackTechnique:T1036.005","Web Download via Office Binaries","Detects downloaded payloads from remote server."
"","","MATCH-S00557","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Web Request to IP Address","This rule detects HTTP requests sent directly to IP addresses, bypassing DNS. This could indicate an attacker is trying to circumvent detection mechanisms."
"","","MATCH-S00566","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Web Request to Punycode Domain","This rule detects web requests to domains that include punycode characters, which is a common phishing technique used to mimic the appearance of a legitimate domain."
"","","MATCH-S00539","templated_match","Defense Evasion","False","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1505, _mitreAttackTechnique:T1505.003","Web Servers Executing Suspicious Processes","This rule looks for suspicious processes on all systems labeled as web servers. A list of web servers should be populated in order to enable the rule."
"","","MATCH-S00174","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTactic:TA0007, _mitreAttackTechnique:T1082, _mitreAttackTechnique:T1505, _mitreAttackTechnique:T1505.003","Web Services Executing Common Web Shell Commands","This rule looks for web server executables attempting to use commands commonly associated with adversaries utilizing a successfully uploaded web shell."
"Forcepoint","Web Security","THRESHOLD-S00041","threshold","Execution","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Websense - Blocked Activity Threshold","Websense blocked a large amount of activity originating from a single host within a short period of time."
"","","MATCH-S00684","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.004","Wget Passed to Script Execution Command","Passing a downloaded file to a script execution command such as sh will immediately run the script. This is indicative of either high-risk user behavior or malicious activity as script contents should always be reviewed prior to execution. This can be used to run scripts on a host where remote command execution is possible."
"","Bro","LEGACY-S00167","match","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.002","Windows Temp Directory Access Via SMB","This can be seen as suspicious, as you will not often see remote systems pulling files from the Windows Temp directory of other systems."
"Microsoft","Windows","LEGACY-S00168","match","Credential Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0006, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1078, _mitreAttackTechnique:T1078.001, _mitreAttackTechnique:T1078.002, _mitreAttackTechnique:T1078.003, _mitreAttackTechnique:T1110, _mitreAttackTechnique:T1110.001, _mitreAttackTechnique:T1110.002, _mitreAttackTechnique:T1110.003, _mitreAttackTechnique:T1110.004, _mitreAttackTechnique:T1531","Windows Account Locked Out - 4740","This signal fires whenever Windows Event type 4740 is seen in the environment."
"Microsoft","Windows","LEGACY-S00169","match","Privilege Escalation","False","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1484, _mitreAttackTechnique:T1484.001","Windows Account Added To Privileged Security Group","This signal alerts on the elevation of privileges assigned to a domain user account according to Windows Event ID 4728, 4732, and/or 4756."
"","","MATCH-S00532","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1482","Windows Adfind Exe","This rule looks for the execution of adfind.exe with command-line arguments that it uses by default. Specifically the filter or search functions. This has been seen used before by Wizard Spider, FIN6 and actors whom also launched SUNBURST. AdFind.exe is usually used a recon tool to enumare a domain controller."
"","","MATCH-S00552","templated_match","Execution","False","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059, _mitreAttackTechnique:T1059.003","Windows Connhost Started Forcefully","The rule looks for the Console Window Host process (connhost.exe) executed using the force flag -ForceV1. This is not regular behavior in the Windows OS and is often seen executed by the Ryuk Ransomware. The rule is disabled by default as this may be common in some environments."
"","","MATCH-S00291","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003","Windows Credential Editor (WCE) in use","Looks for the possible use of Windows Credential Editor, a common open-source tool used for pass-the-hash amongst other attacks.  This detection examins the import hash (aka imphash) as well as process start identifiers associated with the tool."
"","","MATCH-S00274","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0006, _mitreAttackTactic:TA0005, _mitreAttackTactic:TA0008, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1550, _mitreAttackTechnique:T1550.002","Windows Credential Editor (WCE) Tool Use Detected","This signal inciates that an indicator in the windows registry was found that indicates the Windows Credential Editor (WCE) tool may be in use.  This tool use is highly suspicious and can indicate lateral movement attempts (pass-the-hash etc.)  REF: https://www.ampliasecurity.com/research/windows-credentials-editor/"
"","","MATCH-S00521","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.001, _mitreAttackTechnique:T1562.002, _mitreAttackTechnique:T1562.004, _mitreAttackTechnique:T1562.006","Windows - Critical Service Disabled via Command Line","Detects a critical Windows service, such as Microsoft Defender or Windows Firewall, being stopped via the command line utilities sc.exe or net.exe. This could indicate an attacker attempting to bypass defenses on the target system to conduct further post-exploitation activity."
"","","MATCH-S00171","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1053, _mitreAttackTechnique:T1053.002, _mitreAttackTechnique:T1053.005","Windows - Powershell Scheduled Task Creation from PowerSploit or Empire","This rule detects the creation of a Windows scheduled task via PowerSploit or the default configuration of Empire."
"","","MATCH-S00398","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1105","Windows Defender Download Activity","Detect the use of Windows Defender to download payloads."
"","","MATCH-S00284","templated_match","Impact","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1490","Windows - Delete Windows Backup Catalog","Detects the deletion of backup catalogs on a Windows host through the command line. This activity is commonly seen in ransomware, where the program encrypts the host and deletes the backups to remove the possibility of restoring the computer and avoid paying the ransom."
"Microsoft","Windows","MATCH-S00693","templated_match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTechnique:T1212","Windows - Denied RDP","Generates a signal when windows event ID 4825 is observed. This indicates the user was denied an attempt to RDP."
"Microsoft","Windows","MATCH-S00549","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.001, _mitreAttackTechnique:T1562.006","Windows Disable Antispyware Registry","The rule looks for the Registry Key DisableAntiSpyware set to disable. This is consistent with Ryuk infections across a fleet of endpoints."
"","","MATCH-S00181","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1482","Windows - Domain Trust Discovery","Suspicious Domain Trust Discovery Activity - T1482"
"","","MATCH-S00538","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.001, _mitreAttackTechnique:T1562.004","Windows Firewall Rule Added","Observes for creation of new Windows Firewall Rule. An attacker may create new firewall rules to obfuscate activities via blocks, or to allow certain activity through the firewall."
"","","MATCH-S00537","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.001, _mitreAttackTechnique:T1562.004","Windows Firewall Rule Deleted","Observes for deletions of Windows Firewall rules. An attacker may delete firewall rules to obfuscate activities via blocks, or to allow certain activity through the firewall."
"","","MATCH-S00536","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.001, _mitreAttackTechnique:T1562.004","Windows Firewall Rule Modified","Observes for modifications to Windows Firewall rules. An attacker may modify firewall rules to obfuscate activities via blocks, or to allow certain activity through the firewall."
"Microsoft","Windows","MATCH-S00202","templated_match","Execution","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.005","Windows - Incoming LSASS Network Connection - Zerologon Behavior(CVE-2020-1472)","CVE-2020-1472 can be exploited by attackers to hijack enterprise servers due to Netlogon cryptographic weaknesses. The vulnerability allows an attacker to set a password for the computer account of an Active Directory Domain Controller, which can then be abused to pull credentials from the Domain Controller. This rule detects an incoming network connection made from the attacking machine to the victim Domain Controller to the LSASS process."
"","","MATCH-S00168","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1033","Windows - Local System executing whoami.exe","Local system account - Suspicious System Owner/User Discovery Activity - T1033 - requires commandline auditing 4688"
"Microsoft","Windows","LEGACY-S00170","match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1070, _mitreAttackTechnique:T1070.001, _mitreAttackTechnique:T1070.003","The Audit Log was Cleared - 1102","Attackers may attempt to clear the Windows Security Event Log in an effort to hide records of their activity during an intrusion. This rule detects that action."
"Microsoft","Windows","MATCH-S00169","templated_match","Persistence","False","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1137, _mitreAttackTechnique:T1137.001, _mitreAttackTechnique:T1137.006","Windows - Microsoft Office Add-In File Created","This rule detects when a Microsoft Office Add-In is created by monitoring certain directories with specific file extensions. This rule requires the setup of file creation auditing."
"","","MATCH-S00310","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.003","Windows - Network Connection from CMSTP","Detects potential CMSTP.exe abuse. Adversaries use CMSTP.exe to load and execute DLLs or COM scriptlets from remote servers to bypass application control defenses."
"","","MATCH-S00179","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0007, _mitreAttackTechnique:T1040","Windows Network Sniffing","Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data."
"","","MATCH-S00162","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0007, _mitreAttackTechnique:T1016, _mitreAttackTechnique:T1016.001, _mitreAttackTechnique:T1040","Windows - Network trace capture using netsh.exe","Detects capture of a network trace via the netsh.exe trace functionality"
"","","MATCH-S00159","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1069, _mitreAttackTechnique:T1069.001, _mitreAttackTechnique:T1069.002, _mitreAttackTechnique:T1201","Windows - Permissions Group Discovery","Microsoftâ€™s Net.exe can be used for multiple Discovery tactics, including Password Policy, Permissions, Account and Domain Trust Discovery. This detection identifies the use net.exe related commands on a system related to these discovery tactics. It is recommended to investigate the host and user to determine if this is authorized admin activity or needs further inspection."
"","","MATCH-S00732","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1547, _mitreAttackTechnique:T1547.010","Windows Port Monitor Modification","Detects file creations or registry modifications to Windows port  monitors which can be used to gain persistence in a system process."
"","","MATCH-S00268","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1134, _mitreAttackTechnique:T1134.001, _mitreAttackTechnique:T1134.002, _mitreAttackTechnique:T1134.003","Windows - Possible Impersonation Token Creation Using Runas","Detects the use of the runas command. Runas can be used to create impersonation tokens in an attempt to elevate privileges."
"","","MATCH-S00276","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.010","Windows - Possible Squiblydoo Technique Observed","The Squiblydoo technique is a way for unapproved scripts to run on a machine that is setup to allow only approved scripts to run. Squiblydoo utilizes regsvr32.exe to download an XML file that contains scriptlets for executing code on the victim machine."
"","","MATCH-S00281","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1057","Windows - PowerShell Process Discovery","Detects the use of various Get-Process PowerShell commands to discover information about running processes."
"","","MATCH-S00157","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1036, _mitreAttackTechnique:T1036.004, _mitreAttackTechnique:T1036.005","Windows Process Name Impersonation","This alert detects a process executing with a name that closely resembles a default Windows process. Malware will often attempt to disguise its execution by using a similar name to blend in with standard processes."
"","","MATCH-S00178","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1012","Windows Query Registry","Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software."
"","","MATCH-S00185","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1018","Windows - Remote System Discovery","Suspicious Remote System Discovery Activity - T1018"
"","","MATCH-S00272","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1207","Windows - Rogue Domain Controller - dcshadow","Mimikatzs LSADUMP::DCShadow module can be used to make AD updates by temporarily setting a computer to be a DC."
"","","MATCH-S00170","templated_match","Persistence","False","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1053, _mitreAttackTechnique:T1053.005","Windows - Scheduled Task Creation","A scheduled task was created in Windows or Azure. It is common for system administrators and approved software to create scheduled tasks, but adversaries are known to use them for persistence within a Windows environment. This rule is disabled by default due to the volume of events it can produce. Users should filter/exclude allowed scheduled tasks according to their environment before enabling the rule. The scheduled task name is logged in the ""commandLine"" field."
"","","MATCH-S00533","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1562, _mitreAttackTechnique:T1562.001, _mitreAttackTechnique:T1562.006","Windows Security Account Manager Stopped","The rule looks for a Windows Security Account Manager (SAM) was stopped via command-line. This is consistent with Ryuk infections across a fleet of endpoints."
"","","LEGACY-S00171","match","Persistence","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1036, _mitreAttackTechnique:T1036.003, _mitreAttackTechnique:T1036.004, _mitreAttackTechnique:T1036.005, _mitreAttackTechnique:T1569, _mitreAttackTechnique:T1569.002","Windows Service Executed from Nonstandard Execution Path","Windows services launching from locations outside of their standard installation path is a common malware persistence mechanism."
"Microsoft","Windows","CHAIN-S00002","chain","Lateral Movement","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.001, _mitreAttackTechnique:T1003.005","Windows - Suspicious Anonymous Logon Activity - Zerologon Behavior(CVE-2020-1472)","CVE-2020-1472 can be exploited by attackers to hijack enterprise servers due to Netlogon cryptographic weaknesses. The vulnerability allows an attacker to set a password for the computer account of an Active Directory Domain Controller, which can then be abused to pull credentials from the Domain Controller. This rule detects the domain controller computer account being changed after a successful anonymous login occurred."
"","","MATCH-S00285","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1218, _mitreAttackTechnique:T1218.003","Windows - Suspicious CMSTP Process Spawn","Detects potential CMSTP.exe abuse. Adversaries use CMSTP.exe to load and execute DLLs or COM scriptlets from remote servers to bypass application control defenses."
"","","MATCH-S00192","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1016, _mitreAttackTechnique:T1016.001, _mitreAttackTechnique:T1135","Windows - System Network Configuration Discovery","Suspicious System Network Configuration Discovery Activity - T1016"
"","","MATCH-S00167","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1018","Recon Using Common Windows Commands","Detects a set of commands often used in recon stages by different attack groups"
"","","MATCH-S00194","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1124","Windows - System Time Discovery","Identifies use of various commands to query a system's time. This technique may be used before executing a scheduled task or to discover the time zone of a target system."
"","","MATCH-S00724","templated_match","Defense Evasion","True","False","","_mitreAttackTechnique:T1218.011, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1129","Windows Update Agent DLL Changed","The Windows Update Agent executable, wuauclt.exe, can be abused by attackers to execute malicious code with elevated privileges by changing the DLL file loaded by the process. This technique is most commonly reported as part of phishing campaigns where the initial payload is a macro-enabled Microsoft Word document."
"Microsoft","Windows","MATCH-S00134","templated_match","Persistence","False","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1136, _mitreAttackTechnique:T1136.001, _mitreAttackTechnique:T1136.002","Windows User Account Created with Abnormal Naming Convention","'changeTarget' should be populated with a reguar expression that matches the user naming convention. This rule detects a user account that has been created that does not fit the normal naming convention established. If an unauthorized account has been created, it could be used to maliciously access additional systems."
"Microsoft","Windows","MATCH-S00107","templated_match","Privilege Escalation","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTactic:TA0004, _mitreAttackTechnique:T1484, _mitreAttackTechnique:T1484.001","Windows - User Adds Self to Security Group","A user adding themselves to a security group may indicate the attempt to escalate their privileges"
"","","MATCH-S00172","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTactic:TA0007, _mitreAttackTechnique:T1040","Windows - WiFi Credential Harvesting with netsh","Harvesting of Wifi Credentials Using netsh.exe"
"","","MATCH-S00382","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0004, _mitreAttackTactic:TA0005, _mitreAttackTechnique:T1548, _mitreAttackTechnique:T1548.002, _mitreAttackTechnique:T1055, _mitreAttackTechnique:T1055.001","Winnti Pipemon Characteristics","Detects specific process characteristics of Winnti Pipemon malware reported by ESET"
"","","LEGACY-S00172","match","Initial Access","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0011, _mitreAttackTechnique:T1571","Write-only SNMP attempt from external","Probing for the default SNMP write password is a way to bypass network security hardware"
"","","MATCH-S00734","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1547.013","XSD Autostart Entry Modification","Observes for modifications to XSD Autostart entries which can be used to execute malicious programs at startup."
"","","MATCH-S00435","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1220, _mitreAttackTechnique:T1216","XSL Script Processing","Extensible Stylesheet Language (XSL) files are commonly used to describe the processing and rendering of data within XML files, rule detects when adversaries abuse this functionality to execute arbitrary files while potentially bypassing application whitelisting defenses."
"Zscaler","","MATCH-S00222","templated_match","Command and Control","True","True","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","ZScaler Proxy-Traffic to Malicious Categorized Domain","Observes for traffic detected and categorized as malicious by ZScaler"
"","Bro","THRESHOLD-S00067","threshold","Privilege Escalation","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1003, _mitreAttackTechnique:T1003.005","ZeroLogon Privilege Escalation Behavior","An attack against CVE-2020-1472 may create thousands of NetrServerReqChallenge & NetrServerAuthenticate3 requests in a short amount of time. https://github.com/SecuraBV/CVE-2020-1472"
"Zoom","","MATCH-S00856","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1136","Zoom - Account Created","A sub account, user account, or TSP account has been created."
"Zoom","","MATCH-S00857","templated_match","Impact","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1531","Zoom - Account Deleted","A user account or TSP account has been deleted."
"","","MATCH-S00508","templated_match","Execution","True","True","","_mitreAttackTactic:TA0002","Zoom Child Process","Observes for Zoom creating child processes"
"Zoom","","MATCH-S00858","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098","Zoom - Group Admin Added","The Group admin added event is triggered every time one of your app users or account users add a group admin."
"Zoom","","MATCH-S00859","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1531","Zoom - Group Admin Deleted","The Group admin deleted event is triggered every time one of your app users or account users delete a group admin."
"Zoom","","MATCH-S00860","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1098, _mitreAttackTactic:TA0040, _mitreAttackTechnique:T1531","Zoom - Group Changes","Monitors Zoom group changes for additions, removals, or updates."
"Zoom","","MATCH-S00861","templated_match","Exfiltration","True","False","","_mitreAttackTactic:TA0010","Zoom - Information Barrier Policy Changes","Monitors Zoom information barrier policy creations, deletions, and updates. nformation Barriers are designed to help customers control user communication policies and meet regulatory requirements at scale. They can be used to prevent certain groups of users with sensitive information from communicating with others who are not supposed to know of this information."
"Zoom","","MATCH-S00862","templated_match","Exfiltration","True","False","","_mitreAttackTactic:TA0010","Zoom - Meeting Risk Alert","The At-Risk Meeting Notifier event is triggered every time someone posts a Zoom meeting link to a social media account, such as Reddit or Twitter."
"Zoom","","MATCH-S00863","templated_match","Impact","True","False","","_mitreAttackTactic:TA0040, _mitreAttackTechnique:T1485","Zoom - Recording Modification","Detects one of your app users or account users permanently or temporarily deletes a cloud recording."
"Zscaler","","MATCH-S00061","templated_match","Command and Control","True","False","","_mitreAttackTactic:TA0011, _mitreAttackTechnique:T1071, _mitreAttackTechnique:T1071.001","Zscaler - Allowed Elevated Risk Score Events","Observes for a high risk event that was permitted by ZScaler"
"","","MATCH-S00919","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1201","chage command use on host","The chage command on Linux allows for the changing of user password expiry information. The chage command is restricted to the root user; however, non-root/unprivileged users may use the -l flag to determine when the userâ€™s password or account is due to expire.  It is recommended to investigate the system and account the command has been executed on, to assess the intent of this execution. Additionally, looking at the command line and parent process is helpful in identifying valid automated processes executing this command that would benefit from tuning out via Rule Tuning."
"","","MATCH-S00263","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTactic:TA0006, _mitreAttackTactic:TA0009, _mitreAttackTechnique:T1005, _mitreAttackTechnique:T1119, _mitreAttackTechnique:T1203, _mitreAttackTechnique:T1528","iOS Implant URL Pattern","Detects a string in a http request url that is associated with an iOS Implant.  

Ref: 
https://googleprojectzero.blogspot.com/2019/08/implant-teardown.html
https://twitter.com/craiu/status/1167358457344925696"
"","","CHAIN-S00016","chain","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059.002","macOS - Suspicious Osascript Execution and Network Activity","This rule utilizes Jamf telemetry and looks for osascript execution with a suspicious parent process indicating execution from a shell or terminal in addition to the osascript process making network connections to an external IP address."
"","","MATCH-S00880","templated_match","Defense Evasion","True","False","","_mitreAttackTactic:TA0005, _mitreAttackTechnique:T1553.001","macOS - Entitlement Enumeration via Xattr","Threat actors may list attributes for certain files on a macOS host in order to potentially remove user prompts and execute untrusted code. This alert looks for a entitlement enumeration via the xattr binary."
"","","MATCH-S00726","templated_match","Persistence","True","True","","_mitreAttackTechnique:T1547, _mitreAttackTechnique:T1547.006, _mitreAttackTactic:TA0003","macOS Kernel Extension Load","Kernel Extensions in macOS can be used by adversaries to execute malicious code with root privileges."
"","","MATCH-S00883","templated_match","Credential Access","True","False","","_mitreAttackTactic:TA0006, _mitreAttackTechnique:T1555.001","macOS - Keychain Enumeration","Threat actors may be able to list or acquire credentials from keychains, this alert looks for enumeration of available keychains on a given host."
"","","MATCH-S00748","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1547.015","macOS Login Items Modification","Detects modifications to macOS login items. Login items are applications, files, folders, or connections which are launched upon user logon."
"","","MATCH-S00885","templated_match","Lateral Movement","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTechnique:T1021.005","macOS - Screen Sharing Session Established","This rule utilizes Jamf telemetry and looks for a successful screen sharing connection to a macOS host. The username that performed the connection is located within the ""texts.1"" field - ensure that this remote connection activity is authorized."
"","","MATCH-S00752","templated_match","Persistence","True","False","","_mitreAttackTactic:TA0003, _mitreAttackTechnique:T1037, _mitreAttackTechnique:T1037.005","macOS Startup Items Modifications","Detects modifications to startup items on a macOS system. Startup Items plist files can be used to establish persistence by an adversary."
"","","MATCH-S00879","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059.002","macOS - Suspicious Osascript Execution","This alert looks for osascript execution with a suspicious parent process indicating execution from a shell or terminal"
"","","MATCH-S00878","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059.002","macOS - Suspicious Osascript Parent Execution","This alert looks for osascript execution as the parent process indicating possible suspicious execution of a shell or terminal"
"","","MATCH-S00884","templated_match","Execution","True","False","","_mitreAttackTactic:TA0002, _mitreAttackTechnique:T1059.006","macOS - Suspicious Python PIP Execution","This alert utilizes Jamf telemetry and looks for suspicious osascript paramaters within a a Python PIP execution. Python-pip is capabale of executing JavaScript code via osascript which can be abused by threat actors to backdoor Python packages."
"","","MATCH-S00882","templated_match","Discovery","True","False","","_mitreAttackTactic:TA0007, _mitreAttackTechnique:T1082","macOS - System Preference Enumeration via Security Binary","The security macOS binary was used to enumerate system settings, ensure that this activity is expected and authorized as system enumeration is performed by threat actors in order to discover misconfigurations or exploitation opportunities."
"","","MATCH-S00881","templated_match","Discovery","True","False","","_mitreAttackTechnique:T1082, _mitreAttackTactic:TA0007","macOS - csrutil status Usage Detected","The csrutil binary should be rarely used by regular end-users and is designed to return the status of System Integrity Protection (SIP) - ensure this execution is expected or performed by an administrator or adminstrative function/automation."
"Microsoft","Windows","MATCH-S00581","templated_match","Unknown/Other","True","False","","_mitreAttackTactic:TA0008, _mitreAttackTactic:TA0002, _mitreAttackTechnique:T1021, _mitreAttackTechnique:T1021.002","smbexec.py Service Installation","Observes for service installations related to smbexec.py"
"","","MATCH-S01019","templated_match","Threat Intelligence","True","False","","","Threat Intel - Matched User Email","Detects email addresses associated with known malicious actor(s) or campaign(s) as designated by a threat intelligence provider."
"","","MATCH-S01020","templated_match","Threat Intelligence","True","False","","","Threat Intel - Matched Target Email","Detects email addresses associated with known malicious actor(s) or campaign(s) as designated by a threat intelligence provider."
"","","MATCH-S00999","templated_match","Threat Intelligence","True","False","","","Threat Intel - IMPHASH Match","This rule detects an IMPHASH indicator match from a threat intelligence feed"
"","","MATCH-S01000","templated_match","Threat Intelligence","True","False","","","Threat Intel - MD5 Match","This rule detects an MD5 hash indicator match from a threat intelligence feed"
"","","MATCH-S01001","templated_match","Threat Intelligence","True","False","","","Threat Intel - PEHASH Match","This rule detects a PEHASH indicator match from a threat intelligence feed"
"","","MATCH-S01002","templated_match","Threat Intelligence","True","False","","","Threat Intel - SSDEEP Match","This rule detects an SSDEEP hash indicator match from a threat intelligence feed"
"","","MATCH-S01003","templated_match","Threat Intelligence","True","False","","","Threat Intel - SHA1 Match","This rule detects a SHA1 hash indicator match from a threat intelligence feed"
"","","MATCH-S01004","templated_match","Threat Intelligence","True","False","","","Threat Intel - SHA256 Match","This rule detects a SHA256 hash indicator match from a threat intelligence feed"
"","","MATCH-S01005","templated_match","Threat Intelligence","True","False","","","Threat Intel - Source Hostname","This rule detects an indicator match from a threat intelligence feed"
"","","MATCH-S01006","templated_match","Threat Intelligence","True","False","","","Threat Intel - Device Hostname","This rule detects an indicator match from a threat intelligence feed"
"","","MATCH-S01007","templated_match","Threat Intelligence","True","False","","","Threat Intel - Destination Device Hostname","This rule detects an indicator match from a threat intelligence feed"
"","","MATCH-S01008","templated_match","Threat Intelligence","True","False","","","Threat Intel - HTTP Hostname","This rule detects an indicator match from a threat intelligence feed"
"","","MATCH-S01009","templated_match","Threat Intelligence","True","False","","","Threat Intel - HTTP Referer","This rule detects an indicator match from a threat intelligence feed"
"","","MATCH-S01010","templated_match","Threat Intelligence","True","False","","","Threat Intel - DNS Query Domain","This rule detects an indicator match from a threat intelligence feed"
"","","MATCH-S01011","templated_match","Threat Intelligence","True","False","","","Threat Intel - DNS Reply Domain","This rule detects an indicator match from a threat intelligence feed"
"","","MATCH-S01012","templated_match","Threat Intelligence","True","False","","","Threat Intel - HTTP Referer Root Domain","This rule detects an indicator match from a threat intelligence feed"
"","","MATCH-S01013","templated_match","Threat Intelligence","True","False","","","Threat Intel - HTTP URL Root Domain","This rule detects an indicator match from a threat intelligence feed"
"","","MATCH-S01014","templated_match","Threat Intelligence","True","False","","","Threat Intel - HTTP URL FQDN","This rule detects an indicator match from a threat intelligence feed"
"","","MATCH-S01015","templated_match","Threat Intelligence","True","False","","","Threat Intel - HTTP URL","This rule detects a URL indicator match from a threat intelligence feed"
"","","MATCH-S01018","templated_match","Threat Intelligence","True","False","Authentication","","Threat Intel - Successful Authentication from Threat Feed IP","This rule detects successful authentications from an IP address associated with a known malicious campaign as designated by threat intelligence."
"","","MATCH-S01025","templated_match","Threat Intelligence","False","False","Authentication","","Threat Intel - Inbound Traffic from Threat Feed IP (Low Confidence)","This rule detects allowed inbound traffic from an IP address with a low confidence rating from a threat intelligence feed.
Note that this rule is disabled by default due to a high likelihood of excessive signal volume and risk assignment to entities triggering this rule as-is. Tuning to reduce signal volume and potential false positives is highly recommended before activating this rule."
"","","MATCH-S01026","templated_match","Threat Intelligence","False","False","","","Threat Intel - Destination IP Address (Low Confidence)","This rule detects traffic to IP address with a low confidence rating from a threat intelligence feed.
Note that this rule is disabled by default due to a high likelihood of excessive signal volume and risk assignment to entities triggering this rule as-is. Tuning to reduce signal volume and potential false positives is highly recommended before activating this rule."
"","","MATCH-S01027","templated_match","Threat Intelligence","False","False","Authentication","","Threat Intel - Inbound Traffic from Threat Feed IP (Medium Confidence)","This rule detects traffic to IP address with a medium confidence rating from a threat intelligence feed.
Note that this rule is disabled by default due to a high likelihood of excessive signal volume and risk assignment to entities triggering this rule as-is. Tuning to reduce signal volume and potential false positives is highly recommended before activating this rule."
"","","MATCH-S01028","templated_match","Threat Intelligence","False","False","","","Threat Intel - Destination IP Address (Medium Confidence)","This rule detects traffic to IP address with a medium confidence rating from a threat intelligence feed.
Note that this rule is disabled by default due to a high likelihood of excessive signal volume and risk assignment to entities triggering this rule as-is. Tuning to reduce signal volume and potential false positives is highly recommended before activating this rule."
"","","MATCH-S01023","templated_match","Threat Intelligence","True","False","Authentication","","Threat Intel - Inbound Traffic from Threat Feed IP (High Confidence)","This rule detects traffic to IP address with a high confidence rating from a threat intelligence feed."
"","","MATCH-S01024","templated_match","Threat Intelligence","True","False","","","Threat Intel - Destination IP Address (High Confidence)","This rule detects traffic to IP address with a high confidence rating from a threat intelligence feed."
"","","LEGACY-S00179","match","Exfiltration","True","False","","_mitreAttackTactic:TA0001, _mitreAttackTactic:TA0003, _mitreAttackTactic:TA0010, _mitreAttackTechnique:T1133","vpnoverdns.com DNS lookup","vpnoverdns.com is a free service providing VPN functionality over DNS. DNS resolutions for *.tun.vpnoverdns.com indicate usage of their VPN service. The service describes itself as ""Data exfiltration, for those times when everything else is blocked.""."
